<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>033_OBO_xx0_IvanSadikov_PipedRDDhelp - sds-3.x/ScaDaMaLe</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../../favicon.svg">
        
        
        <link rel="shortcut icon" href="../../favicon.png">
        
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        
        <link rel="stylesheet" href="../../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
        <link rel="stylesheet" href="../../scroll-mdbook-outputs.css">
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/010a_packageCells.html">010a_packageCells</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/011_02_IntroToSimulation.html">011_02_IntroToSimulation</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/011_03_IntroToML.html">011_03_IntroToML</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/012_UnsupervisedClustering_1MSongsKMeans_Intro.html">012_UnsupervisedClustering_1MSongsKMeans_Intro</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/013_UnsupervisedClustering_1MSongsKMeans_Stage1ETL.html">013_UnsupervisedClustering_1MSongsKMeans_Stage1ETL</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/014_UnsupervisedClustering_1MSongsKMeans_Stage2Explore.html">014_UnsupervisedClustering_1MSongsKMeans_Stage2Explore</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/015_UnsupervisedClustering_1MSongsKMeans_Stage3Model.html">015_UnsupervisedClustering_1MSongsKMeans_Stage3Model</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/016_SupervisedClustering_DecisionTrees_HandWrittenDigitRecognition.html">016_SupervisedClustering_DecisionTrees_HandWrittenDigitRecognition</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/017_LAlgIntro.html">017_LAlgIntro</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/018_LinRegIntro.html">018_LinRegIntro</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019_DistLAlgForLinRegIntro.html">019_DistLAlgForLinRegIntro</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_000_dataTypesProgGuide.html">019x_000_dataTypesProgGuide</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_001_LocalVector.html">019x_001_LocalVector</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_002_LabeledPoint.html">019x_002_LabeledPoint</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_003_LocalMatrix.html">019x_003_LocalMatrix</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_004_DistributedMatrix.html">019x_004_DistributedMatrix</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_005_RowMatrix.html">019x_005_RowMatrix</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_006_IndexedRowMatrix.html">019x_006_IndexedRowMatrix</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_007_CoordinateMatrix.html">019x_007_CoordinateMatrix</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_008_BlockMatrix.html">019x_008_BlockMatrix</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/020_PowerPlantPipeline_02ModelTuneEvaluate.html">020_PowerPlantPipeline_02ModelTuneEvaluate</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/021_recognizeActivityByRandomForest.html">021_recognizeActivityByRandomForest</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/022_GraphFramesUserGuide.html">022_GraphFramesUserGuide</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/023_OnTimeFlightPerformance.html">023_OnTimeFlightPerformance</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/030_PowerPlantPipeline_03ModelTuneEvaluateDeploy.html">030_PowerPlantPipeline_03ModelTuneEvaluateDeploy</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/033_OBO_LoadExtract.html">033_OBO_LoadExtract</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/033_OBO_PipedRDD_RigorousBayesianABTesting.html">033_OBO_PipedRDD_RigorousBayesianABTesting</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/033_OBO_xx0_IvanSadikov_PipedRDDhelp.html" class="active">033_OBO_xx0_IvanSadikov_PipedRDDhelp</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/033_OBO_xx1_OBOnlineExample.html">033_OBO_xx1_OBOnlineExample</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/033_OBO_xx2_OBOnlineExampleScala.html">033_OBO_xx2_OBOnlineExampleScala</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/034_LDA_20NewsGroupsSmall.html">034_LDA_20NewsGroupsSmall</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/035_LDA_CornellMovieDialogs.html">035_LDA_CornellMovieDialogs</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/036_ALS_MovieRecommender.html">036_ALS_MovieRecommender</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/998_EX_01_GraphXShortestWeightedPaths.html">998_EX_01_GraphXShortestWeightedPaths</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/999_YT_01_FinancialFraudDetectionUsingDecisionTreeMachineLearningModels.html">999_YT_01_FinancialFraudDetectionUsingDecisionTreeMachineLearningModels</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">sds-3.x/ScaDaMaLe</h1>

                    <div class="right-buttons">
                        
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        

                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <div class="cell markdown">
<p>ScaDaMaLe Course <a href="https://lamastex.github.io/scalable-data-science/sds/3/x/">site</a> and <a href="https://lamastex.github.io/ScaDaMaLe/index.html">book</a></p>
</div>
<div class="cell markdown">
<h1 id="quick-tutorial-on-pipedrdds-by-ivan-sadikov"><a class="header" href="#quick-tutorial-on-pipedrdds-by-ivan-sadikov">Quick Tutorial on PipedRDDs by Ivan Sadikov</a></h1>
</div>
<div class="cell markdown">
<p>Check if the script runs and prints the result</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-fs">ls /FileStore/tables/IsIt1or2Coins
</code></pre>
<div class="output execute_result tabular_result" execution_count="1">
<table>
<thead>
<tr class="header">
<th>path</th>
<th>name</th>
<th>size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>dbfs:/FileStore/tables/IsIt1or2Coins</td>
<td>IsIt1or2Coins</td>
<td>6559480.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-sh">mkdir -p /tmp/ivan/ &amp;&amp; cp /dbfs/FileStore/tables/IsIt1or2Coins /tmp/ivan/
</code></pre>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-sh">/tmp/ivan/IsIt1or2Coins 1000 100 234565432 1000 500 1200 600 1
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>theSeed: 234565432
N1: 1000
n1: 500
N2: 1200
n2: 600
UseLogPi: 1
  n_boxes: 1000  n_samples: 100  rng_seed = 234565432
  N1=number of first coin tosses          : 1000
  n1=number of heads in first coin tosses : 500
  N2=number of second coin tosses         : 1200
  n2=number of heads in second coin tosses: 600
Ldomain.L: 0
Ldomain.L: 1
end of FIsIt1or2Coins constructor. 
in FirstBox, before getBoxREInfo. k: 0
0 [1.000000000000000E-300,   1.000000000000000] RE: [-1.519706161376072E+006,   0.000000000000000] BoxIntegral: [-1.519706161376072E+006,   0.000000000000000]
in FirstBox, after getBoxREInfo 
0 [1.000000000000000E-300,   1.000000000000000]
in FirstBox, before getBoxREInfo. k: 1
1 [1.000000000000000E-300,   1.000000000000000] [1.000000000000000E-300,   1.000000000000000] RE: [-1.519706161376072E+006,   0.000000000000000] BoxIntegral: [-1.519706161376072E+006,   0.000000000000000]
in FirstBox, after getBoxREInfo 
1 [1.000000000000000E-300,   1.000000000000000] [1.000000000000000E-300,   1.000000000000000]
Umax:    0.000000000000000
UmaxMAX, Umax, f_scale_local: 1e+200    0.000000000000000 -460.517018598809159
f_scale: -460.517018598809159  -460.517018598809159
bottom of updateUmax 
in FirstBox, after updateUmax 
bottom of FirstBox. 
after FirstBox, before Refine 
Umax: -1.512624733218932E+003
UmaxMAX, Umax, f_scale_local: 1e+200 -1.512624733218932E+003 -1.973141751817741E+003
f_scale: -1.973141751817741E+003  -1.973141751817741E+003
bottom of updateUmax 
in AdaptPartition after updateUmax2 
in updateIntegral. IL, IU:    0.000000000000000 1.000000000000362E+200
# Adaptive partitioning complete. Boxes: 1000  Lower bound on Acceptance Prob.: 4.88326e-07 IL, IU: 1.41768e+191   2.90314e+197
#Using log(pi)? 1
#No. of Boxes with proposal mass function &lt;= 1e-16 48
#No. of Boxes with proposal mass function &lt;= 1e-10 112
#No. of Boxes with proposal mass function &gt;= 1e-6 776
#No. of Boxes with proposal mass function &gt;= 1e-3 230
after Refine 
before Rej..SampleMany 
n_samples: 100
after Rej..SampleMany 
rs_sample IU, N, Nrs: 2.903136091244425E+197 100 100
RSSampleMany, integral est: 1.2113e+193
RSSampleMany mean: 
   Number of labels or topologies = 2
label: 0  proportion:    0.970000000000000
Labelled Mean:
   0.500284830473953

label: 1  proportion:    0.030000000000000
Labelled Mean:
   0.510581317236150
   0.489823533395186

n interval function calls: 1998
n real function calls: 2396703
# CPU Time (seconds). Partitioning: 0.008614  Sampling: 1.40668  Total: 1.41529
# CPU time (secods) per estimate: 0.0141529
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-sh"># You can also do it like this
/dbfs/FileStore/tables/IsIt1or2Coins 1000 100 234565432 1000 500 1200 600 1
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>theSeed: 234565432
N1: 1000
n1: 500
N2: 1200
n2: 600
UseLogPi: 1
  n_boxes: 1000  n_samples: 100  rng_seed = 234565432
  N1=number of first coin tosses          : 1000
  n1=number of heads in first coin tosses : 500
  N2=number of second coin tosses         : 1200
  n2=number of heads in second coin tosses: 600
Ldomain.L: 0
Ldomain.L: 1
end of FIsIt1or2Coins constructor. 
in FirstBox, before getBoxREInfo. k: 0
0 [1.000000000000000E-300,   1.000000000000000] RE: [-1.519706161376072E+006,   0.000000000000000] BoxIntegral: [-1.519706161376072E+006,   0.000000000000000]
in FirstBox, after getBoxREInfo 
0 [1.000000000000000E-300,   1.000000000000000]
in FirstBox, before getBoxREInfo. k: 1
1 [1.000000000000000E-300,   1.000000000000000] [1.000000000000000E-300,   1.000000000000000] RE: [-1.519706161376072E+006,   0.000000000000000] BoxIntegral: [-1.519706161376072E+006,   0.000000000000000]
in FirstBox, after getBoxREInfo 
1 [1.000000000000000E-300,   1.000000000000000] [1.000000000000000E-300,   1.000000000000000]
Umax:    0.000000000000000
UmaxMAX, Umax, f_scale_local: 1e+200    0.000000000000000 -460.517018598809159
f_scale: -460.517018598809159  -460.517018598809159
bottom of updateUmax 
in FirstBox, after updateUmax 
bottom of FirstBox. 
after FirstBox, before Refine 
Umax: -1.512624733218932E+003
UmaxMAX, Umax, f_scale_local: 1e+200 -1.512624733218932E+003 -1.973141751817741E+003
f_scale: -1.973141751817741E+003  -1.973141751817741E+003
bottom of updateUmax 
in AdaptPartition after updateUmax2 
in updateIntegral. IL, IU:    0.000000000000000 1.000000000000362E+200
# Adaptive partitioning complete. Boxes: 1000  Lower bound on Acceptance Prob.: 4.88326e-07 IL, IU: 1.41768e+191   2.90314e+197
#Using log(pi)? 1
#No. of Boxes with proposal mass function &lt;= 1e-16 48
#No. of Boxes with proposal mass function &lt;= 1e-10 112
#No. of Boxes with proposal mass function &gt;= 1e-6 776
#No. of Boxes with proposal mass function &gt;= 1e-3 230
after Refine 
before Rej..SampleMany 
n_samples: 100
after Rej..SampleMany 
rs_sample IU, N, Nrs: 2.903136091244425E+197 100 100
RSSampleMany, integral est: 1.2113e+193
RSSampleMany mean: 
   Number of labels or topologies = 2
label: 0  proportion:    0.970000000000000
Labelled Mean:
   0.500284830473953

label: 1  proportion:    0.030000000000000
Labelled Mean:
   0.510581317236150
   0.489823533395186

n interval function calls: 1998
n real function calls: 2396703
# CPU Time (seconds). Partitioning: 0.010784  Sampling: 1.39828  Total: 1.40906
# CPU time (secods) per estimate: 0.0140906
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>If you want to use local file copy, you can do it simpler like this:</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">import scala.sys.process._
import scala.concurrent.duration._

def copyFile(): Unit = {
  &quot;mkdir -p /tmp/ivan&quot;.!!
  &quot;cp /dbfs/FileStore/tables/IsIt1or2Coins /tmp/ivan/&quot;.!!
}

sc.runOnEachExecutor(copyFile, new FiniteDuration(1, HOURS))
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import scala.sys.process._
import scala.concurrent.duration._
copyFile: ()Unit
res1: scala.collection.Map[String,scala.util.Try[Unit]] = Map(80 -&gt; Success(()), 77 -&gt; Success(()))
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val input = Seq(&quot;/tmp/ivan/IsIt1or2Coins 1000 100 234565432 1000 500 1200 600 1&quot;, &quot;/tmp/ivan/IsIt1or2Coins 1000 100 234565432 1000 500 1200 600 1&quot;)

val res = sc
  .parallelize(input)
  .repartition(2)
  .pipe(&quot;bash&quot;)
  .collect()
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>input: Seq[String] = List(/tmp/ivan/IsIt1or2Coins 1000 100 234565432 1000 500 1200 600 1, /tmp/ivan/IsIt1or2Coins 1000 100 234565432 1000 500 1200 600 1)
res: Array[String] = Array(theSeed: 234565432, N1: 1000, n1: 500, N2: 1200, n2: 600, UseLogPi: 1, &quot;  n_boxes: 1000  n_samples: 100  rng_seed = 234565432&quot;, &quot;  N1=number of first coin tosses          : 1000&quot;, &quot;  n1=number of heads in first coin tosses : 500&quot;, &quot;  N2=number of second coin tosses         : 1200&quot;, &quot;  n2=number of heads in second coin tosses: 600&quot;, Ldomain.L: 0, Ldomain.L: 1, &quot;end of FIsIt1or2Coins constructor. &quot;, in FirstBox, before getBoxREInfo. k: 0, 0 [1.000000000000000E-300,   1.000000000000000] RE: [-1.519706161376072E+006,   0.000000000000000] BoxIntegral: [-1.519706161376072E+006,   0.000000000000000], &quot;in FirstBox, after getBoxREInfo &quot;, 0 [1.000000000000000E-300,   1.000000000000000], in FirstBox, before getBoxREInfo. k: 1, 1 [1.000000000000000E-300,   1.000000000000000] [1.000000000000000E-300,   1.000000000000000] RE: [-1.519706161376072E+006,   0.000000000000000] BoxIntegral: [-1.519706161376072E+006,   0.000000000000000], &quot;in FirstBox, after getBoxREInfo &quot;, 1 [1.000000000000000E-300,   1.000000000000000] [1.000000000000000E-300,   1.000000000000000], Umax:    0.000000000000000, UmaxMAX, Umax, f_scale_local: 1e+200    0.000000000000000 -460.517018598809159, f_scale: -460.517018598809159  -460.517018598809159, &quot;bottom of updateUmax &quot;, &quot;in FirstBox, after updateUmax &quot;, &quot;bottom of FirstBox. &quot;, &quot;after FirstBox, before Refine &quot;, Umax: -1.512624733218932E+003, UmaxMAX, Umax, f_scale_local: 1e+200 -1.512624733218932E+003 -1.973141751817741E+003, f_scale: -1.973141751817741E+003  -1.973141751817741E+003, &quot;bottom of updateUmax &quot;, &quot;in AdaptPartition after updateUmax2 &quot;, in updateIntegral. IL, IU:    0.000000000000000 1.000000000000362E+200, # Adaptive partitioning complete. Boxes: 1000  Lower bound on Acceptance Prob.: 4.88326e-07 IL, IU: 1.41768e+191   2.90314e+197, #Using log(pi)? 1, #No. of Boxes with proposal mass function &lt;= 1e-16 48, #No. of Boxes with proposal mass function &lt;= 1e-10 112, #No. of Boxes with proposal mass function &gt;= 1e-6 776, #No. of Boxes with proposal mass function &gt;= 1e-3 230, &quot;after Refine &quot;, &quot;before Rej..SampleMany &quot;, n_samples: 100, &quot;after Rej..SampleMany &quot;, rs_sample IU, N, Nrs: 2.903136091244425E+197 100 100, RSSampleMany, integral est: 1.2113e+193, &quot;RSSampleMany mean: &quot;, &quot;   Number of labels or topologies = 2&quot;, label: 0  proportion:    0.970000000000000, Labelled Mean:, &quot;   0.500284830473953&quot;, &quot;&quot;, label: 1  proportion:    0.030000000000000, Labelled Mean:, &quot;   0.510581317236150&quot;, &quot;   0.489823533395186&quot;, &quot;&quot;, n interval function calls: 1998, n real function calls: 2396703, # CPU Time (seconds). Partitioning: 0.008842  Sampling: 0.724787  Total: 0.733629, # CPU time (secods) per estimate: 0.00733629, theSeed: 234565432, N1: 1000, n1: 500, N2: 1200, n2: 600, UseLogPi: 1, &quot;  n_boxes: 1000  n_samples: 100  rng_seed = 234565432&quot;, &quot;  N1=number of first coin tosses          : 1000&quot;, &quot;  n1=number of heads in first coin tosses : 500&quot;, &quot;  N2=number of second coin tosses         : 1200&quot;, &quot;  n2=number of heads in second coin tosses: 600&quot;, Ldomain.L: 0, Ldomain.L: 1, &quot;end of FIsIt1or2Coins constructor. &quot;, in FirstBox, before getBoxREInfo. k: 0, 0 [1.000000000000000E-300,   1.000000000000000] RE: [-1.519706161376072E+006,   0.000000000000000] BoxIntegral: [-1.519706161376072E+006,   0.000000000000000], &quot;in FirstBox, after getBoxREInfo &quot;, 0 [1.000000000000000E-300,   1.000000000000000], in FirstBox, before getBoxREInfo. k: 1, 1 [1.000000000000000E-300,   1.000000000000000] [1.000000000000000E-300,   1.000000000000000] RE: [-1.519706161376072E+006,   0.000000000000000] BoxIntegral: [-1.519706161376072E+006,   0.000000000000000], &quot;in FirstBox, after getBoxREInfo &quot;, 1 [1.000000000000000E-300,   1.000000000000000] [1.000000000000000E-300,   1.000000000000000], Umax:    0.000000000000000, UmaxMAX, Umax, f_scale_local: 1e+200    0.000000000000000 -460.517018598809159, f_scale: -460.517018598809159  -460.517018598809159, &quot;bottom of updateUmax &quot;, &quot;in FirstBox, after updateUmax &quot;, &quot;bottom of FirstBox. &quot;, &quot;after FirstBox, before Refine &quot;, Umax: -1.512624733218932E+003, UmaxMAX, Umax, f_scale_local: 1e+200 -1.512624733218932E+003 -1.973141751817741E+003, f_scale: -1.973141751817741E+003  -1.973141751817741E+003, &quot;bottom of updateUmax &quot;, &quot;in AdaptPartition after updateUmax2 &quot;, in updateIntegral. IL, IU:    0.000000000000000 1.000000000000362E+200, # Adaptive partitioning complete. Boxes: 1000  Lower bound on Acceptance Prob.: 4.88326e-07 IL, IU: 1.41768e+191   2.90314e+197, #Using log(pi)? 1, #No. of Boxes with proposal mass function &lt;= 1e-16 48, #No. of Boxes with proposal mass function &lt;= 1e-10 112, #No. of Boxes with proposal mass function &gt;= 1e-6 776, #No. of Boxes with proposal mass function &gt;= 1e-3 230, &quot;after Refine &quot;, &quot;before Rej..SampleMany &quot;, n_samples: 100, &quot;after Rej..SampleMany &quot;, rs_sample IU, N, Nrs: 2.903136091244425E+197 100 100, RSSampleMany, integral est: 1.2113e+193, &quot;RSSampleMany mean: &quot;, &quot;   Number of labels or topologies = 2&quot;, label: 0  proportion:    0.970000000000000, Labelled Mean:, &quot;   0.500284830473953&quot;, &quot;&quot;, label: 1  proportion:    0.030000000000000, Labelled Mean:, &quot;   0.510581317236150&quot;, &quot;   0.489823533395186&quot;, &quot;&quot;, n interval function calls: 1998, n real function calls: 2396703, # CPU Time (seconds). Partitioning: 0.005953  Sampling: 0.741072  Total: 0.747025, # CPU time (secods) per estimate: 0.00747025)
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>In fact, you can just use DBFS FUSE to run the commands without any file copy</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val script = &quot;/dbfs/FileStore/tables/IsIt1or2Coins&quot;
val input = Seq(s&quot;$script 1000 100 234565432 1000 500 1200 600 1&quot;, s&quot;$script 1000 100 234565432 1000 500 1200 600 1&quot;)

val res = sc
  .parallelize(input)
  .repartition(2)
  .pipe(&quot;bash&quot;)
  .collect()
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>script: String = /dbfs/FileStore/tables/IsIt1or2Coins
input: Seq[String] = List(/dbfs/FileStore/tables/IsIt1or2Coins 1000 100 234565432 1000 500 1200 600 1, /dbfs/FileStore/tables/IsIt1or2Coins 1000 100 234565432 1000 500 1200 600 1)
res: Array[String] = Array(theSeed: 234565432, N1: 1000, n1: 500, N2: 1200, n2: 600, UseLogPi: 1, &quot;  n_boxes: 1000  n_samples: 100  rng_seed = 234565432&quot;, &quot;  N1=number of first coin tosses          : 1000&quot;, &quot;  n1=number of heads in first coin tosses : 500&quot;, &quot;  N2=number of second coin tosses         : 1200&quot;, &quot;  n2=number of heads in second coin tosses: 600&quot;, Ldomain.L: 0, Ldomain.L: 1, &quot;end of FIsIt1or2Coins constructor. &quot;, in FirstBox, before getBoxREInfo. k: 0, 0 [1.000000000000000E-300,   1.000000000000000] RE: [-1.519706161376072E+006,   0.000000000000000] BoxIntegral: [-1.519706161376072E+006,   0.000000000000000], &quot;in FirstBox, after getBoxREInfo &quot;, 0 [1.000000000000000E-300,   1.000000000000000], in FirstBox, before getBoxREInfo. k: 1, 1 [1.000000000000000E-300,   1.000000000000000] [1.000000000000000E-300,   1.000000000000000] RE: [-1.519706161376072E+006,   0.000000000000000] BoxIntegral: [-1.519706161376072E+006,   0.000000000000000], &quot;in FirstBox, after getBoxREInfo &quot;, 1 [1.000000000000000E-300,   1.000000000000000] [1.000000000000000E-300,   1.000000000000000], Umax:    0.000000000000000, UmaxMAX, Umax, f_scale_local: 1e+200    0.000000000000000 -460.517018598809159, f_scale: -460.517018598809159  -460.517018598809159, &quot;bottom of updateUmax &quot;, &quot;in FirstBox, after updateUmax &quot;, &quot;bottom of FirstBox. &quot;, &quot;after FirstBox, before Refine &quot;, Umax: -1.512624733218932E+003, UmaxMAX, Umax, f_scale_local: 1e+200 -1.512624733218932E+003 -1.973141751817741E+003, f_scale: -1.973141751817741E+003  -1.973141751817741E+003, &quot;bottom of updateUmax &quot;, &quot;in AdaptPartition after updateUmax2 &quot;, in updateIntegral. IL, IU:    0.000000000000000 1.000000000000362E+200, # Adaptive partitioning complete. Boxes: 1000  Lower bound on Acceptance Prob.: 4.88326e-07 IL, IU: 1.41768e+191   2.90314e+197, #Using log(pi)? 1, #No. of Boxes with proposal mass function &lt;= 1e-16 48, #No. of Boxes with proposal mass function &lt;= 1e-10 112, #No. of Boxes with proposal mass function &gt;= 1e-6 776, #No. of Boxes with proposal mass function &gt;= 1e-3 230, &quot;after Refine &quot;, &quot;before Rej..SampleMany &quot;, n_samples: 100, &quot;after Rej..SampleMany &quot;, rs_sample IU, N, Nrs: 2.903136091244425E+197 100 100, RSSampleMany, integral est: 1.2113e+193, &quot;RSSampleMany mean: &quot;, &quot;   Number of labels or topologies = 2&quot;, label: 0  proportion:    0.970000000000000, Labelled Mean:, &quot;   0.500284830473953&quot;, &quot;&quot;, label: 1  proportion:    0.030000000000000, Labelled Mean:, &quot;   0.510581317236150&quot;, &quot;   0.489823533395186&quot;, &quot;&quot;, n interval function calls: 1998, n real function calls: 2396703, # CPU Time (seconds). Partitioning: 0.006943  Sampling: 0.722021  Total: 0.728964, # CPU time (secods) per estimate: 0.00728964, theSeed: 234565432, N1: 1000, n1: 500, N2: 1200, n2: 600, UseLogPi: 1, &quot;  n_boxes: 1000  n_samples: 100  rng_seed = 234565432&quot;, &quot;  N1=number of first coin tosses          : 1000&quot;, &quot;  n1=number of heads in first coin tosses : 500&quot;, &quot;  N2=number of second coin tosses         : 1200&quot;, &quot;  n2=number of heads in second coin tosses: 600&quot;, Ldomain.L: 0, Ldomain.L: 1, &quot;end of FIsIt1or2Coins constructor. &quot;, in FirstBox, before getBoxREInfo. k: 0, 0 [1.000000000000000E-300,   1.000000000000000] RE: [-1.519706161376072E+006,   0.000000000000000] BoxIntegral: [-1.519706161376072E+006,   0.000000000000000], &quot;in FirstBox, after getBoxREInfo &quot;, 0 [1.000000000000000E-300,   1.000000000000000], in FirstBox, before getBoxREInfo. k: 1, 1 [1.000000000000000E-300,   1.000000000000000] [1.000000000000000E-300,   1.000000000000000] RE: [-1.519706161376072E+006,   0.000000000000000] BoxIntegral: [-1.519706161376072E+006,   0.000000000000000], &quot;in FirstBox, after getBoxREInfo &quot;, 1 [1.000000000000000E-300,   1.000000000000000] [1.000000000000000E-300,   1.000000000000000], Umax:    0.000000000000000, UmaxMAX, Umax, f_scale_local: 1e+200    0.000000000000000 -460.517018598809159, f_scale: -460.517018598809159  -460.517018598809159, &quot;bottom of updateUmax &quot;, &quot;in FirstBox, after updateUmax &quot;, &quot;bottom of FirstBox. &quot;, &quot;after FirstBox, before Refine &quot;, Umax: -1.512624733218932E+003, UmaxMAX, Umax, f_scale_local: 1e+200 -1.512624733218932E+003 -1.973141751817741E+003, f_scale: -1.973141751817741E+003  -1.973141751817741E+003, &quot;bottom of updateUmax &quot;, &quot;in AdaptPartition after updateUmax2 &quot;, in updateIntegral. IL, IU:    0.000000000000000 1.000000000000362E+200, # Adaptive partitioning complete. Boxes: 1000  Lower bound on Acceptance Prob.: 4.88326e-07 IL, IU: 1.41768e+191   2.90314e+197, #Using log(pi)? 1, #No. of Boxes with proposal mass function &lt;= 1e-16 48, #No. of Boxes with proposal mass function &lt;= 1e-10 112, #No. of Boxes with proposal mass function &gt;= 1e-6 776, #No. of Boxes with proposal mass function &gt;= 1e-3 230, &quot;after Refine &quot;, &quot;before Rej..SampleMany &quot;, n_samples: 100, &quot;after Rej..SampleMany &quot;, rs_sample IU, N, Nrs: 2.903136091244425E+197 100 100, RSSampleMany, integral est: 1.2113e+193, &quot;RSSampleMany mean: &quot;, &quot;   Number of labels or topologies = 2&quot;, label: 0  proportion:    0.970000000000000, Labelled Mean:, &quot;   0.500284830473953&quot;, &quot;&quot;, label: 1  proportion:    0.030000000000000, Labelled Mean:, &quot;   0.510581317236150&quot;, &quot;   0.489823533395186&quot;, &quot;&quot;, n interval function calls: 1998, n real function calls: 2396703, # CPU Time (seconds). Partitioning: 0.006515  Sampling: 0.727618  Total: 0.734133, # CPU time (secods) per estimate: 0.00734133)
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
</div>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../../contents/000_2-sds-3-x-ml/033_OBO_PipedRDD_RigorousBayesianABTesting.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../../contents/000_2-sds-3-x-ml/033_OBO_xx1_OBOnlineExample.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../../contents/000_2-sds-3-x-ml/033_OBO_PipedRDD_RigorousBayesianABTesting.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../../contents/000_2-sds-3-x-ml/033_OBO_xx1_OBOnlineExample.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
