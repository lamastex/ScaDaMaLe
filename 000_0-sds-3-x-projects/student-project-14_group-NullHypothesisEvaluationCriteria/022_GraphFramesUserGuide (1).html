
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ScaDaMaLe, Scalable Data Science and Distributed Machine Learning &#8212; Scalable Data Science &amp; Distributed Machine Learning</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Scalable Data Science & Distributed Machine Learning</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/000_ScaDaMaLe.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction to Apache Spark Core
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/001_whySpark.html">
   Why Apache Spark?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html">
   databricks community edition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#essentials-of-databricks-cloud-dbc-in-a-big-hurry">
   Essentials of Databricks Cloud (DBC) in a Big Hurry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-what-is-databricks-cloud">
   DBC Essentials: What is Databricks Cloud?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-shard-cluster-notebook-and-dashboard">
   DBC Essentials: Shard, Cluster, Notebook and Dashboard
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-team-state-collaboration-elastic-resources">
   DBC Essentials: Team, State, Collaboration, Elastic Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#you-should-all-have-databricks-community-edition-account-by-now">
   You Should All Have databricks community edition account by now!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#import-course-content-now">
   Import Course Content Now!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#cloud-free-computing-environment-optional-but-recommended">
   Cloud-free Computing Environment (Optional but recommended)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_01_multiLingualNotebooks.html">
   Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_01_multiLingualNotebooks.html#further-reference-homework-recurrrent-points-of-reference">
   Further Reference / Homework / Recurrrent Points of Reference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html">
   Introduction to Scala through Scala Notebook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-in-your-own-computer">
   Scala in your own computer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-resources">
   Scala Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#introduction-to-scala">
   Introduction to Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#let-s-get-our-hands-dirty-in-scala">
   Let’s get our hands dirty in Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-types">
   Scala Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#expressions">
   Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#blocks">
   Blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#functions">
   Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#methods">
   Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#classes">
   Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#case-classes">
   Case Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#objects">
   Objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#traits">
   Traits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#main-method">
   Main Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#what-i-try-not-do-while-learning-a-new-language">
   What I try not do while learning a new language?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html">
   Scala Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#let-s-continue-to-get-our-hands-dirty-in-scala">
   Let’s continue to get our hands dirty in Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#scala-type-hierarchy">
   Scala Type Hierarchy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#scala-collections">
   Scala Collections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#exercise-in-functional-programming">
   Exercise in Functional Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#lazy-evaluation">
   Lazy Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#recursions">
   Recursions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/004_RDDsTransformationsActions.html">
   Introduction to Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/004_RDDsTransformationsActions.html#spark-cluster-overview">
   Spark Cluster Overview:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/005_RDDsTransformationsActionsHOMEWORK.html">
   HOMEWORK notebook - RDDs Transformations and Actions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html">
   Piped RDDs and Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#from-a-local-collection">
   From a Local Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#glom">
   glom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#checkpointing">
   Checkpointing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#pipe-rdds-to-system-commands">
   Pipe RDDs to System Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#mappartitions">
   mapPartitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#foreachpartition">
   foreachPartition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#numerically-rigorous-bayesian-ab-testing">
   Numerically Rigorous Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#usage-instructions-for-isit1or2coins">
   Usage instructions for IsIt1or2Coins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006_WordCount.html">
   Word Count on US State of the Union (SoU) Addresses
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction to Apache Spark SQL
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html">
   Introduction to Spark SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#overview">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#datasets-and-dataframes">
   Datasets and DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#getting-started-in-spark-2-x">
   Getting Started in Spark 2.x
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007a_SparkSQLProgGuide_HW.html">
   Spark Sql Programming Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html#id1">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007c_SparkSQLProgGuide_HW.html">
   Getting Started - Exercise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html#id1">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007e_SparkSQLProgGuide_HW.html">
   Performance Tuning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html">
   Distributed SQL Engine
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html#id1">
   Distributed SQL Engine
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#sql-pivoting-since-spark-2-4">
   SQL Pivoting since Spark 2.4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#load-data">
   Load Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-in-sql">
   Pivoting in SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-aggregate-expressions">
   Pivoting with Multiple Aggregate Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-grouping-columns">
   Pivoting with Multiple Grouping Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-pivot-columns">
   Pivoting with Multiple Pivot Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html">
   Diamonds ML Pipeline Workflow - DataFrame ETL and EDA Part
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#step-1-load-data-as-dataframe">
   Step 1. Load data as DataFrame
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#step-2-understand-the-data">
   Step 2. Understand the data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#let-us-run-through-some-basic-inteactive-sql-queries-next">
   Let us run through some basic inteactive SQL queries next
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#why-do-we-need-to-know-these-interactive-sql-queries">
   Why do we need to know these interactive SQL queries?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#we-will-continue-later-with-ml-pipelines-to-do-prediction-with-a-fitted-model-from-this-dataset">
   We will continue later with ML pipelines to do prediction with a fitted model from this dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html">
   Power Plant ML Pipeline Application - DataFrame Part
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-1-business-understanding">
   Step 1: Business Understanding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-2-load-your-data">
   Step 2: Load Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#use-this-for-other-smallish-datasets-you-want-to-import-to-your-ce">
   USE THIS FOR OTHER SMALLish DataSets you want to import to your CE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-3-explore-your-data">
   Step 3: Explore Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-4-visualize-your-data">
   Step 4: Visualize Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html">
   Wiki Clickstream Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html#wikipedia-logo">
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_LoadExtract.html">
   Old Bailey Online Data Analysis in Apache Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_LoadExtract.html#analysing-the-full-old-bailey-online-sessions-papers-dataset">
   Analysing the Full Old Bailey Online Sessions Papers Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html">
   Piped RDDs and Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#from-a-local-collection">
   From a Local Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#glom">
   glom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#checkpointing">
   Checkpointing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#pipe-rdds-to-system-commands">
   Pipe RDDs to System Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#mappartitions">
   mapPartitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#foreachpartition">
   foreachPartition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#numerically-rigorous-bayesian-ab-testing">
   Numerically Rigorous Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#usage-instructions-for-isit1or2coins">
   Usage instructions for IsIt1or2Coins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#parsing-the-output-from-isit1or2coins">
   Parsing the output from
   <code class="docutils literal notranslate">
    <span class="pre">
     IsIt1or2Coins
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#providing-case-classes-for-input-and-output-for-easy-spark-communication">
   Providing case classes for input and output for easy spark communication
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/035_LDA_CornellMovieDialogs.html">
   Topic Modeling of Movie Dialogs with Latent Dirichlet Allocation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Distribute Deep Learning with Horovod
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_7-sds-3-x-ddl/00_DDL_Introduction.html">
   Introduction to Distributed Deep Learning (DDL) with Horovod over Tensorflow/keras and Pytorch
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_7-sds-3-x-ddl/0x_mnist-tensorflow-keras.html">
   Distributed deep learning training using TensorFlow and Keras with HorovodRunner
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_7-sds-3-x-ddl/0y_mnist-pytorch.html">
   Distributed deep learning training using PyTorch with HorovodRunner for MNIST
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  WASP AI-Track Student Projects
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/035_LDA_CornellMovieDialogs.html">
   Topic Modeling of Movie Dialogs with Latent Dirichlet Allocation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Voluntary Student Projects
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/030_Spark_GDELT_project.html">
   Plugging into GDELT Streams - TODO - IN PROGRESS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/030_Spark_GDELT_project.html#this-is-just-dipping-our-pinky-toe-in-this-ocean-of-information">
   This is just dipping our pinky toe in this ocean of information!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/030_Spark_GDELT_project.html#download-from-gdelt-project">
   Download from gdelt-project
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/000_0-sds-3-x-projects/student-project-14_group-NullHypothesisEvaluationCriteria/022_GraphFramesUserGuide (1).ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://lamastex.github.io/ScaDaMaLe/index.html"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://lamastex.github.io/ScaDaMaLe/index.html/issues/new?title=Issue%20on%20page%20%2F000_0-sds-3-x-projects/student-project-14_group-NullHypothesisEvaluationCriteria/022_GraphFramesUserGuide (1).html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#distributed-vertex-programming-using-graphx">
     Distributed Vertex Programming using GraphX
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#community-packages-in-spark-more-generally">
     Community Packages in Spark - more generally
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#graphframes-user-guide-scala">
   GraphFrames User Guide (Scala)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-graphframes">
     Creating GraphFrames
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basic-graph-and-dataframe-queries">
     Basic graph and DataFrame queries
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#simple-queries-are-simple">
       Simple queries are simple
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#motif-finding">
     Motif finding
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#an-idea-a-diatribe-into-an-ai-security-product">
       An idea – a diatribe into an AI security product.
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#subgraphs">
       Subgraphs
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#standard-graph-algorithms-in-graphx-conveniently-via-graphframes">
     Standard graph algorithms in GraphX conveniently via GraphFrames
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#breadth-first-search-bfs">
       Breadth-first search (BFS)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#connected-components">
       Connected components
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#strongly-connected-components">
     Strongly connected components
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#label-propagation">
     Label propagation
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pagerank">
     PageRank
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#shortest-paths">
     Shortest paths
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#triangle-count">
       Triangle count
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#youtry">
     YouTry
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#project-idea">
     Project Idea
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-project-ideas">
     Other Project Ideas
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="scadamale-scalable-data-science-and-distributed-machine-learning">
<h1><a class="reference external" href="https://lamastex.github.io/scalable-data-science/sds/3/x/">ScaDaMaLe, Scalable Data Science and Distributed Machine Learning</a><a class="headerlink" href="#scadamale-scalable-data-science-and-distributed-machine-learning" title="Permalink to this headline">¶</a></h1>
<div class="section" id="distributed-vertex-programming-using-graphx">
<h2>Distributed Vertex Programming using GraphX<a class="headerlink" href="#distributed-vertex-programming-using-graphx" title="Permalink to this headline">¶</a></h2>
<p>This is an augmentation of
<a class="reference external" href="http://go.databricks.com/hubfs/notebooks/3-GraphFrames-User-Guide-scala.html">http://go.databricks.com/hubfs/notebooks/3-GraphFrames-User-Guide-scala.html</a>
that was last retrieved in 2019.</p>
<p>See:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://amplab.cs.berkeley.edu/wp-content/uploads/2014/09/graphx.pdf">https://amplab.cs.berkeley.edu/wp-content/uploads/2014/09/graphx.pdf</a></p></li>
<li><p><a class="reference external" href="https://amplab.github.io/graphx/">https://amplab.github.io/graphx/</a></p></li>
<li><p><a class="reference external" href="https://spark.apache.org/docs/latest/graphx-programming-guide.html">https://spark.apache.org/docs/latest/graphx-programming-guide.html</a></p></li>
<li><p><a class="reference external" href="https://databricks.com/blog/2016/03/03/introducing-graphframes.html">https://databricks.com/blog/2016/03/03/introducing-graphframes.html</a></p></li>
<li><p><a class="reference external" href="https://databricks.com/blog/2016/03/16/on-time-flight-performance-with-spark-graphframes.html">https://databricks.com/blog/2016/03/16/on-time-flight-performance-with-spark-graphframes.html</a></p></li>
<li><p><a class="reference external" href="http://ampcamp.berkeley.edu/big-data-mini-course/graph-analytics-with-graphx.html">http://ampcamp.berkeley.edu/big-data-mini-course/graph-analytics-with-graphx.html</a></p></li>
</ul>
<p>And of course the databricks guide: *
<a class="reference external" href="https://docs.databricks.com/spark/latest/graph-analysis/index.html">https://docs.databricks.com/spark/latest/graph-analysis/index.html</a></p>
<p><em>Use the source, Luke/Lea!</em></p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/graphframes/graphframes">https://github.com/graphframes/graphframes</a></p></li>
</ul>
</div>
<div class="section" id="community-packages-in-spark-more-generally">
<h2>Community Packages in Spark - more generally<a class="headerlink" href="#community-packages-in-spark-more-generally" title="Permalink to this headline">¶</a></h2>
<p>Let us recall the following quoate in Chapter 10 of <em>High Performance
Spark</em> book (needs access to Orielly publishers via your
library/subscription): -
https://learning.oreilly.com/library/view/high-performance-spark/9781491943199/ch10.html#components</p>
<blockquote>
<div><p>Beyond the integrated components, the community packages can add
important functionality to Spark, sometimes even superseding built-in
functionality—like with GraphFrames.</p>
</div></blockquote>
<p>Here we introduce you to GraphFrames quickly so you don’t need to drop
down to the GraphX library that requires more understanding of caching
and checkpointing to keep the vertex program’s DAG from exploding or
becoming inefficient.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">This</span> <span class="n">allows</span> <span class="n">easy</span> <span class="n">embedding</span> <span class="n">of</span> <span class="n">publicly</span> <span class="n">available</span> <span class="n">information</span> <span class="n">into</span> <span class="nb">any</span> <span class="n">other</span> <span class="n">notebook</span>
<span class="o">//</span><span class="n">when</span> <span class="n">viewing</span> <span class="ow">in</span> <span class="n">git</span><span class="o">-</span><span class="n">book</span> <span class="n">just</span> <span class="n">ignore</span> <span class="n">this</span> <span class="n">block</span> <span class="o">-</span> <span class="n">you</span> <span class="n">may</span> <span class="n">have</span> <span class="n">to</span> <span class="n">manually</span> <span class="n">chase</span> <span class="n">the</span> <span class="n">URL</span> <span class="ow">in</span> <span class="n">frameIt</span><span class="p">(</span><span class="s2">&quot;URL&quot;</span><span class="p">)</span><span class="o">.</span>
<span class="o">//</span><span class="n">Example</span> <span class="n">usage</span><span class="p">:</span>
<span class="o">//</span> <span class="n">displayHTML</span><span class="p">(</span><span class="n">frameIt</span><span class="p">(</span><span class="s2">&quot;https://en.wikipedia.org/wiki/Latent_Dirichlet_allocation#Topics_in_LDA&quot;</span><span class="p">,</span><span class="mi">250</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">frameIt</span><span class="p">(</span> <span class="n">u</span><span class="p">:</span><span class="n">String</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span><span class="n">Int</span> <span class="p">)</span> <span class="p">:</span> <span class="n">String</span> <span class="o">=</span> <span class="p">{</span>
      <span class="sd">&quot;&quot;&quot;&lt;iframe </span>
<span class="sd"> src=&quot;&quot;&quot;</span><span class="s2">&quot;+ u+&quot;&quot;&quot;&quot;</span>
<span class="s2"> width=&quot;95%&quot; height=&quot;&quot;&quot;&quot; + h + &quot;&quot;&quot;&quot;</span>
<span class="s2"> sandbox&gt;</span>
<span class="s2">  &lt;p&gt;</span>
<span class="s2">    &lt;a href=&quot;http://spark.apache.org/docs/latest/index.html&quot;&gt;</span>
<span class="s2">      Fallback link for browsers that, unlikely, don&#39;t support frames</span>
<span class="s2">    &lt;/a&gt;</span>
<span class="s2">  &lt;/p&gt;</span>
<span class="s2">&lt;/iframe&gt;&quot;&quot;&quot;</span>
   <span class="p">}</span>
<span class="n">displayHTML</span><span class="p">(</span><span class="n">frameIt</span><span class="p">(</span><span class="s2">&quot;https://amplab.github.io/graphx/&quot;</span><span class="p">,</span><span class="mi">700</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">displayHTML</span><span class="p">(</span><span class="n">frameIt</span><span class="p">(</span><span class="s2">&quot;https://spark.apache.org/docs/latest/graphx-programming-guide.html#optimized-representation&quot;</span><span class="p">,</span><span class="mi">800</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="graphframes-user-guide-scala">
<h1>GraphFrames User Guide (Scala)<a class="headerlink" href="#graphframes-user-guide-scala" title="Permalink to this headline">¶</a></h1>
<p>GraphFrames is a package for Apache Spark which provides DataFrame-based
Graphs. It provides high-level APIs in Scala, Java, and Python. It aims
to provide both the functionality of GraphX and extended functionality
taking advantage of Spark DataFrames. This extended functionality
includes motif finding, DataFrame-based serialization, and highly
expressive graph queries.</p>
<p>The GraphFrames package is available from <a class="reference external" href="http://spark-packages.org/package/graphframes/graphframes">Spark
Packages</a>.</p>
<p>This notebook demonstrates examples from the GraphFrames User Guide:
<a class="reference external" href="https://graphframes.github.io/graphframes/docs/_site/user-guide.html">https://graphframes.github.io/graphframes/docs/_site/user-guide.html</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span><span class="o">.</span><span class="n">version</span> <span class="o">//</span> <span class="n">link</span> <span class="n">the</span> <span class="n">right</span> <span class="n">library</span> <span class="n">depending</span> <span class="n">on</span> <span class="n">Spark</span> <span class="n">version</span> <span class="n">of</span> <span class="n">the</span> <span class="n">cluster</span> <span class="n">that</span><span class="s1">&#39;s running</span>
<span class="o">//</span> <span class="n">spark</span> <span class="n">version</span> <span class="mf">2.3</span><span class="o">.</span><span class="mi">0</span> <span class="n">works</span> <span class="k">with</span> <span class="n">graphframes</span><span class="p">:</span><span class="n">graphframes</span><span class="p">:</span><span class="mf">0.7</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">spark2</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="n">s_2</span><span class="o">.</span><span class="mi">11</span>
<span class="o">//</span> <span class="n">spark</span> <span class="n">version</span> <span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span> <span class="n">works</span> <span class="k">with</span> <span class="n">graphframes</span><span class="p">:</span><span class="n">graphframes</span><span class="p">:</span><span class="mf">0.8</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">spark3</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">s_2</span><span class="o">.</span><span class="mi">12</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>res2: String = 3.0.1
</pre></div>
</div>
</div></blockquote>
<p>Since databricks.com stopped allowing IFrame embeds we have to open it
in a separate window now. The blog is insightful and worth a perusal:</p>
<ul class="simple">
<li><p>https://databricks.com/blog/2016/03/03/introducing-graphframes.html</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>// we first need to install the library - graphframes as a Spark package - and attach it to our cluster - see note two cells above!
import org.apache.spark.sql._
import org.apache.spark.sql.functions._

import org.graphframes._
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import org.apache.spark.sql._
import org.apache.spark.sql.functions._
import org.graphframes._
</pre></div>
</div>
</div></blockquote>
<div class="section" id="creating-graphframes">
<h2>Creating GraphFrames<a class="headerlink" href="#creating-graphframes" title="Permalink to this headline">¶</a></h2>
<p>Let us try to create an example social network from the blog: *
<a class="reference external" href="https://databricks.com/blog/2016/03/03/introducing-graphframes.html">https://databricks.com/blog/2016/03/03/introducing-graphframes.html</a>.</p>
<p><img alt="" src="https://databricks.com/wp-content/uploads/2016/03/social-network-graph-diagram.png" /></p>
<p>Users can create GraphFrames from vertex and edge DataFrames.</p>
<ul class="simple">
<li><p><strong>Vertex DataFrame:</strong> A vertex DataFrame should contain a special
column named <code class="docutils literal notranslate"><span class="pre">id</span></code> which specifies unique IDs for each vertex in the
graph.</p></li>
<li><p><strong>Edge DataFrame:</strong> An edge DataFrame should contain two special
columns: <code class="docutils literal notranslate"><span class="pre">src</span></code> (source vertex ID of edge) and <code class="docutils literal notranslate"><span class="pre">dst</span></code> (destination
vertex ID of edge).</p></li>
</ul>
<p>Both DataFrames can have arbitrary other columns. Those columns can
represent vertex and edge attributes.</p>
<p>In our example, we can use a GraphFrame can store data or properties
associated with each vertex and edge.</p>
<p>In our social network, each user might have an age and name, and each
connection might have a relationship type.</p>
<p>Create the vertices and edges</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Vertex</span> <span class="n">DataFrame</span>
<span class="n">val</span> <span class="n">v</span> <span class="o">=</span> <span class="n">sqlContext</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">List</span><span class="p">(</span>
  <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">34</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;Charlie&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;David&quot;</span><span class="p">,</span> <span class="mi">29</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;Esther&quot;</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;Fanny&quot;</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;Gabby&quot;</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="p">))</span><span class="o">.</span><span class="n">toDF</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">)</span>

<span class="o">//</span> <span class="n">Edge</span> <span class="n">DataFrame</span>
<span class="n">val</span> <span class="n">e</span> <span class="o">=</span> <span class="n">sqlContext</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">List</span><span class="p">(</span>
  <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;friend&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;follow&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;follow&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;follow&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;follow&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;friend&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;friend&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;friend&quot;</span><span class="p">)</span>
<span class="p">))</span><span class="o">.</span><span class="n">toDF</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="s2">&quot;dst&quot;</span><span class="p">,</span> <span class="s2">&quot;relationship&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>v: org.apache.spark.sql.DataFrame = [id: string, name: string ... 1 more field]
e: org.apache.spark.sql.DataFrame = [src: string, dst: string ... 1 more field]
</pre></div>
</div>
</div></blockquote>
<p>Let’s create a graph from these vertices and these edges:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">g</span> <span class="o">=</span> <span class="n">GraphFrame</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>g: org.graphframes.GraphFrame = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])
</pre></div>
</div>
</div></blockquote>
<p>Let’s use the d3.graphs to visualise graphs (recall the D3 graphs in
wiki-click example). You need the <code class="docutils literal notranslate"><span class="pre">Run</span> <span class="pre">Cell</span></code> below using that cell’s
<em>Play</em> button’s drop-down menu.</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Warning: classes defined within packages cannot be redefined without a cluster restart.
Compilation successful.
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">d3._</span>
<span class="n">d3</span><span class="o">.</span><span class="n">graphs</span><span class="o">.</span><span class="n">help</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>import org.apache.spark.sql.functions.lit // import the lit function in sql
val gE= g.edges.select($&quot;src&quot;, $&quot;dst&quot;.as(&quot;dest&quot;), lit(1L).as(&quot;count&quot;)) // for us the column count is just an edge incidence
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import org.apache.spark.sql.functions.lit
gE: org.apache.spark.sql.DataFrame = [src: string, dest: string ... 1 more field]
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">gE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d3</span><span class="o">.</span><span class="n">graphs</span><span class="o">.</span><span class="n">force</span><span class="p">(</span>
  <span class="n">height</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
  <span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
  <span class="n">clicks</span> <span class="o">=</span> <span class="n">gE</span><span class="o">.</span><span class="k">as</span><span class="p">[</span><span class="n">d3</span><span class="o">.</span><span class="n">Edge</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">This</span> <span class="n">example</span> <span class="n">graph</span> <span class="n">also</span> <span class="n">comes</span> <span class="k">with</span> <span class="n">the</span> <span class="n">GraphFrames</span> <span class="n">package</span><span class="o">.</span>
<span class="n">val</span> <span class="n">g0</span> <span class="o">=</span> <span class="n">examples</span><span class="o">.</span><span class="n">Graphs</span><span class="o">.</span><span class="n">friends</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>g0: org.graphframes.GraphFrame = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>d3.graphs.force( // let us see g0 now in one cell
  height = 500,
  width = 500,
  clicks = g0.edges.select($&quot;src&quot;, $&quot;dst&quot;.as(&quot;dest&quot;), lit(1L).as(&quot;count&quot;)).as[d3.Edge])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="basic-graph-and-dataframe-queries">
<h2>Basic graph and DataFrame queries<a class="headerlink" href="#basic-graph-and-dataframe-queries" title="Permalink to this headline">¶</a></h2>
<p>GraphFrames provide several simple graph queries, such as node degree.</p>
<p>Also, since GraphFrames represent graphs as pairs of vertex and edge
DataFrames, it is easy to make powerful queries directly on the vertex
and edge DataFrames. Those DataFrames are made available as vertices and
edges fields in the GraphFrame.</p>
<div class="section" id="simple-queries-are-simple">
<h3>Simple queries are simple<a class="headerlink" href="#simple-queries-are-simple" title="Permalink to this headline">¶</a></h3>
<p>GraphFrames make it easy to express queries over graphs. Since
GraphFrame vertices and edges are stored as DataFrames, many queries are
just DataFrame (or SQL) queries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">g0</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span> <span class="o">//</span> <span class="n">this</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">same</span> <span class="n">query</span> <span class="n">on</span> <span class="n">the</span> <span class="n">graph</span> <span class="n">loaded</span> <span class="k">as</span> <span class="n">an</span> <span class="n">example</span> <span class="kn">from</span> <span class="nn">GraphFrame</span> <span class="n">package</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>The incoming degree of the vertices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">inDegrees</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>The outgoing degree of the vertices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">outDegrees</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>The degree of the vertices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">degrees</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>You can run queries directly on the vertices DataFrame. For example, we
can find the age of the youngest person in the graph:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">youngest</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">groupBy</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s2">&quot;age&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">youngest</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>Likewise, you can run queries on the edges DataFrame.</p>
<p>For example, let us count the number of ‘follow’ relationships in the
graph:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">numFollows</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;relationship = &#39;follow&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>numFollows: Long = 4
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="motif-finding">
<h2>Motif finding<a class="headerlink" href="#motif-finding" title="Permalink to this headline">¶</a></h2>
<p>More complex relationships involving edges and vertices can be built
using motifs.</p>
<p>The following cell finds the pairs of vertices with edges in both
directions between them.</p>
<p>The result is a dataframe, in which the column names are given by the
motif keys.</p>
<p>Check out the GraphFrame User Guide at
<a class="reference external" href="https://graphframes.github.io/graphframes/docs/_site/user-guide.html">https://graphframes.github.io/graphframes/docs/_site/user-guide.html</a>
for more details on the API.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Search</span> <span class="k">for</span> <span class="n">pairs</span> <span class="n">of</span> <span class="n">vertices</span> <span class="k">with</span> <span class="n">edges</span> <span class="ow">in</span> <span class="n">both</span> <span class="n">directions</span> <span class="n">between</span> <span class="n">them</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">,</span> <span class="n">find</span> <span class="n">undirected</span> <span class="ow">or</span> <span class="n">bidirected</span> <span class="n">edges</span><span class="o">.</span>
<span class="n">val</span> <span class="n">motifs</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;(a)-[e1]-&gt;(b); (b)-[e2]-&gt;(a)&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">motifs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Since the result is a DataFrame, more complex queries can be built on
top of the motif.</p>
<p>Let us find all the reciprocal relationships in which one person is
older than 30:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">filtered</span> <span class="o">=</span> <span class="n">motifs</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;b.age &gt; 30&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">filtered</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>You Try!</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">Search</span> <span class="k">for</span> <span class="nb">all</span> <span class="s2">&quot;directed triangles&quot;</span> <span class="ow">or</span> <span class="n">triplets</span> <span class="n">of</span> <span class="n">vertices</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span> <span class="k">with</span> <span class="n">edges</span><span class="p">:</span> <span class="n">a</span><span class="o">-&gt;</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">-&gt;</span><span class="n">c</span> <span class="ow">and</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">a</span>
<span class="o">//</span><span class="n">uncomment</span> <span class="n">the</span> <span class="nb">next</span> <span class="mi">2</span> <span class="n">lines</span> <span class="ow">and</span> <span class="n">replace</span> <span class="n">the</span> <span class="s2">&quot;XXX&quot;</span> <span class="n">below</span>
<span class="o">//</span><span class="n">val</span> <span class="n">motifs3</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;(a)-[e1]-&gt;(b); (b)-[e2]-&gt;(c); (c)-[e3]-&gt;(XXX)&quot;</span><span class="p">)</span>
<span class="o">//</span><span class="n">display</span><span class="p">(</span><span class="n">motifs3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Stateful queries</strong></p>
<p>Many motif queries are stateless and simple to express, as in the
examples above. The next examples demonstrate more complex queries which
carry state along a path in the motif. These queries can be expressed by
combining GraphFrame motif finding with filters on the result, where the
filters use sequence operations to construct a series of DataFrame
Columns.</p>
<p>For example, suppose one wishes to identify a chain of 4 vertices with
some property defined by a sequence of functions. That is, among chains
of 4 vertices <code class="docutils literal notranslate"><span class="pre">a-&gt;b-&gt;c-&gt;d</span></code>, identify the subset of chains matching this
complex filter:</p>
<ul class="simple">
<li><p>Initialize state on path.</p></li>
<li><p>Update state based on vertex a.</p></li>
<li><p>Update state based on vertex b.</p></li>
<li><p>Etc. for c and d.</p></li>
<li><p>If final state matches some condition, then the chain is accepted by
the filter.</p></li>
</ul>
<p>The below code snippets demonstrate this process, where we identify
chains of 4 vertices such that at least 2 of the 3 edges are <code class="docutils literal notranslate"><span class="pre">friend</span></code>
relationships. In this example, the state is the current count of
<code class="docutils literal notranslate"><span class="pre">friend</span></code> edges; in general, it could be any DataFrame Column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Find</span> <span class="n">chains</span> <span class="n">of</span> <span class="mi">4</span> <span class="n">vertices</span><span class="o">.</span>
<span class="n">val</span> <span class="n">chain4</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;(a)-[ab]-&gt;(b); (b)-[bc]-&gt;(c); (c)-[cd]-&gt;(d)&quot;</span><span class="p">)</span>

<span class="o">//</span> <span class="n">Query</span> <span class="n">on</span> <span class="n">sequence</span><span class="p">,</span> <span class="k">with</span> <span class="n">state</span> <span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
<span class="o">//</span>  <span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="n">Define</span> <span class="n">method</span> <span class="k">for</span> <span class="n">updating</span> <span class="n">state</span> <span class="n">given</span> <span class="n">the</span> <span class="nb">next</span> <span class="n">element</span> <span class="n">of</span> <span class="n">the</span> <span class="n">motif</span><span class="o">.</span>
<span class="k">def</span> <span class="nf">sumFriends</span><span class="p">(</span><span class="n">cnt</span><span class="p">:</span> <span class="n">Column</span><span class="p">,</span> <span class="n">relationship</span><span class="p">:</span> <span class="n">Column</span><span class="p">):</span> <span class="n">Column</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">when</span><span class="p">(</span><span class="n">relationship</span> <span class="o">===</span> <span class="s2">&quot;friend&quot;</span><span class="p">,</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
<span class="p">}</span>
<span class="o">//</span>  <span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="n">Use</span> <span class="n">sequence</span> <span class="n">operation</span> <span class="n">to</span> <span class="n">apply</span> <span class="n">method</span> <span class="n">to</span> <span class="n">sequence</span> <span class="n">of</span> <span class="n">elements</span> <span class="ow">in</span> <span class="n">motif</span><span class="o">.</span>
<span class="o">//</span>      <span class="n">In</span> <span class="n">this</span> <span class="n">case</span><span class="p">,</span> <span class="n">the</span> <span class="n">elements</span> <span class="n">are</span> <span class="n">the</span> <span class="mi">3</span> <span class="n">edges</span><span class="o">.</span>
<span class="n">val</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">Seq</span><span class="p">(</span><span class="s2">&quot;ab&quot;</span><span class="p">,</span> <span class="s2">&quot;bc&quot;</span><span class="p">,</span> <span class="s2">&quot;cd&quot;</span><span class="p">)</span><span class="o">.</span>
  <span class="n">foldLeft</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mi">0</span><span class="p">))((</span><span class="n">cnt</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">sumFriends</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="n">e</span><span class="p">)(</span><span class="s2">&quot;relationship&quot;</span><span class="p">)))</span>
<span class="o">//</span>  <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="n">Apply</span> <span class="nb">filter</span> <span class="n">to</span> <span class="n">DataFrame</span><span class="o">.</span>
<span class="n">val</span> <span class="n">chainWith2Friends2</span> <span class="o">=</span> <span class="n">chain4</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">condition</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">chainWith2Friends2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chain4</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>res22: org.apache.spark.sql.DataFrame = [a: struct&lt;id: string, name: string ... 1 more field&gt;, ab: struct&lt;src: string, dst: string ... 1 more field&gt; ... 5 more fields]
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chain4</span><span class="o">.</span><span class="n">printSchema</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>root
 |-- a: struct (nullable = false)
 |    |-- id: string (nullable = true)
 |    |-- name: string (nullable = true)
 |    |-- age: integer (nullable = false)
 |-- ab: struct (nullable = false)
 |    |-- src: string (nullable = true)
 |    |-- dst: string (nullable = true)
 |    |-- relationship: string (nullable = true)
 |-- b: struct (nullable = false)
 |    |-- id: string (nullable = true)
 |    |-- name: string (nullable = true)
 |    |-- age: integer (nullable = false)
 |-- bc: struct (nullable = false)
 |    |-- src: string (nullable = true)
 |    |-- dst: string (nullable = true)
 |    |-- relationship: string (nullable = true)
 |-- c: struct (nullable = false)
 |    |-- id: string (nullable = true)
 |    |-- name: string (nullable = true)
 |    |-- age: integer (nullable = false)
 |-- cd: struct (nullable = false)
 |    |-- src: string (nullable = true)
 |    |-- dst: string (nullable = true)
 |    |-- relationship: string (nullable = true)
 |-- d: struct (nullable = false)
 |    |-- id: string (nullable = true)
 |    |-- name: string (nullable = true)
 |    |-- age: integer (nullable = false)
</pre></div>
</div>
</div></blockquote>
<div class="section" id="an-idea-a-diatribe-into-an-ai-security-product">
<h3>An idea – a diatribe into an AI security product.<a class="headerlink" href="#an-idea-a-diatribe-into-an-ai-security-product" title="Permalink to this headline">¶</a></h3>
<p>Can you think of a way to use stateful queries in social media networks
to find perpetrators of hate-speech online who are possibly worthy of an
investigation by domain experts, say in the intelligence or security
domain, for potential prosecution on charges of having incited another
person to cause physical violence… This is a real problem today as
Swedish law effectively prohibits certain forms of online hate-speech.</p>
<p>An idea for a product that can be used by Swedish security agencies?</p>
<p>See <a class="reference external" href="https://n%C3%A4thatsgranskaren.se/">https://näthatsgranskaren.se/</a> for
details of a non-profit in Sweden doing such operaitons mostly manually
as of early 2020.</p>
</div>
<div class="section" id="subgraphs">
<h3>Subgraphs<a class="headerlink" href="#subgraphs" title="Permalink to this headline">¶</a></h3>
<p>Subgraphs are built by filtering a subset of edges and vertices. For
example, the following subgraph only contains people who are friends and
who are more than 30 years old.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Select</span> <span class="n">subgraph</span> <span class="n">of</span> <span class="n">users</span> <span class="n">older</span> <span class="n">than</span> <span class="mi">30</span><span class="p">,</span> <span class="ow">and</span> <span class="n">edges</span> <span class="n">of</span> <span class="nb">type</span> <span class="s2">&quot;friend&quot;</span>
<span class="n">val</span> <span class="n">v2</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;age &gt; 30&quot;</span><span class="p">)</span>
<span class="n">val</span> <span class="n">e2</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;relationship = &#39;friend&#39;&quot;</span><span class="p">)</span>
<span class="n">val</span> <span class="n">g2</span> <span class="o">=</span> <span class="n">GraphFrame</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>v2: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: string, name: string ... 1 more field]
e2: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [src: string, dst: string ... 1 more field]
g2: org.graphframes.GraphFrame = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">g2</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">g2</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>d3.graphs.force( // let us see g2 now in one cell
  height = 500,
  width = 500,
  clicks = g2.edges.select($&quot;src&quot;, $&quot;dst&quot;.as(&quot;dest&quot;), lit(1L).as(&quot;count&quot;)).as[d3.Edge])
</pre></div>
</div>
</div>
</div>
<p><strong>Complex triplet filters</strong></p>
<p>The following example shows how to select a subgraph based upon triplet
filters which operate on:</p>
<ul class="simple">
<li><p>an edge and</p></li>
<li><p>its src and</p></li>
<li><p>dst vertices.</p></li>
</ul>
<p>This example could be extended to go beyond triplets by using more
complex motifs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Select</span> <span class="n">subgraph</span> <span class="n">based</span> <span class="n">on</span> <span class="n">edges</span> <span class="s2">&quot;e&quot;</span> <span class="n">of</span> <span class="nb">type</span> <span class="s2">&quot;follow&quot;</span>
<span class="o">//</span> <span class="n">pointing</span> <span class="kn">from</span> <span class="nn">a</span> <span class="n">younger</span> <span class="n">user</span> <span class="s2">&quot;a&quot;</span> <span class="n">to</span> <span class="n">an</span> <span class="n">older</span> <span class="n">user</span> <span class="s2">&quot;b&quot;</span><span class="o">.</span>
<span class="n">val</span> <span class="n">paths</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;(a)-[e]-&gt;(b)&quot;</span><span class="p">)</span>
  <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;e.relationship = &#39;follow&#39;&quot;</span><span class="p">)</span>
  <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;a.age &lt; b.age&quot;</span><span class="p">)</span>
<span class="o">//</span> <span class="s2">&quot;paths&quot;</span> <span class="n">contains</span> <span class="n">vertex</span> <span class="n">info</span><span class="o">.</span> <span class="n">Extract</span> <span class="n">the</span> <span class="n">edges</span><span class="o">.</span>
<span class="n">val</span> <span class="n">e2</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;e.src&quot;</span><span class="p">,</span> <span class="s2">&quot;e.dst&quot;</span><span class="p">,</span> <span class="s2">&quot;e.relationship&quot;</span><span class="p">)</span>
<span class="o">//</span> <span class="n">In</span> <span class="n">Spark</span> <span class="mf">1.5</span><span class="o">+</span><span class="p">,</span> <span class="n">the</span> <span class="n">user</span> <span class="n">may</span> <span class="n">simplify</span> <span class="n">this</span> <span class="n">call</span><span class="p">:</span>
<span class="o">//</span>  <span class="n">val</span> <span class="n">e2</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;e.*&quot;</span><span class="p">)</span>

<span class="o">//</span> <span class="n">Construct</span> <span class="n">the</span> <span class="n">subgraph</span>
<span class="n">val</span> <span class="n">g2</span> <span class="o">=</span> <span class="n">GraphFrame</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>paths: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [a: struct&lt;id: string, name: string ... 1 more field&gt;, e: struct&lt;src: string, dst: string ... 1 more field&gt; ... 1 more field]
e2: org.apache.spark.sql.DataFrame = [src: string, dst: string ... 1 more field]
g2: org.graphframes.GraphFrame = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">g2</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">g2</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
</div>
</div>
<div class="section" id="standard-graph-algorithms-in-graphx-conveniently-via-graphframes">
<h2>Standard graph algorithms in GraphX conveniently via GraphFrames<a class="headerlink" href="#standard-graph-algorithms-in-graphx-conveniently-via-graphframes" title="Permalink to this headline">¶</a></h2>
<p>GraphFrames comes with a number of standard graph algorithms built in:</p>
<ul class="simple">
<li><p>Breadth-first search (BFS)</p></li>
<li><p>Connected components</p></li>
<li><p>Strongly connected components</p></li>
<li><p>Label Propagation Algorithm (LPA)</p></li>
<li><p>PageRank</p></li>
<li><p>Shortest paths</p></li>
<li><p>Triangle count</p></li>
</ul>
<div class="section" id="breadth-first-search-bfs">
<h3>Breadth-first search (BFS)<a class="headerlink" href="#breadth-first-search-bfs" title="Permalink to this headline">¶</a></h3>
<p>Read</p>
<p>https://graphframes.github.io/graphframes/docs/_site/user-guide.html</p>
<ul class="simple">
<li><p><a class="reference external" href="https://graphframes.github.io/graphframes/docs/_site/user-guide.html#breadth-first-search-bfs">graphframes user-guide
breadth-first-search-bfs</a>.</p></li>
</ul>
<p>Search from “Esther” for users of age &lt; 32.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Search</span> <span class="kn">from</span> <span class="s2">&quot;Esther&quot;</span> <span class="k">for</span> <span class="n">users</span> <span class="n">of</span> <span class="n">age</span> <span class="o">&lt;=</span> <span class="mf">32.</span>
<span class="n">val</span> <span class="n">paths</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">bfs</span><span class="o">.</span><span class="n">fromExpr</span><span class="p">(</span><span class="s2">&quot;name = &#39;Esther&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">toExpr</span><span class="p">(</span><span class="s2">&quot;age &lt; 32&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">paths</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">bfs</span><span class="o">.</span><span class="n">fromExpr</span><span class="p">(</span><span class="s2">&quot;name = &#39;Esther&#39; OR name = &#39;Bob&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">toExpr</span><span class="p">(</span><span class="s2">&quot;age &lt; 32&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The search may also be limited by edge filters and maximum path lengths.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">filteredPaths</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">bfs</span><span class="o">.</span><span class="n">fromExpr</span><span class="p">(</span><span class="s2">&quot;name = &#39;Esther&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">toExpr</span><span class="p">(</span><span class="s2">&quot;age &lt; 32&quot;</span><span class="p">)</span>
  <span class="o">.</span><span class="n">edgeFilter</span><span class="p">(</span><span class="s2">&quot;relationship != &#39;friend&#39;&quot;</span><span class="p">)</span>
  <span class="o">.</span><span class="n">maxPathLength</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
  <span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">filteredPaths</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="connected-components">
<h3>Connected components<a class="headerlink" href="#connected-components" title="Permalink to this headline">¶</a></h3>
<p>Compute the connected component membership of each vertex and return a
graph with each vertex assigned a component ID.</p>
<p>READ
<a class="reference external" href="https://graphframes.github.io/graphframes/docs/_site/user-guide.html#connected-components">https://graphframes.github.io/graphframes/docs/_site/user-guide.html#connected-components</a>.</p>
<p>From
<a class="reference external" href="https://graphframes.github.io/graphframes/docs/_site/user-guide.html#connected-components">https://graphframes.github.io/graphframes/docs/_site/user-guide.html#connected-components</a>:-</p>
<p>NOTE: With GraphFrames 0.3.0 and later releases, the default Connected
Components algorithm requires setting a Spark checkpoint directory.
Users can revert to the old algorithm using <code class="docutils literal notranslate"><span class="pre">.setAlgorithm(&quot;graphx&quot;)</span></code>.</p>
<p>Recall the following quote from <a class="reference external" href="https://learning.oreilly.com/library/view/high-performance-spark/9781491943199/ch05.html">Chapter 5 on <em>Effective
Transformations</em> of the <em>High Performance Spark</em>
Book</a>
why one needs to check-point to keep the RDD lineage DAGs from growing
too large.</p>
<blockquote>
<div><p><strong>Types of Reuse: Cache, Persist, Checkpoint, Shuffle Files</strong> If you
decide that you need to reuse your RDD, Spark provides a multitude of
options for how to store the RDD. Thus it is important to understand
when to use the various types of persistence.There are three primary
operations that you can use to store your RDD: cache, persist, and
checkpoint. In general, caching (equivalent to persisting with the
in-memory storage) and persisting are most useful to avoid
recomputation during one Spark job or to break RDDs with long
lineages, since they keep an RDD on the executors during a Spark job.
<strong>Checkpointing is most useful to prevent failures and a high cost of
recomputation by saving intermediate results. Like persisting,
checkpointing helps avoid computation, thus minimizing the cost of
failure, and avoids recomputation by breaking the lineage graph.</strong></p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span><span class="o">.</span><span class="n">setCheckpointDir</span><span class="p">(</span><span class="s2">&quot;/_checkpoint&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="n">just</span> <span class="n">a</span> <span class="n">directory</span> <span class="ow">in</span> <span class="n">distributed</span> <span class="n">file</span> <span class="n">system</span>
<span class="n">val</span> <span class="n">result</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">connectedComponents</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> 
<span class="n">display</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>Fun Exercise: Try to modify the d3.graph function to allow a
visualisation of a given Sequence of <code class="docutils literal notranslate"><span class="pre">component</span></code> ids in the above
<code class="docutils literal notranslate"><span class="pre">result</span></code>.</p>
</div>
</div>
<div class="section" id="strongly-connected-components">
<h2>Strongly connected components<a class="headerlink" href="#strongly-connected-components" title="Permalink to this headline">¶</a></h2>
<p>Compute the strongly connected component (SCC) of each vertex and return
a graph with each vertex assigned to the SCC containing that vertex.</p>
<p>READ
<a class="reference external" href="https://graphframes.github.io/graphframes/docs/_site/user-guide.html#strongly-connected-components">https://graphframes.github.io/graphframes/docs/_site/user-guide.html#strongly-connected-components</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">result</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">stronglyConnectedComponents</span><span class="o">.</span><span class="n">maxIter</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="s2">&quot;component&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
</div>
<div class="section" id="label-propagation">
<h2>Label propagation<a class="headerlink" href="#label-propagation" title="Permalink to this headline">¶</a></h2>
<p>Run static Label Propagation Algorithm for detecting communities in
networks.</p>
<p>Each node in the network is initially assigned to its own community. At
every superstep, nodes send their community affiliation to all neighbors
and update their state to the mode community affiliation of incoming
messages.</p>
<p>LPA is a standard community detection algorithm for graphs. It is very
inexpensive computationally, although</p>
<ul class="simple">
<li><p>(1) convergence is not guaranteed and</p></li>
<li><p>(2) one can end up with trivial solutions (all nodes are
identified into a single community).</p></li>
</ul>
<p>READ:
<a class="reference external" href="https://graphframes.github.io/graphframes/docs/_site/user-guide.html#label-propagation-algorithm-lpa">https://graphframes.github.io/graphframes/docs/_site/user-guide.html#label-propagation-algorithm-lpa</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">result</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">labelPropagation</span><span class="o">.</span><span class="n">maxIter</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
</div>
<div class="section" id="pagerank">
<h2>PageRank<a class="headerlink" href="#pagerank" title="Permalink to this headline">¶</a></h2>
<p>Identify important vertices in a graph based on connections.</p>
<p>READ:
<a class="reference external" href="https://graphframes.github.io/graphframes/docs/_site/user-guide.html#pagerank">https://graphframes.github.io/graphframes/docs/_site/user-guide.html#pagerank</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Run</span> <span class="n">PageRank</span> <span class="n">until</span> <span class="n">convergence</span> <span class="n">to</span> <span class="n">tolerance</span> <span class="s2">&quot;tol&quot;</span><span class="o">.</span>
<span class="n">val</span> <span class="n">results</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">pageRank</span><span class="o">.</span><span class="n">resetProbability</span><span class="p">(</span><span class="mf">0.15</span><span class="p">)</span><span class="o">.</span><span class="n">tol</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Run</span> <span class="n">PageRank</span> <span class="k">for</span> <span class="n">a</span> <span class="n">fixed</span> <span class="n">number</span> <span class="n">of</span> <span class="n">iterations</span><span class="o">.</span>
<span class="n">val</span> <span class="n">results2</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">pageRank</span><span class="o">.</span><span class="n">resetProbability</span><span class="p">(</span><span class="mf">0.15</span><span class="p">)</span><span class="o">.</span><span class="n">maxIter</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">results2</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Run</span> <span class="n">PageRank</span> <span class="n">personalized</span> <span class="k">for</span> <span class="n">vertex</span> <span class="s2">&quot;a&quot;</span>
<span class="n">val</span> <span class="n">results3</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">pageRank</span><span class="o">.</span><span class="n">resetProbability</span><span class="p">(</span><span class="mf">0.15</span><span class="p">)</span><span class="o">.</span><span class="n">maxIter</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">sourceId</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">results3</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
</div>
<div class="section" id="shortest-paths">
<h2>Shortest paths<a class="headerlink" href="#shortest-paths" title="Permalink to this headline">¶</a></h2>
<p>Computes shortest paths to the given set of landmark vertices, where
landmarks are specified by vertex ID.</p>
<p>READ
<a class="reference external" href="https://graphframes.github.io/graphframes/docs/_site/user-guide.html#shortest-paths">https://graphframes.github.io/graphframes/docs/_site/user-guide.html#shortest-paths</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">paths</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">shortestPaths</span><span class="o">.</span><span class="n">landmarks</span><span class="p">(</span><span class="n">Seq</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+---+---+------------+
|src|dst|relationship|
+---+---+------------+
|  a|  b|      friend|
|  b|  c|      follow|
|  c|  b|      follow|
|  f|  c|      follow|
|  e|  f|      follow|
|  e|  d|      friend|
|  d|  a|      friend|
|  a|  e|      friend|
+---+---+------------+
</pre></div>
</div>
</div></blockquote>
<div class="section" id="triangle-count">
<h3>Triangle count<a class="headerlink" href="#triangle-count" title="Permalink to this headline">¶</a></h3>
<p>Computes the number of triangles passing through each vertex.</p>
<p>See
<a class="reference external" href="https://graphframes.github.io/graphframes/docs/_site/user-guide.html#triangle-count">https://graphframes.github.io/graphframes/docs/_site/user-guide.html#triangle-count</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">results</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">triangleCount</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
</div>
</div>
<div class="section" id="youtry">
<h2>YouTry<a class="headerlink" href="#youtry" title="Permalink to this headline">¶</a></h2>
<p>Read about
<a class="reference external" href="https://graphframes.github.io/graphframes/docs/_site/user-guide.html#message-passing-via-aggregatemessages">https://graphframes.github.io/graphframes/docs/_site/user-guide.html#message-passing-via-aggregatemessages</a></p>
<p>and undestand how the below code snippet shows how to use
aggregateMessages to compute the sum of the ages of adjacent users.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.graphframes.</span><span class="p">{</span><span class="n">examples</span><span class="p">,</span><span class="n">GraphFrame</span><span class="p">}</span>
<span class="kn">import</span> <span class="nn">org.graphframes.lib.AggregateMessages</span>
<span class="n">val</span> <span class="n">g</span><span class="p">:</span> <span class="n">GraphFrame</span> <span class="o">=</span> <span class="n">examples</span><span class="o">.</span><span class="n">Graphs</span><span class="o">.</span><span class="n">friends</span>  <span class="o">//</span> <span class="n">get</span> <span class="n">example</span> <span class="n">graph</span>

<span class="o">//</span> <span class="n">We</span> <span class="n">will</span> <span class="n">use</span> <span class="n">AggregateMessages</span> <span class="n">utilities</span> <span class="n">later</span><span class="p">,</span> <span class="n">so</span> <span class="n">name</span> <span class="n">it</span> <span class="s2">&quot;AM&quot;</span> <span class="k">for</span> <span class="n">short</span><span class="o">.</span>
<span class="n">val</span> <span class="n">AM</span> <span class="o">=</span> <span class="n">AggregateMessages</span>

<span class="o">//</span> <span class="n">For</span> <span class="n">each</span> <span class="n">user</span><span class="p">,</span> <span class="nb">sum</span> <span class="n">the</span> <span class="n">ages</span> <span class="n">of</span> <span class="n">the</span> <span class="n">adjacent</span> <span class="n">users</span><span class="o">.</span>
<span class="n">val</span> <span class="n">msgToSrc</span> <span class="o">=</span> <span class="n">AM</span><span class="o">.</span><span class="n">dst</span><span class="p">(</span><span class="s2">&quot;age&quot;</span><span class="p">)</span>
<span class="n">val</span> <span class="n">msgToDst</span> <span class="o">=</span> <span class="n">AM</span><span class="o">.</span><span class="n">src</span><span class="p">(</span><span class="s2">&quot;age&quot;</span><span class="p">)</span>
<span class="n">val</span> <span class="n">agg</span> <span class="o">=</span> <span class="p">{</span> <span class="n">g</span><span class="o">.</span><span class="n">aggregateMessages</span>
  <span class="o">.</span><span class="n">sendToSrc</span><span class="p">(</span><span class="n">msgToSrc</span><span class="p">)</span>  <span class="o">//</span> <span class="n">send</span> <span class="n">destination</span> <span class="n">user</span><span class="s1">&#39;s age to source</span>
  <span class="o">.</span><span class="n">sendToDst</span><span class="p">(</span><span class="n">msgToDst</span><span class="p">)</span>  <span class="o">//</span> <span class="n">send</span> <span class="n">source</span> <span class="n">user</span><span class="s1">&#39;s age to destination</span>
  <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">AM</span><span class="o">.</span><span class="n">msg</span><span class="p">)</span><span class="o">.</span><span class="k">as</span><span class="p">(</span><span class="s2">&quot;summedAges&quot;</span><span class="p">))</span> <span class="p">}</span> <span class="o">//</span> <span class="nb">sum</span> <span class="n">up</span> <span class="n">ages</span><span class="p">,</span> <span class="n">stored</span> <span class="ow">in</span> <span class="n">AM</span><span class="o">.</span><span class="n">msg</span> <span class="n">column</span>
<span class="n">agg</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+---+----------+
| id|summedAges|
+---+----------+
|  a|        97|
|  c|       108|
|  e|        99|
|  d|        66|
|  b|        94|
|  f|        62|
+---+----------+

import org.graphframes.{examples, GraphFrame}
import org.graphframes.lib.AggregateMessages
g: org.graphframes.GraphFrame = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])
AM: org.graphframes.lib.AggregateMessages.type = org.graphframes.lib.AggregateMessages$@706833c8
msgToSrc: org.apache.spark.sql.Column = dst[age]
msgToDst: org.apache.spark.sql.Column = src[age]
agg: org.apache.spark.sql.DataFrame = [id: string, summedAges: bigint]
</pre></div>
</div>
</div></blockquote>
<p>There is a lot more that can be done with aggregate messaging - let’s
get into belief propogation algorithm for a more complex example!</p>
<p>Belief propogation is a powerful computational framework for Graphical
Models.</p>
<ul class="simple">
<li><p>let’s dive here:</p>
<ul>
<li><p><a class="reference external" href="https://github.com/graphframes/graphframes/blob/master/src/main/scala/org/graphframes/examples/BeliefPropagation.scala">https://github.com/graphframes/graphframes/blob/master/src/main/scala/org/graphframes/examples/BeliefPropagation.scala</a></p></li>
</ul>
</li>
</ul>
<p>as</p>
<blockquote>
<div><p>This provides a template for building customized BP algorithms for
different types of graphical models.</p>
</div></blockquote>
</div>
<div class="section" id="project-idea">
<h2>Project Idea<a class="headerlink" href="#project-idea" title="Permalink to this headline">¶</a></h2>
<p>Understand <em>parallel belief propagation using colored fields</em> in the
Scala code linked above and also pasted below in one cell (for you to
modify if you want to do it in a databricks or jupyter or zeppelin
notebook) unless you want to fork and extend the github repo directly
with your own example.</p>
<p>Then use it with necessary adaptations to be able to model your favorite
interacting particle system. Don’t just redo the Ising model done there!</p>
<p>This can be used to gain intuition for various real-world scenarios,
including the mathematics in your head:</p>
<ul class="simple">
<li><p>Make a graph for contact network of a set of hosts</p></li>
<li><p>A simple model of COVID spreading in an SI or SIS or SIR or other
epidemic models</p>
<ul>
<li><p>this can be abstract and simply show your skills in programming,
say create a random network</p></li>
<li><p>or be more explicit with some assumptions about the contact
process (population sampled, in one or two cities, with some
assumptions on contacts during transportation, school, work,
etc)</p></li>
<li><p>show that you have a fully scalable simulation model that can
theoretically scale to billions of hosts</p></li>
</ul>
</li>
</ul>
<p>The project does not have to be a recommendation to Swedish authorities!
Just a start in the right direction, for instance.</p>
<p>Some readings that can help here include the following and references
therein:</p>
<ul class="simple">
<li><p>The Transmission Process: A Combinatorial Stochastic Process for the
Evolution of Transmission Trees over Networks, Raazesh Sainudiin and
David Welch, Journal of Theoretical Biology, Volume 410, Pages
137–170,
<a class="reference external" href="http://dx.doi.org/10.1016/j.jtbi.2016.07.038">10.1016/j.jtbi.2016.07.038</a>, 2016.</p></li>
</ul>
</div>
<div class="section" id="other-project-ideas">
<h2>Other Project Ideas<a class="headerlink" href="#other-project-ideas" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>try to do a scalable inference algorithm for one of the graphical
models that you already know…</p></li>
<li><p>make a large simulaiton of your favourite <em>Finite Markov Information
Exchange (FMIE)</em> process defined by Aldous (see reference in the
above linked paper)</p></li>
<li><p>anything else that fancies you or your research
orientation/interests and can benefit from adapting the template for
the <em>parallel belief propagation</em> algorithm here.</p></li>
</ul>
<p>If you want to do this project in databricks (or other) notebook then
start by modifying the following code from the example and making it
run… Then adapt… start in small steps… make a team with fellow
students with complementary skills…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.graphframes.examples

import org.apache.spark.{SparkConf, SparkContext}
import org.apache.spark.graphx.{Graph, VertexRDD, Edge =&gt; GXEdge}
import org.apache.spark.sql.{Column, Row, SparkSession, SQLContext}
import org.apache.spark.sql.functions.{col, lit, sum, udf, when}

import org.graphframes.GraphFrame
import org.graphframes.examples.Graphs.gridIsingModel
import org.graphframes.lib.AggregateMessages


/**
 * Example code for Belief Propagation (BP)
 *
 * This provides a template for building customized BP algorithms for different types of
 * graphical models.
 *
 * This example:
 *  - Ising model on a grid
 *  - Parallel Belief Propagation using colored fields
 *
 * Ising models are probabilistic graphical models over binary variables x,,i,,.
 * Each binary variable x,,i,, corresponds to one vertex, and it may take values -1 or +1.
 * The probability distribution P(X) (over all x,,i,,) is parameterized by vertex factors a,,i,,
 * and edge factors b,,ij,,:
 * {{{
 *  P(X) = (1/Z) * exp[ \sum_i a_i x_i + \sum_{ij} b_{ij} x_i x_j ]
 * }}}
 * where Z is the normalization constant (partition function).
 * See [[https://en.wikipedia.org/wiki/Ising_model Wikipedia]] for more information on Ising models.
 *
 * Belief Propagation (BP) provides marginal probabilities of the values of the variables x,,i,,,
 * i.e., P(x,,i,,) for each i.  This allows a user to understand likely values of variables.
 * See [[https://en.wikipedia.org/wiki/Belief_propagation Wikipedia]] for more information on BP.
 *
 * We use a batch synchronous BP algorithm, where batches of vertices are updated synchronously.
 * We follow the mean field update algorithm in Slide 13 of the
 * [[http://www.eecs.berkeley.edu/~wainwrig/Talks/A_GraphModel_Tutorial  talk slides]] from:
 *  Wainwright. &quot;Graphical models, message-passing algorithms, and convex optimization.&quot;
 *
 * The batches are chosen according to a coloring.  For background on graph colorings for inference,
 * see for example:
 *  Gonzalez et al. &quot;Parallel Gibbs Sampling: From Colored Fields to Thin Junction Trees.&quot;
 *  AISTATS, 2011.
 *
 * The BP algorithm works by:
 *  - Coloring the graph by assigning a color to each vertex such that no neighboring vertices
 *    share the same color.
 *  - In each step of BP, update all vertices of a single color.  Alternate colors.
 */
object BeliefPropagation {

  def main(args: Array[String]): Unit = {
    val spark = SparkSession
      .builder()
      .appName(&quot;BeliefPropagation example&quot;)
      .getOrCreate()

    val sql = spark.sqlContext

    // Create graphical model g of size 3 x 3.
    val g = gridIsingModel(sql, 3)

    println(&quot;Original Ising model:&quot;)
    g.vertices.show()
    g.edges.show()

    // Run BP for 5 iterations.
    val numIter = 5
    val results = runBPwithGraphX(g, numIter)

    // Display beliefs.
    val beliefs = results.vertices.select(&quot;id&quot;, &quot;belief&quot;)
    println(s&quot;Done with BP. Final beliefs after $numIter iterations:&quot;)
    beliefs.show()

    spark.stop()
  }

  /**
   * Given a GraphFrame, choose colors for each vertex.  No neighboring vertices will share the
   * same color.  The number of colors is minimized.
   *
   * This is written specifically for grid graphs. For non-grid graphs, it should be generalized,
   * such as by using a greedy coloring scheme.
   *
   * @param g  Grid graph generated by [[org.graphframes.examples.Graphs.gridIsingModel()]]
   * @return  Same graph, but with a new vertex column &quot;color&quot; of type Int (0 or 1)
   */
  private def colorGraph(g: GraphFrame): GraphFrame = {
    val colorUDF = udf { (i: Int, j: Int) =&gt; (i + j) % 2 }
    val v = g.vertices.withColumn(&quot;color&quot;, colorUDF(col(&quot;i&quot;), col(&quot;j&quot;)))
    GraphFrame(v, g.edges)
  }

  /**
   * Run Belief Propagation.
   *
   * This implementation of BP shows how to use GraphX&#39;s aggregateMessages method.
   * It is simple to convert to and from GraphX format.  This method does the following:
   *  - Color GraphFrame vertices for BP scheduling.
   *  - Convert GraphFrame to GraphX format.
   *  - Run BP using GraphX&#39;s aggregateMessages API.
   *  - Augment the original GraphFrame with the BP results (vertex beliefs).
   *
   * @param g  Graphical model created by `org.graphframes.examples.Graphs.gridIsingModel()`
   * @param numIter  Number of iterations of BP to run.  One iteration includes updating each
   *                 vertex&#39;s belief once.
   * @return  Same graphical model, but with [[GraphFrame.vertices]] augmented with a new column
   *          &quot;belief&quot; containing P(x,,i,, = +1), the marginal probability of vertex i taking
   *          value +1 instead of -1.
   */
  def runBPwithGraphX(g: GraphFrame, numIter: Int): GraphFrame = {
    // Choose colors for vertices for BP scheduling.
    val colorG = colorGraph(g)
    val numColors: Int = colorG.vertices.select(&quot;color&quot;).distinct.count().toInt

    // Convert GraphFrame to GraphX, and initialize beliefs.
    val gx0 = colorG.toGraphX
    // Schema maps for extracting attributes
    val vColsMap = colorG.vertexColumnMap
    val eColsMap = colorG.edgeColumnMap
    // Convert vertex attributes to nice case classes.
    val gx1: Graph[VertexAttr, Row] = gx0.mapVertices { case (_, attr) =&gt;
      // Initialize belief at 0.0
      VertexAttr(attr.getDouble(vColsMap(&quot;a&quot;)), 0.0, attr.getInt(vColsMap(&quot;color&quot;)))
    }
    // Convert edge attributes to nice case classes.
    val extractEdgeAttr: (GXEdge[Row] =&gt; EdgeAttr) = { e =&gt;
      EdgeAttr(e.attr.getDouble(eColsMap(&quot;b&quot;)))
    }
    var gx: Graph[VertexAttr, EdgeAttr] = gx1.mapEdges(extractEdgeAttr)

    // Run BP for numIter iterations.
    for (iter &lt;- Range(0, numIter)) {
      // For each color, have that color receive messages from neighbors.
      for (color &lt;- Range(0, numColors)) {
        // Send messages to vertices of the current color.
        val msgs: VertexRDD[Double] = gx.aggregateMessages(
          ctx =&gt;
            // Can send to source or destination since edges are treated as undirected.
            if (ctx.dstAttr.color == color) {
              val msg = ctx.attr.b * ctx.srcAttr.belief
              // Only send message if non-zero.
              if (msg != 0) ctx.sendToDst(msg)
            } else if (ctx.srcAttr.color == color) {
              val msg = ctx.attr.b * ctx.dstAttr.belief
              // Only send message if non-zero.
              if (msg != 0) ctx.sendToSrc(msg)
            },
          _ + _)
        // Receive messages, and update beliefs for vertices of the current color.
        gx = gx.outerJoinVertices(msgs) {
          case (vID, vAttr, optMsg) =&gt;
            if (vAttr.color == color) {
              val x = vAttr.a + optMsg.getOrElse(0.0)
              val newBelief = math.exp(-log1pExp(-x))
              VertexAttr(vAttr.a, newBelief, color)
            } else {
              vAttr
            }
        }
      }
    }

    // Convert back to GraphFrame with a new column &quot;belief&quot; for vertices DataFrame.
    val gxFinal: Graph[Double, Unit] = gx.mapVertices((_, attr) =&gt; attr.belief).mapEdges(_ =&gt; ())
    GraphFrame.fromGraphX(colorG, gxFinal, vertexNames = Seq(&quot;belief&quot;))
  }

  case class VertexAttr(a: Double, belief: Double, color: Int)

  case class EdgeAttr(b: Double)

  /**
   * Run Belief Propagation.
   *
   * This implementation of BP shows how to use GraphFrame&#39;s aggregateMessages method.
   *  - Color GraphFrame vertices for BP scheduling.
   *  - Run BP using GraphFrame&#39;s aggregateMessages API.
   *  - Augment the original GraphFrame with the BP results (vertex beliefs).
   *
   * @param g  Graphical model created by `org.graphframes.examples.Graphs.gridIsingModel()`
   * @param numIter  Number of iterations of BP to run.  One iteration includes updating each
   *                 vertex&#39;s belief once.
   * @return  Same graphical model, but with [[GraphFrame.vertices]] augmented with a new column
   *          &quot;belief&quot; containing P(x,,i,, = +1), the marginal probability of vertex i taking
   *          value +1 instead of -1.
   */
  def runBPwithGraphFrames(g: GraphFrame, numIter: Int): GraphFrame = {
    // Choose colors for vertices for BP scheduling.
    val colorG = colorGraph(g)
    val numColors: Int = colorG.vertices.select(&quot;color&quot;).distinct.count().toInt

    // TODO: Handle vertices without any edges.

    // Initialize vertex beliefs at 0.0.
    var gx = GraphFrame(colorG.vertices.withColumn(&quot;belief&quot;, lit(0.0)), colorG.edges)

    // Run BP for numIter iterations.
    for (iter &lt;- Range(0, numIter)) {
      // For each color, have that color receive messages from neighbors.
      for (color &lt;- Range(0, numColors)) {
        // Define &quot;AM&quot; for shorthand for referring to the src, dst, edge, and msg fields.
        // (See usage below.)
        val AM = AggregateMessages
        // Send messages to vertices of the current color.
        // We may send to source or destination since edges are treated as undirected.
        val msgForSrc: Column = when(AM.src(&quot;color&quot;) === color, AM.edge(&quot;b&quot;) * AM.dst(&quot;belief&quot;))
        val msgForDst: Column = when(AM.dst(&quot;color&quot;) === color, AM.edge(&quot;b&quot;) * AM.src(&quot;belief&quot;))
        val logistic = udf { (x: Double) =&gt; math.exp(-log1pExp(-x)) }
        val aggregates = gx.aggregateMessages
          .sendToSrc(msgForSrc)
          .sendToDst(msgForDst)
          .agg(sum(AM.msg).as(&quot;aggMess&quot;))
        val v = gx.vertices
        // Receive messages, and update beliefs for vertices of the current color.
        val newBeliefCol = when(v(&quot;color&quot;) === color &amp;&amp; aggregates(&quot;aggMess&quot;).isNotNull,
          logistic(aggregates(&quot;aggMess&quot;) + v(&quot;a&quot;)))
          .otherwise(v(&quot;belief&quot;))  // keep old beliefs for other colors
        val newVertices = v
          .join(aggregates, v(&quot;id&quot;) === aggregates(&quot;id&quot;), &quot;left_outer&quot;)  // join messages, vertices
          .drop(aggregates(&quot;id&quot;))  // drop duplicate ID column (from outer join)
          .withColumn(&quot;newBelief&quot;, newBeliefCol)  // compute new beliefs
          .drop(&quot;aggMess&quot;)  // drop messages
          .drop(&quot;belief&quot;)  // drop old beliefs
          .withColumnRenamed(&quot;newBelief&quot;, &quot;belief&quot;)
        // Cache new vertices using workaround for SPARK-13346
        val cachedNewVertices = AM.getCachedDataFrame(newVertices)
        gx = GraphFrame(cachedNewVertices, gx.edges)
      }
    }

    // Drop the &quot;color&quot; column from vertices
    GraphFrame(gx.vertices.drop(&quot;color&quot;), gx.edges)
  }

  /** More numerically stable `log(1 + exp(x))` */
  private def log1pExp(x: Double): Double = {
    if (x &gt; 0) {
      x + math.log1p(math.exp(-x))
    } else {
      math.log1p(math.exp(x))
    }
  }
}
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./000_0-sds-3-x-projects/student-project-14_group-NullHypothesisEvaluationCriteria"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By ScaDaMaLe Team<br/>
        
            &copy; Copyright 2020 Creative Commons Zero v1.0 Universal.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>