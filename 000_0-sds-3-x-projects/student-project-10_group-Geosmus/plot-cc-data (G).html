
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Python based plotting &#8212; Scalable Data Science &amp; Distributed Machine Learning</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Scalable Data Science & Distributed Machine Learning</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/000_ScaDaMaLe.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction to Apache Spark Core
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/001_whySpark.html">
   Why Apache Spark?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html">
   databricks community edition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#essentials-of-databricks-cloud-dbc-in-a-big-hurry">
   Essentials of Databricks Cloud (DBC) in a Big Hurry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-what-is-databricks-cloud">
   DBC Essentials: What is Databricks Cloud?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-shard-cluster-notebook-and-dashboard">
   DBC Essentials: Shard, Cluster, Notebook and Dashboard
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-team-state-collaboration-elastic-resources">
   DBC Essentials: Team, State, Collaboration, Elastic Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#you-should-all-have-databricks-community-edition-account-by-now">
   You Should All Have databricks community edition account by now!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#import-course-content-now">
   Import Course Content Now!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#cloud-free-computing-environment-optional-but-recommended">
   Cloud-free Computing Environment (Optional but recommended)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_01_multiLingualNotebooks.html">
   Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_01_multiLingualNotebooks.html#further-reference-homework-recurrrent-points-of-reference">
   Further Reference / Homework / Recurrrent Points of Reference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html">
   Introduction to Scala through Scala Notebook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-in-your-own-computer">
   Scala in your own computer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-resources">
   Scala Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#introduction-to-scala">
   Introduction to Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#let-s-get-our-hands-dirty-in-scala">
   Let’s get our hands dirty in Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-types">
   Scala Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#expressions">
   Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#blocks">
   Blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#functions">
   Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#methods">
   Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#classes">
   Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#case-classes">
   Case Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#objects">
   Objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#traits">
   Traits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#main-method">
   Main Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#what-i-try-not-do-while-learning-a-new-language">
   What I try not do while learning a new language?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html">
   Scala Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#let-s-continue-to-get-our-hands-dirty-in-scala">
   Let’s continue to get our hands dirty in Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#scala-type-hierarchy">
   Scala Type Hierarchy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#scala-collections">
   Scala Collections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#exercise-in-functional-programming">
   Exercise in Functional Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#lazy-evaluation">
   Lazy Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#recursions">
   Recursions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/004_RDDsTransformationsActions.html">
   Introduction to Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/004_RDDsTransformationsActions.html#spark-cluster-overview">
   Spark Cluster Overview:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/005_RDDsTransformationsActionsHOMEWORK.html">
   HOMEWORK notebook - RDDs Transformations and Actions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html">
   Piped RDDs and Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#from-a-local-collection">
   From a Local Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#glom">
   glom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#checkpointing">
   Checkpointing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#pipe-rdds-to-system-commands">
   Pipe RDDs to System Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#mappartitions">
   mapPartitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#foreachpartition">
   foreachPartition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#numerically-rigorous-bayesian-ab-testing">
   Numerically Rigorous Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#usage-instructions-for-isit1or2coins">
   Usage instructions for IsIt1or2Coins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006_WordCount.html">
   Word Count on US State of the Union (SoU) Addresses
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction to Apache Spark SQL
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html">
   Introduction to Spark SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#overview">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#datasets-and-dataframes">
   Datasets and DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#getting-started-in-spark-2-x">
   Getting Started in Spark 2.x
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007a_SparkSQLProgGuide_HW.html">
   Spark Sql Programming Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html#id1">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007c_SparkSQLProgGuide_HW.html">
   Getting Started - Exercise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html#id1">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007e_SparkSQLProgGuide_HW.html">
   Performance Tuning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html">
   Distributed SQL Engine
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html#id1">
   Distributed SQL Engine
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#sql-pivoting-since-spark-2-4">
   SQL Pivoting since Spark 2.4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#load-data">
   Load Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-in-sql">
   Pivoting in SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-aggregate-expressions">
   Pivoting with Multiple Aggregate Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-grouping-columns">
   Pivoting with Multiple Grouping Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-pivot-columns">
   Pivoting with Multiple Pivot Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html">
   Diamonds ML Pipeline Workflow - DataFrame ETL and EDA Part
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#step-1-load-data-as-dataframe">
   Step 1. Load data as DataFrame
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#step-2-understand-the-data">
   Step 2. Understand the data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#let-us-run-through-some-basic-inteactive-sql-queries-next">
   Let us run through some basic inteactive SQL queries next
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#why-do-we-need-to-know-these-interactive-sql-queries">
   Why do we need to know these interactive SQL queries?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#we-will-continue-later-with-ml-pipelines-to-do-prediction-with-a-fitted-model-from-this-dataset">
   We will continue later with ML pipelines to do prediction with a fitted model from this dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html">
   Power Plant ML Pipeline Application - DataFrame Part
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-1-business-understanding">
   Step 1: Business Understanding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-2-load-your-data">
   Step 2: Load Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#use-this-for-other-smallish-datasets-you-want-to-import-to-your-ce">
   USE THIS FOR OTHER SMALLish DataSets you want to import to your CE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-3-explore-your-data">
   Step 3: Explore Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-4-visualize-your-data">
   Step 4: Visualize Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html">
   Wiki Clickstream Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html#wikipedia-logo">
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_LoadExtract.html">
   Old Bailey Online Data Analysis in Apache Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_LoadExtract.html#analysing-the-full-old-bailey-online-sessions-papers-dataset">
   Analysing the Full Old Bailey Online Sessions Papers Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html">
   Piped RDDs and Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#from-a-local-collection">
   From a Local Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#glom">
   glom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#checkpointing">
   Checkpointing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#pipe-rdds-to-system-commands">
   Pipe RDDs to System Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#mappartitions">
   mapPartitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#foreachpartition">
   foreachPartition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#numerically-rigorous-bayesian-ab-testing">
   Numerically Rigorous Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#usage-instructions-for-isit1or2coins">
   Usage instructions for IsIt1or2Coins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#parsing-the-output-from-isit1or2coins">
   Parsing the output from
   <code class="docutils literal notranslate">
    <span class="pre">
     IsIt1or2Coins
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#providing-case-classes-for-input-and-output-for-easy-spark-communication">
   Providing case classes for input and output for easy spark communication
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/035_LDA_CornellMovieDialogs.html">
   Topic Modeling of Movie Dialogs with Latent Dirichlet Allocation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Distribute Deep Learning with Horovod
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_7-sds-3-x-ddl/00_DDL_Introduction.html">
   Introduction to Distributed Deep Learning (DDL) with Horovod over Tensorflow/keras and Pytorch
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_7-sds-3-x-ddl/0x_mnist-tensorflow-keras.html">
   Distributed deep learning training using TensorFlow and Keras with HorovodRunner
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_7-sds-3-x-ddl/0y_mnist-pytorch.html">
   Distributed deep learning training using PyTorch with HorovodRunner for MNIST
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  WASP AI-Track Student Projects
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/035_LDA_CornellMovieDialogs.html">
   Topic Modeling of Movie Dialogs with Latent Dirichlet Allocation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Voluntary Student Projects
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/030_Spark_GDELT_project.html">
   Plugging into GDELT Streams - TODO - IN PROGRESS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/030_Spark_GDELT_project.html#this-is-just-dipping-our-pinky-toe-in-this-ocean-of-information">
   This is just dipping our pinky toe in this ocean of information!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/030_Spark_GDELT_project.html#download-from-gdelt-project">
   Download from gdelt-project
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/000_0-sds-3-x-projects/student-project-10_group-Geosmus/plot-cc-data (G).ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://lamastex.github.io/ScaDaMaLe/index.html"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://lamastex.github.io/ScaDaMaLe/index.html/issues/new?title=Issue%20on%20page%20%2F000_0-sds-3-x-projects/student-project-10_group-Geosmus/plot-cc-data (G).html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Python based plotting
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#python-dependencies">
     Python Dependencies:
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#installing-dependencies">
       Installing dependencies
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#defining-some-functions">
     Defining some functions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#initial-processing-of-dataframe">
       Initial processing of dataframe
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#group-by-country-code">
       Group by country code
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-results">
   Plotting results
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#choropleth-map">
     Choropleth map
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cartogram">
     Cartogram
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#animating-the-time-evolution-of-tweets">
   Animating the time evolution of tweets.
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#time-of-day-cartogram-dec-23-to-jan-1rst">
   Time of day cartogram: Dec 23 to Jan 1rst
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#time-of-day-cartogram-dec-31">
   Time of day cartogram: Dec 31
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#save-reduced-df-for-use-in-r">
     Save reduced df for use in r
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#r-based-plotting">
   R based plotting
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Installing dependencies
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loading-data">
     Loading data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#todo-z-axis">
     TODO: z-axis
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#alternative-r-approach">
   Alternative R approach
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="python-based-plotting">
<h1>Python based plotting<a class="headerlink" href="#python-based-plotting" title="Permalink to this headline">¶</a></h1>
<div class="section" id="python-dependencies">
<h2>Python Dependencies:<a class="headerlink" href="#python-dependencies" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>We can install python libraries temporarily in a single notebook
session using the “%pip install” magic command</p></li>
</ul>
<div class="section" id="installing-dependencies">
<h3>Installing dependencies<a class="headerlink" href="#installing-dependencies" title="Permalink to this headline">¶</a></h3>
<p>The following cells should be uncommented and run if the cluster has
been restarted.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="o">-</span><span class="n">y</span> <span class="n">install</span> <span class="n">libproj</span><span class="o">-</span><span class="n">dev</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="o">-</span><span class="n">y</span> <span class="n">install</span> <span class="n">libgeos</span><span class="o">++-</span><span class="n">dev</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Reading package lists...
Building dependency tree...
Reading state information...
libproj-dev is already the newest version (4.9.3-2).
The following packages were automatically installed and are no longer required:
  libcap2-bin libpam-cap zulu-repo
Use &#39;sudo apt autoremove&#39; to remove them.
0 upgraded, 0 newly installed, 0 to remove and 18 not upgraded.
Reading package lists...
Building dependency tree...
Reading state information...
libgeos++-dev is already the newest version (3.6.2-1build2).
The following packages were automatically installed and are no longer required:
  libcap2-bin libpam-cap zulu-repo
Use &#39;sudo apt autoremove&#39; to remove them.
0 upgraded, 0 newly installed, 0 to remove and 18 not upgraded.
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">pip</span> <span class="n">install</span> <span class="n">plotly</span>
<span class="o">%</span><span class="n">pip</span> <span class="n">install</span> <span class="n">pycountry</span>
<span class="o">%</span><span class="n">pip</span> <span class="n">install</span> <span class="n">geopandas</span>
<span class="o">%</span><span class="n">pip</span> <span class="n">install</span> <span class="n">geoplot</span>
<span class="o">%</span><span class="n">pip</span> <span class="n">install</span> <span class="n">imageio</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Python interpreter will be restarted.
Requirement already satisfied: plotly in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (4.14.1)
Requirement already satisfied: six in /databricks/python3/lib/python3.7/site-packages (from plotly) (1.14.0)
Requirement already satisfied: retrying&gt;=1.3.3 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from plotly) (1.3.3)
Python interpreter will be restarted.
Python interpreter will be restarted.
Requirement already satisfied: pycountry in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (20.7.3)
Python interpreter will be restarted.
Python interpreter will be restarted.
Requirement already satisfied: geopandas in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (0.8.1)
Requirement already satisfied: pandas&gt;=0.23.0 in /databricks/python3/lib/python3.7/site-packages (from geopandas) (1.0.1)
Requirement already satisfied: pyproj&gt;=2.2.0 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from geopandas) (3.0.0.post1)
Requirement already satisfied: fiona in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from geopandas) (1.8.18)
Requirement already satisfied: shapely in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from geopandas) (1.7.1)
Requirement already satisfied: python-dateutil&gt;=2.6.1 in /databricks/python3/lib/python3.7/site-packages (from pandas&gt;=0.23.0-&gt;geopandas) (2.8.1)
Requirement already satisfied: numpy&gt;=1.13.3 in /databricks/python3/lib/python3.7/site-packages (from pandas&gt;=0.23.0-&gt;geopandas) (1.18.1)
Requirement already satisfied: pytz&gt;=2017.2 in /databricks/python3/lib/python3.7/site-packages (from pandas&gt;=0.23.0-&gt;geopandas) (2019.3)
Requirement already satisfied: certifi in /databricks/python3/lib/python3.7/site-packages (from pyproj&gt;=2.2.0-&gt;geopandas) (2020.6.20)
Requirement already satisfied: six&gt;=1.5 in /databricks/python3/lib/python3.7/site-packages (from python-dateutil&gt;=2.6.1-&gt;pandas&gt;=0.23.0-&gt;geopandas) (1.14.0)
Requirement already satisfied: munch in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from fiona-&gt;geopandas) (2.5.0)
Requirement already satisfied: click-plugins&gt;=1.0 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from fiona-&gt;geopandas) (1.1.1)
Requirement already satisfied: attrs&gt;=17 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from fiona-&gt;geopandas) (20.3.0)
Requirement already satisfied: cligj&gt;=0.5 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from fiona-&gt;geopandas) (0.7.1)
Requirement already satisfied: click&lt;8,&gt;=4.0 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from fiona-&gt;geopandas) (7.1.2)
Python interpreter will be restarted.
Python interpreter will be restarted.
Requirement already satisfied: geoplot in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (0.4.1)
Requirement already satisfied: seaborn in /databricks/python3/lib/python3.7/site-packages (from geoplot) (0.10.0)
Requirement already satisfied: matplotlib in /databricks/python3/lib/python3.7/site-packages (from geoplot) (3.1.3)
Requirement already satisfied: mapclassify&gt;=2.1 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from geoplot) (2.4.2)
Requirement already satisfied: contextily&gt;=1.0.0 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from geoplot) (1.0.1)
Requirement already satisfied: cartopy in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from geoplot) (0.18.0)
Requirement already satisfied: pandas in /databricks/python3/lib/python3.7/site-packages (from geoplot) (1.0.1)
Requirement already satisfied: geopandas in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from geoplot) (0.8.1)
Requirement already satisfied: descartes in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from geoplot) (1.1.0)
Requirement already satisfied: mercantile in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from contextily&gt;=1.0.0-&gt;geoplot) (1.1.6)
Requirement already satisfied: pillow in /databricks/python3/lib/python3.7/site-packages (from contextily&gt;=1.0.0-&gt;geoplot) (7.2.0)
Requirement already satisfied: geopy in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from contextily&gt;=1.0.0-&gt;geoplot) (2.1.0)
Requirement already satisfied: joblib in /databricks/python3/lib/python3.7/site-packages (from contextily&gt;=1.0.0-&gt;geoplot) (0.14.1)
Requirement already satisfied: rasterio in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from contextily&gt;=1.0.0-&gt;geoplot) (1.1.8)
Requirement already satisfied: requests in /databricks/python3/lib/python3.7/site-packages (from contextily&gt;=1.0.0-&gt;geoplot) (2.22.0)
Requirement already satisfied: scipy&gt;=1.0 in /databricks/python3/lib/python3.7/site-packages (from mapclassify&gt;=2.1-&gt;geoplot) (1.4.1)
Requirement already satisfied: numpy&gt;=1.3 in /databricks/python3/lib/python3.7/site-packages (from mapclassify&gt;=2.1-&gt;geoplot) (1.18.1)
Requirement already satisfied: scikit-learn in /databricks/python3/lib/python3.7/site-packages (from mapclassify&gt;=2.1-&gt;geoplot) (0.22.1)
Requirement already satisfied: networkx in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from mapclassify&gt;=2.1-&gt;geoplot) (2.5)
Requirement already satisfied: python-dateutil&gt;=2.6.1 in /databricks/python3/lib/python3.7/site-packages (from pandas-&gt;geoplot) (2.8.1)
Requirement already satisfied: pytz&gt;=2017.2 in /databricks/python3/lib/python3.7/site-packages (from pandas-&gt;geoplot) (2019.3)
Requirement already satisfied: six&gt;=1.5 in /databricks/python3/lib/python3.7/site-packages (from python-dateutil&gt;=2.6.1-&gt;pandas-&gt;geoplot) (1.14.0)
Requirement already satisfied: pyshp&gt;=1.1.4 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from cartopy-&gt;geoplot) (2.1.2)
Requirement already satisfied: setuptools&gt;=0.7.2 in /usr/local/lib/python3.7/dist-packages (from cartopy-&gt;geoplot) (45.2.0)
Requirement already satisfied: shapely&gt;=1.5.6 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from cartopy-&gt;geoplot) (1.7.1)
Requirement already satisfied: pyproj&gt;=2.2.0 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from geopandas-&gt;geoplot) (3.0.0.post1)
Requirement already satisfied: fiona in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from geopandas-&gt;geoplot) (1.8.18)
Requirement already satisfied: certifi in /databricks/python3/lib/python3.7/site-packages (from pyproj&gt;=2.2.0-&gt;geopandas-&gt;geoplot) (2020.6.20)
Requirement already satisfied: munch in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from fiona-&gt;geopandas-&gt;geoplot) (2.5.0)
Requirement already satisfied: click-plugins&gt;=1.0 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from fiona-&gt;geopandas-&gt;geoplot) (1.1.1)
Requirement already satisfied: attrs&gt;=17 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from fiona-&gt;geopandas-&gt;geoplot) (20.3.0)
Requirement already satisfied: cligj&gt;=0.5 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from fiona-&gt;geopandas-&gt;geoplot) (0.7.1)
Requirement already satisfied: click&lt;8,&gt;=4.0 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from fiona-&gt;geopandas-&gt;geoplot) (7.1.2)
Requirement already satisfied: geographiclib&lt;2,&gt;=1.49 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from geopy-&gt;contextily&gt;=1.0.0-&gt;geoplot) (1.50)
Requirement already satisfied: cycler&gt;=0.10 in /databricks/python3/lib/python3.7/site-packages (from matplotlib-&gt;geoplot) (0.10.0)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /databricks/python3/lib/python3.7/site-packages (from matplotlib-&gt;geoplot) (2.4.6)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /databricks/python3/lib/python3.7/site-packages (from matplotlib-&gt;geoplot) (1.1.0)
Requirement already satisfied: decorator&gt;=4.3.0 in /databricks/python3/lib/python3.7/site-packages (from networkx-&gt;mapclassify&gt;=2.1-&gt;geoplot) (4.4.1)
Requirement already satisfied: affine in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from rasterio-&gt;contextily&gt;=1.0.0-&gt;geoplot) (2.3.0)
Requirement already satisfied: snuggs&gt;=1.4.1 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (from rasterio-&gt;contextily&gt;=1.0.0-&gt;geoplot) (1.4.7)
Requirement already satisfied: idna&lt;2.9,&gt;=2.5 in /databricks/python3/lib/python3.7/site-packages (from requests-&gt;contextily&gt;=1.0.0-&gt;geoplot) (2.8)
Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&lt;1.26,&gt;=1.21.1 in /databricks/python3/lib/python3.7/site-packages (from requests-&gt;contextily&gt;=1.0.0-&gt;geoplot) (1.25.8)
Requirement already satisfied: chardet&lt;3.1.0,&gt;=3.0.2 in /usr/lib/python3/dist-packages (from requests-&gt;contextily&gt;=1.0.0-&gt;geoplot) (3.0.4)
Python interpreter will be restarted.
Python interpreter will be restarted.
Requirement already satisfied: imageio in /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages (2.9.0)
Requirement already satisfied: numpy in /databricks/python3/lib/python3.7/site-packages (from imageio) (1.18.1)
Requirement already satisfied: pillow in /databricks/python3/lib/python3.7/site-packages (from imageio) (7.2.0)
Python interpreter will be restarted.
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mthh</span><span class="o">/</span><span class="n">cartogram_geopandas</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">cartogram_geopandas</span><span class="o">/</span>
<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>fatal: destination path &#39;cartogram_geopandas&#39; already exists and is not an empty directory.
running install
running build
running build_py
running build_ext
running install_lib
running install_egg_info
Removing /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas-0.0.0c.egg-info
Writing /local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas-0.0.0c.egg-info
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="defining-some-functions">
<h2>Defining some functions<a class="headerlink" href="#defining-some-functions" title="Permalink to this headline">¶</a></h2>
<p>We will process the collected data a bit before making any plots. *
<strong>load<em>twitter</em>geo*data(path)</strong> * <strong>country<em>code</em>grouping(df)</strong> *
<strong>add<em>iso</em>a3<em>col(df</em>cc)</strong> Takes the df generated by
load<em>twitter</em>geo<em>data() and maps the two letter country code to the
three letter ISO</em>a3 format. * <strong>create<em>geo</em>df(df*cc)</strong> Takes the df
generated by add<em>iso</em>a3_col() and merges it with a geopandas dataframe,
which contains shape information of the worlds countries. *
<strong>animate<em>cartogram(df, filterKey, filterList, out</em>path)</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;./tweet_carto_functions&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="initial-processing-of-dataframe">
<h3>Initial processing of dataframe<a class="headerlink" href="#initial-processing-of-dataframe" title="Permalink to this headline">¶</a></h3>
<p>This step only needs to be run if you want to overwrite the existing
preprocessed dataframea “processedDF.csv”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># path = &quot;/datasets/ScaDaMaLe/twitter/student-project-10_group-Geosmus/*/*/*/*/*/*&quot;</span>
<span class="c1"># df = load_twitter_geo_data(path)</span>
<span class="c1"># # df = df[df[&#39;day&#39;] != 22].reset_index() #Data collection was continuous during the 22nd December whereas for the remaining days we only streamed for 3 minutes per hour.</span>
<span class="c1"># df = df[(df[&#39;day&#39;] != 22) &amp; (df[&#39;day&#39;] != 2 )].reset_index() #Data collection was continuous during the 22nd December whereas for the remaining days we only streamed for 3 minutes per hour. Data collection ended in the middle of Jan second so to only have full day we disregard Jan 2.</span>
<span class="n">pre_proc_path</span> <span class="o">=</span> <span class="s2">&quot;/dbfs/datasets/ScaDaMaLe/twitter/student-project-10_group-Geosmus/tmp/processedDF.csv&quot;</span>
<span class="c1"># df.to_csv(pre_proc_path)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="group-by-country-code">
<h3>Group by country code<a class="headerlink" href="#group-by-country-code" title="Permalink to this headline">¶</a></h3>
<p>Next we group the tweets by country code and display the dataframe.
Having the country code as the first column allows us to select the map
option in the display drop-down menu.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">pre_proc_path</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>Truncated to 30 rows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Group by country code</span>
<span class="n">df_cc</span> <span class="o">=</span> <span class="n">country_code_grouping</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df_cc</span> <span class="o">=</span> <span class="n">add_iso_a3_col</span><span class="p">(</span><span class="n">df_cc</span><span class="p">)</span>
<span class="n">df_cc</span> <span class="o">=</span> <span class="n">df_cc</span><span class="p">[[</span><span class="s2">&quot;iso_a3&quot;</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">]]</span> <span class="c1">#reorder to have iso_a3 as first column (required in order to use the map view in display). Also we don&#39;t need countryCode and index columns.</span>

<span class="c1"># Inspect result</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_cc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>Truncated to 30 rows</p>
<p>Right now we are dealing with a regular dataframe. But we would like to
generate cartograms (more on cartograms in a bit), and to generate
cartograms we need the shapes of the countries. We get the shapes via
the function create<em>geo</em>df(), which in turn relies on the geopandas
library. When calling display on a geopandas dataframe we just get the
raw table, and none of the premade visualizations we get when displaying
pandas dataframes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the geopandas dataframe</span>
<span class="n">df_world</span> <span class="o">=</span> <span class="n">create_geo_df</span><span class="p">(</span><span class="n">df_cc</span><span class="p">)</span>

<span class="c1"># Inspect result</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_world</span><span class="p">)</span>

<span class="c1"># if you want to work with this file localy you need to do the following:</span>
<span class="c1"># Save to filestore: df_world.to_csv(&quot;/dbfs/FileStore/group10/world_tweet.csv&quot;)</span>
<span class="c1"># Download to local by pasting the following into your browser: https://dbc-635ca498-e5f1.cloud.databricks.com/files/group10/world_tweet.csv?o=445287446643905 </span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="plotting-results">
<h1>Plotting results<a class="headerlink" href="#plotting-results" title="Permalink to this headline">¶</a></h1>
<div class="section" id="choropleth-map">
<h2>Choropleth map<a class="headerlink" href="#choropleth-map" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="cartogram">
<h2>Cartogram<a class="headerlink" href="#cartogram" title="Permalink to this headline">¶</a></h2>
<p>A cartogram is a way to represent geograpic differences in some
variable, by altering the size of regions. The areas and shapes of
regions are distorted in order to create an approximately equal density
of the selected variable across all regions. In our case there are a lot
of tweets coming from brazil and the US so these regions grow resulting
in lower tweet density.</p>
<p>The available python cartogram package cartogram_geopandas is based on
Dougenik, J. A, N. R. Chrisman, and D. R. Niemeyer: 1985. “An algorithm
to construct continuous cartograms”. It is very sparselu documented and
does not report error scores and tends to diverge if allowed to run for
too many iterations.</p>
<p>We found the Gui program Scapetoad to offer superior performance.
Scapetoad is based on Mark Newman’s C-code “Cart”, which is based on his
and Michael T. Gastner’s paper “Diffusion-based method for
producingdensity-equalizing maps” from 2004. Scapetoad is working on a
Python API, but it has not been released yet.</p>
<p>Inspite of its shortcomings we will be using cartogram_geopandas, since
Scapetoad can not be called from a notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">pre_proc_path</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;(day==31) and (hour==23)&quot;</span><span class="p">)</span>
<span class="c1"># Group by country code</span>
<span class="n">df_cc</span> <span class="o">=</span> <span class="n">country_code_grouping</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df_cc</span> <span class="o">=</span> <span class="n">add_iso_a3_col</span><span class="p">(</span><span class="n">df_cc</span><span class="p">)</span>
<span class="n">df_cc</span> <span class="o">=</span> <span class="n">df_cc</span><span class="p">[[</span><span class="s2">&quot;iso_a3&quot;</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">]]</span> <span class="c1">#reorder to have iso_a3 as first column (required in order to use the map view in display). Also we don&#39;t need countryCode and index columns.</span>
<span class="c1"># Create the geopandas dataframe</span>
<span class="n">df_world</span> <span class="o">=</span> <span class="n">create_geo_df</span><span class="p">(</span><span class="n">df_cc</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>

<span class="c1"># Make a choropleth plot</span>
<span class="n">df_world</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;numTweets&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># The make_cartogram function can not handle a tweetcount of zero, so a not so elegant solution is to clip the tweet count at 1.</span>
<span class="c1"># The alternative (to remove countries without tweets) is not elegant either, and causes problems when we look at the time evolution, since countries will be popping in and out of existence.</span>
<span class="n">df_world</span><span class="p">[</span><span class="s2">&quot;numTweets&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_world</span><span class="p">[</span><span class="s2">&quot;numTweets&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">df_world2</span><span class="p">[</span><span class="s2">&quot;numTweets&quot;</span><span class="p">]))</span> 

<span class="n">df_cartogram</span> <span class="o">=</span> <span class="n">make_cartogram</span><span class="p">(</span><span class="n">df_world</span><span class="p">,</span> <span class="s1">&#39;numTweets&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df_cartogram</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;numTweets&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> 


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="animating-the-time-evolution-of-tweets">
<h1>Animating the time evolution of tweets.<a class="headerlink" href="#animating-the-time-evolution-of-tweets" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Generate maps for different time intervals and save them as pngs</p></li>
<li><p>Use the pngs to generate a gif</p></li>
</ul>
</div>
<div class="section" id="time-of-day-cartogram-dec-23-to-jan-1rst">
<h1>Time of day cartogram: Dec 23 to Jan 1rst<a class="headerlink" href="#time-of-day-cartogram-dec-23-to-jan-1rst" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pre_proc_path</span> <span class="o">=</span> <span class="s2">&quot;/dbfs/datasets/ScaDaMaLe/twitter/student-project-10_group-Geosmus/tmp/processedDF.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">pre_proc_path</span><span class="p">)</span>
<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;hour&quot;</span>
<span class="n">timeOfDayList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">))</span>
<span class="n">out_path</span> <span class="o">=</span> <span class="s2">&quot;/dbfs/FileStore/group10/cartogram&quot;</span>
<span class="n">nIter</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">cartogram_key</span> <span class="o">=</span> <span class="s2">&quot;numTweets&quot;</span>

<span class="n">animate_cartogram</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">timeOfDayList</span><span class="p">,</span> <span class="n">out_path</span><span class="p">,</span> <span class="n">nIter</span><span class="p">,</span> <span class="n">cartogram_key</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">displayHTML</span><span class="p">(</span><span class="s2">&quot;&lt;img src=&#39;/files/group10/cartogram.gif&#39;&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="time-of-day-cartogram-dec-31">
<h1>Time of day cartogram: Dec 31<a class="headerlink" href="#time-of-day-cartogram-dec-31" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pre_proc_path</span> <span class="o">=</span> <span class="s2">&quot;/dbfs/datasets/ScaDaMaLe/twitter/student-project-10_group-Geosmus/tmp/processedDF.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">pre_proc_path</span><span class="p">)</span>
<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;hour&quot;</span>
<span class="n">timeOfDayList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">))</span>
<span class="n">out_path</span> <span class="o">=</span> <span class="s2">&quot;/dbfs/FileStore/group10/cartogram_31rst_Dec&quot;</span>
<span class="n">nIter</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">cartogram_key</span> <span class="o">=</span> <span class="s2">&quot;numTweets&quot;</span>

<span class="n">animate_cartogram</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;day==31&quot;</span><span class="p">),</span> <span class="n">key</span><span class="p">,</span> <span class="n">timeOfDayList</span><span class="p">,</span> <span class="n">out_path</span><span class="p">,</span> <span class="n">nIter</span><span class="p">,</span> <span class="n">cartogram_key</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">displayHTML</span><span class="p">(</span><span class="s2">&quot;&lt;img src=&#39;/files/group10/cartogram_31rst_Dec.gif&#39;&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/datasets/ScaDaMaLe/twitter/student-project-10_group-Geosmus/processedEmoticonClusterParquets/emoticonCluster.parquet&quot;</span>
<span class="n">cluster_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;happy&quot;</span><span class="p">,</span> <span class="s2">&quot;notHappy&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;monkey&quot;</span><span class="p">,</span> <span class="s2">&quot;SK&quot;</span><span class="p">,</span> <span class="s2">&quot;prayer&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">cluster_name</span> <span class="ow">in</span> <span class="n">cluster_names</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">cluster_name</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">load_twitter_geo_data</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">load_twitter_geo_data_with_filter</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cluster_name</span><span class="p">)</span>
    
  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">22</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> <span class="c1">#Data collection was continuous during the 22nd December whereas for the remaining days we only streamed for 3 minutes per hour.</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">22</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span> <span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> <span class="c1">#Data collection was continuous during the 22nd December whereas for the remaining days we only streamed for 3 minutes per hour. Data collection ended in the middle of Jan second so to only have full day we disregard Jan 2.</span>
  
  <span class="c1"># add column in order to be able to display ratio of total tweets</span>
  <span class="n">df</span><span class="p">[</span><span class="s1">&#39;numTweets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;countryCode&#39;</span><span class="p">)[</span><span class="s1">&#39;countryCode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
  <span class="n">df</span><span class="p">[</span><span class="s2">&quot;proportion&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;numTweets&quot;</span><span class="p">]</span>
  
  <span class="c1"># filter out countries with very few tweets</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">numTweets</span> <span class="o">&gt;=</span> <span class="mi">100</span><span class="p">]</span>
  <span class="c1"># create cartogram</span>
  <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;hour&quot;</span>
  <span class="n">timeOfDayList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">))</span>
  <span class="n">out_path</span> <span class="o">=</span> <span class="s2">&quot;/dbfs/FileStore/group10/cartogram_&quot;</span> <span class="o">+</span> <span class="n">cluster_name</span>
  <span class="n">nIter</span> <span class="o">=</span> <span class="mi">30</span>
  <span class="n">cartogram_key</span> <span class="o">=</span> <span class="s2">&quot;proportion&quot;</span>

  <span class="n">animate_cartogram_extra</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;countryCode&quot;</span><span class="p">,</span> <span class="s2">&quot;proportion&quot;</span><span class="p">,</span> <span class="s2">&quot;hour&quot;</span><span class="p">]],</span> <span class="n">key</span><span class="p">,</span> <span class="n">timeOfDayList</span><span class="p">,</span> <span class="n">out_path</span><span class="p">,</span> <span class="n">nIter</span><span class="p">,</span> <span class="n">cartogram_key</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

*** WARNING: skipped 92694 bytes of output ***

/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
/local_disk0/tmp/1609918752459-0/PythonShell.py:57: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  
/local_disk0/tmp/1609918752459-0/PythonShell.py:60: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  from pyspark.context import SparkContext
/local_disk0/.ephemeral_nfs/envs/pythonEnv-6cd44a10-d65e-40e5-a7c4-a8b5593cd4fa/lib/python3.7/site-packages/cartogram_geopandas.py:48: UserWarning: Geometry is in a geographic CRS. Results from &#39;area&#39; are likely incorrect. Use &#39;GeoSeries.to_crs()&#39; to re-project geometries to a projected CRS before this operation.

  return crtgm.make()
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">html_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  &lt;figure&gt;</span>
<span class="s2">  &lt;img src=&quot;/files/group10/cartogram_</span><span class="si">{</span><span class="n">cluster_name</span><span class="si">}</span><span class="s2">.gif&quot; style=&quot;width:60%&quot;&gt;</span>
<span class="s2">  &lt;figcaption&gt;The &quot;</span><span class="si">{</span><span class="n">cluster_name</span><span class="si">}</span><span class="s2">&quot; cluster. Each country is scaled by what proportion of its total cluster emojis is tweeted in a given hour - </span>
<span class="s2">  if a country appears three times as big as usual then all of its tweets in this cluster are tweeted at the given hour </span>
<span class="s2">  and if it appears at normal size then none of its tweets in this cluster are tweeted at the given hour.</span>
<span class="s2">  Countries that are at (almost) constant size throughout have less than 100 tweets in this cluster.&lt;/figcaption&gt;</span>
<span class="s2">  &lt;/figure&gt;</span>
<span class="s2">  &lt;hr style=&quot;height:3px;border:none;color:#333;background-color:#333;&quot; /&gt;</span>
<span class="s2">  &quot;&quot;&quot;</span> <span class="k">for</span> <span class="n">cluster_name</span> <span class="ow">in</span> <span class="n">cluster_names</span><span class="p">])</span>
  
<span class="n">displayHTML</span><span class="p">(</span><span class="n">html_str</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;./tweet_carto_functions&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="o">/</span><span class="n">dbfs</span><span class="o">/</span><span class="n">FileStore</span><span class="o">/</span><span class="n">group10</span><span class="o">/</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cartogram.gif
cartogram0.png
cartogram1.png
cartogram10.png
cartogram11.png
cartogram12.png
cartogram13.png
cartogram14.png
cartogram15.png
cartogram16.png
cartogram17.png
cartogram18.png
cartogram19.png
cartogram2.png
cartogram20.png
cartogram21.png
cartogram22.png
cartogram23.png
cartogram24.png
cartogram25.png
cartogram26.png
cartogram27.png
cartogram28.png
cartogram29.png
cartogram3.png
cartogram30.png
cartogram31.png
cartogram4.png
cartogram5.png
cartogram6.png
cartogram7.png
cartogram8.png
cartogram9.png
cartogram_2020_Dec_23.gif
cartogram_2020_Dec_230.png
cartogram_2020_Dec_231.png
cartogram_2020_Dec_232.png
cartogram_2020_Dec_23_hour_.gif
cartogram_2020_Dec_23_hour_0.png
cartogram_2020_Dec_23_hour_1.png
cartogram_2020_Dec_23_hour_10.png
cartogram_2020_Dec_23_hour_11.png
cartogram_2020_Dec_23_hour_12.png
cartogram_2020_Dec_23_hour_13.png
cartogram_2020_Dec_23_hour_14.png
cartogram_2020_Dec_23_hour_15.png
cartogram_2020_Dec_23_hour_16.png
cartogram_2020_Dec_23_hour_17.png
cartogram_2020_Dec_23_hour_18.png
cartogram_2020_Dec_23_hour_19.png
cartogram_2020_Dec_23_hour_2.png
cartogram_2020_Dec_23_hour_20.png
cartogram_2020_Dec_23_hour_21.png
cartogram_2020_Dec_23_hour_22.png
cartogram_2020_Dec_23_hour_23.png
cartogram_2020_Dec_23_hour_3.png
cartogram_2020_Dec_23_hour_4.png
cartogram_2020_Dec_23_hour_5.png
cartogram_2020_Dec_23_hour_6.png
cartogram_2020_Dec_23_hour_7.png
cartogram_2020_Dec_23_hour_8.png
cartogram_2020_Dec_23_hour_9.png
cartogram_2020_Dec_24.gif
cartogram_2020_Dec_240.png
cartogram_2020_Dec_241.png
cartogram_2020_Dec_242.png
cartogram_2020_Dec_24_hour_.gif
cartogram_2020_Dec_24_hour_0.png
cartogram_2020_Dec_24_hour_1.png
cartogram_2020_Dec_24_hour_10.png
cartogram_2020_Dec_24_hour_11.png
cartogram_2020_Dec_24_hour_12.png
cartogram_2020_Dec_24_hour_13.png
cartogram_2020_Dec_24_hour_14.png
cartogram_2020_Dec_24_hour_15.png
cartogram_2020_Dec_24_hour_16.png
cartogram_2020_Dec_24_hour_17.png
cartogram_2020_Dec_24_hour_18.png
cartogram_2020_Dec_24_hour_19.png
cartogram_2020_Dec_24_hour_2.png
cartogram_2020_Dec_24_hour_20.png
cartogram_2020_Dec_24_hour_21.png
cartogram_2020_Dec_24_hour_22.png
cartogram_2020_Dec_24_hour_23.png
cartogram_2020_Dec_24_hour_3.png
cartogram_2020_Dec_24_hour_4.png
cartogram_2020_Dec_24_hour_5.png
cartogram_2020_Dec_24_hour_6.png
cartogram_2020_Dec_24_hour_7.png
cartogram_2020_Dec_24_hour_8.png
cartogram_2020_Dec_24_hour_9.png
cartogram_2020_Dec_25.gif
cartogram_2020_Dec_250.png
cartogram_2020_Dec_251.png
cartogram_2020_Dec_252.png
cartogram_2020_Dec_25_hour_.gif
cartogram_2020_Dec_25_hour_0.png
cartogram_2020_Dec_25_hour_1.png
cartogram_2020_Dec_25_hour_10.png
cartogram_2020_Dec_25_hour_11.png
cartogram_2020_Dec_25_hour_12.png
cartogram_2020_Dec_25_hour_13.png
cartogram_2020_Dec_25_hour_14.png
cartogram_2020_Dec_25_hour_15.png
cartogram_2020_Dec_25_hour_16.png
cartogram_2020_Dec_25_hour_17.png
cartogram_2020_Dec_25_hour_18.png
cartogram_2020_Dec_25_hour_19.png
cartogram_2020_Dec_25_hour_2.png
cartogram_2020_Dec_25_hour_20.png
cartogram_2020_Dec_25_hour_21.png
cartogram_2020_Dec_25_hour_22.png
cartogram_2020_Dec_25_hour_23.png
cartogram_2020_Dec_25_hour_3.png
cartogram_2020_Dec_25_hour_4.png
cartogram_2020_Dec_25_hour_5.png
cartogram_2020_Dec_25_hour_6.png
cartogram_2020_Dec_25_hour_7.png
cartogram_2020_Dec_25_hour_8.png
cartogram_2020_Dec_25_hour_9.png
cartogram_2020_Dec_26.gif
cartogram_2020_Dec_260.png
cartogram_2020_Dec_261.png
cartogram_2020_Dec_262.png
cartogram_2020_Dec_26_hour_.gif
cartogram_2020_Dec_26_hour_0.png
cartogram_2020_Dec_26_hour_1.png
cartogram_2020_Dec_26_hour_10.png
cartogram_2020_Dec_26_hour_11.png
cartogram_2020_Dec_26_hour_12.png
cartogram_2020_Dec_26_hour_13.png
cartogram_2020_Dec_26_hour_14.png
cartogram_2020_Dec_26_hour_15.png
cartogram_2020_Dec_26_hour_16.png
cartogram_2020_Dec_26_hour_17.png
cartogram_2020_Dec_26_hour_18.png
cartogram_2020_Dec_26_hour_19.png
cartogram_2020_Dec_26_hour_2.png
cartogram_2020_Dec_26_hour_20.png
cartogram_2020_Dec_26_hour_21.png
cartogram_2020_Dec_26_hour_22.png
cartogram_2020_Dec_26_hour_23.png
cartogram_2020_Dec_26_hour_3.png
cartogram_2020_Dec_26_hour_4.png
cartogram_2020_Dec_26_hour_5.png
cartogram_2020_Dec_26_hour_6.png
cartogram_2020_Dec_26_hour_7.png
cartogram_2020_Dec_26_hour_8.png
cartogram_2020_Dec_26_hour_9.png
cartogram_2020_Dec_27.gif
cartogram_2020_Dec_270.png
cartogram_2020_Dec_271.png
cartogram_2020_Dec_272.png
cartogram_2020_Dec_27_hour_.gif
cartogram_2020_Dec_27_hour_0.png
cartogram_2020_Dec_27_hour_1.png
cartogram_2020_Dec_27_hour_10.png
cartogram_2020_Dec_27_hour_11.png
cartogram_2020_Dec_27_hour_12.png
cartogram_2020_Dec_27_hour_13.png
cartogram_2020_Dec_27_hour_14.png
cartogram_2020_Dec_27_hour_15.png
cartogram_2020_Dec_27_hour_16.png
cartogram_2020_Dec_27_hour_17.png
cartogram_2020_Dec_27_hour_18.png
cartogram_2020_Dec_27_hour_19.png
cartogram_2020_Dec_27_hour_2.png
cartogram_2020_Dec_27_hour_20.png
cartogram_2020_Dec_27_hour_21.png
cartogram_2020_Dec_27_hour_22.png
cartogram_2020_Dec_27_hour_23.png
cartogram_2020_Dec_27_hour_3.png
cartogram_2020_Dec_27_hour_4.png
cartogram_2020_Dec_27_hour_5.png
cartogram_2020_Dec_27_hour_6.png
cartogram_2020_Dec_27_hour_7.png
cartogram_2020_Dec_27_hour_8.png
cartogram_2020_Dec_27_hour_9.png
cartogram_2020_Dec_28.gif
cartogram_2020_Dec_280.png
cartogram_2020_Dec_281.png
cartogram_2020_Dec_282.png
cartogram_2020_Dec_28_hour_.gif
cartogram_2020_Dec_28_hour_0.png
cartogram_2020_Dec_28_hour_1.png
cartogram_2020_Dec_28_hour_10.png
cartogram_2020_Dec_28_hour_11.png
cartogram_2020_Dec_28_hour_12.png
cartogram_2020_Dec_28_hour_13.png
cartogram_2020_Dec_28_hour_14.png
cartogram_2020_Dec_28_hour_15.png
cartogram_2020_Dec_28_hour_16.png
cartogram_2020_Dec_28_hour_17.png
cartogram_2020_Dec_28_hour_18.png
cartogram_2020_Dec_28_hour_19.png
cartogram_2020_Dec_28_hour_2.png
cartogram_2020_Dec_28_hour_20.png
cartogram_2020_Dec_28_hour_21.png
cartogram_2020_Dec_28_hour_22.png
cartogram_2020_Dec_28_hour_23.png
cartogram_2020_Dec_28_hour_3.png
cartogram_2020_Dec_28_hour_4.png
cartogram_2020_Dec_28_hour_5.png
cartogram_2020_Dec_28_hour_6.png
cartogram_2020_Dec_28_hour_7.png
cartogram_2020_Dec_28_hour_8.png
cartogram_2020_Dec_28_hour_9.png
cartogram_2020_Dec_29.gif
cartogram_2020_Dec_290.png
cartogram_2020_Dec_291.png
cartogram_2020_Dec_292.png
cartogram_2020_Dec_29_hour_.gif
cartogram_2020_Dec_29_hour_0.png
cartogram_2020_Dec_29_hour_1.png
cartogram_2020_Dec_29_hour_10.png
cartogram_2020_Dec_29_hour_11.png
cartogram_2020_Dec_29_hour_12.png
cartogram_2020_Dec_29_hour_13.png
cartogram_2020_Dec_29_hour_14.png
cartogram_2020_Dec_29_hour_15.png
cartogram_2020_Dec_29_hour_16.png
cartogram_2020_Dec_29_hour_17.png
cartogram_2020_Dec_29_hour_18.png
cartogram_2020_Dec_29_hour_19.png
cartogram_2020_Dec_29_hour_2.png
cartogram_2020_Dec_29_hour_20.png
cartogram_2020_Dec_29_hour_21.png
cartogram_2020_Dec_29_hour_22.png
cartogram_2020_Dec_29_hour_23.png
cartogram_2020_Dec_29_hour_3.png
cartogram_2020_Dec_29_hour_4.png
cartogram_2020_Dec_29_hour_5.png
cartogram_2020_Dec_29_hour_6.png
cartogram_2020_Dec_29_hour_7.png
cartogram_2020_Dec_29_hour_8.png
cartogram_2020_Dec_29_hour_9.png
cartogram_2020_Dec_30.gif
cartogram_2020_Dec_300.png
cartogram_2020_Dec_301.png
cartogram_2020_Dec_302.png
cartogram_2020_Dec_30_hour_.gif
cartogram_2020_Dec_30_hour_0.png
cartogram_2020_Dec_30_hour_1.png
cartogram_2020_Dec_30_hour_10.png
cartogram_2020_Dec_30_hour_11.png
cartogram_2020_Dec_30_hour_12.png
cartogram_2020_Dec_30_hour_13.png
cartogram_2020_Dec_30_hour_14.png
cartogram_2020_Dec_30_hour_15.png
cartogram_2020_Dec_30_hour_16.png
cartogram_2020_Dec_30_hour_17.png
cartogram_2020_Dec_30_hour_18.png
cartogram_2020_Dec_30_hour_19.png
cartogram_2020_Dec_30_hour_2.png
cartogram_2020_Dec_30_hour_20.png
cartogram_2020_Dec_30_hour_21.png
cartogram_2020_Dec_30_hour_22.png
cartogram_2020_Dec_30_hour_23.png
cartogram_2020_Dec_30_hour_3.png
cartogram_2020_Dec_30_hour_4.png
cartogram_2020_Dec_30_hour_5.png
cartogram_2020_Dec_30_hour_6.png
cartogram_2020_Dec_30_hour_7.png
cartogram_2020_Dec_30_hour_8.png
cartogram_2020_Dec_30_hour_9.png
cartogram_2020_Dec_31.gif
cartogram_2020_Dec_310.png
cartogram_2020_Dec_311.png
cartogram_2020_Dec_312.png
cartogram_2020_Dec_31_hour_.gif
cartogram_2020_Dec_31_hour_0.png
cartogram_2020_Dec_31_hour_1.png
cartogram_2020_Dec_31_hour_10.png
cartogram_2020_Dec_31_hour_11.png
cartogram_2020_Dec_31_hour_12.png
cartogram_2020_Dec_31_hour_13.png
cartogram_2020_Dec_31_hour_14.png
cartogram_2020_Dec_31_hour_15.png
cartogram_2020_Dec_31_hour_16.png
cartogram_2020_Dec_31_hour_17.png
cartogram_2020_Dec_31_hour_18.png
cartogram_2020_Dec_31_hour_19.png
cartogram_2020_Dec_31_hour_2.png
cartogram_2020_Dec_31_hour_20.png
cartogram_2020_Dec_31_hour_21.png
cartogram_2020_Dec_31_hour_22.png
cartogram_2020_Dec_31_hour_23.png
cartogram_2020_Dec_31_hour_3.png
cartogram_2020_Dec_31_hour_4.png
cartogram_2020_Dec_31_hour_5.png
cartogram_2020_Dec_31_hour_6.png
cartogram_2020_Dec_31_hour_7.png
cartogram_2020_Dec_31_hour_8.png
cartogram_2020_Dec_31_hour_9.png
cartogram_2021_Jan_1.gif
cartogram_2021_Jan_10.png
cartogram_2021_Jan_11.png
cartogram_2021_Jan_12.png
cartogram_2021_Jan_1_hour_.gif
cartogram_2021_Jan_1_hour_0.png
cartogram_2021_Jan_1_hour_1.png
cartogram_2021_Jan_1_hour_10.png
cartogram_2021_Jan_1_hour_11.png
cartogram_2021_Jan_1_hour_12.png
cartogram_2021_Jan_1_hour_13.png
cartogram_2021_Jan_1_hour_14.png
cartogram_2021_Jan_1_hour_15.png
cartogram_2021_Jan_1_hour_16.png
cartogram_2021_Jan_1_hour_17.png
cartogram_2021_Jan_1_hour_18.png
cartogram_2021_Jan_1_hour_19.png
cartogram_2021_Jan_1_hour_2.png
cartogram_2021_Jan_1_hour_20.png
cartogram_2021_Jan_1_hour_21.png
cartogram_2021_Jan_1_hour_22.png
cartogram_2021_Jan_1_hour_23.png
cartogram_2021_Jan_1_hour_3.png
cartogram_2021_Jan_1_hour_4.png
cartogram_2021_Jan_1_hour_5.png
cartogram_2021_Jan_1_hour_6.png
cartogram_2021_Jan_1_hour_7.png
cartogram_2021_Jan_1_hour_8.png
cartogram_2021_Jan_1_hour_9.png
cartogram_31rst_Dec.gif
cartogram_31rst_Dec0.png
cartogram_31rst_Dec1.png
cartogram_31rst_Dec10.png
cartogram_31rst_Dec11.png
cartogram_31rst_Dec12.png
cartogram_31rst_Dec13.png
cartogram_31rst_Dec14.png
cartogram_31rst_Dec15.png
cartogram_31rst_Dec16.png
cartogram_31rst_Dec17.png
cartogram_31rst_Dec18.png
cartogram_31rst_Dec19.png
cartogram_31rst_Dec2.png
cartogram_31rst_Dec20.png
cartogram_31rst_Dec21.png
cartogram_31rst_Dec22.png
cartogram_31rst_Dec23.png
cartogram_31rst_Dec3.png
cartogram_31rst_Dec4.png
cartogram_31rst_Dec5.png
cartogram_31rst_Dec6.png
cartogram_31rst_Dec7.png
cartogram_31rst_Dec8.png
cartogram_31rst_Dec9.png
cartogram_ToD0.png
cartogram_ToD1.png
cartogram_ToD10.png
cartogram_ToD11.png
cartogram_ToD12.png
cartogram_ToD13.png
cartogram_ToD14.png
cartogram_ToD15.png
cartogram_ToD16.png
cartogram_ToD17.png
cartogram_ToD18.png
cartogram_ToD19.png
cartogram_ToD2.png
cartogram_ToD20.png
cartogram_ToD21.png
cartogram_ToD22.png
cartogram_ToD23.png
cartogram_ToD3.png
cartogram_ToD4.png
cartogram_ToD5.png
cartogram_ToD6.png
cartogram_ToD7.png
cartogram_ToD8.png
cartogram_ToD9.png
cartogram_happy.gif
cartogram_happy0.png
cartogram_happy1.png
cartogram_happy10.png
cartogram_happy11.png
cartogram_happy12.png
cartogram_happy13.png
cartogram_happy14.png
cartogram_happy15.png
cartogram_happy16.png
cartogram_happy17.png
cartogram_happy18.png
cartogram_happy19.png
cartogram_happy2.png
cartogram_happy20.png
cartogram_happy21.png
cartogram_happy22.png
cartogram_happy23.png
cartogram_happy3.png
cartogram_happy4.png
cartogram_happy5.png
cartogram_happy6.png
cartogram_happy7.png
cartogram_happy8.png
cartogram_happy9.png
many_days_cartogram.gif
world_tweet.csv
</pre></div>
</div>
</div></blockquote>
<div class="section" id="save-reduced-df-for-use-in-r">
<h2>Save reduced df for use in r<a class="headerlink" href="#save-reduced-df-for-use-in-r" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tmp_path</span> <span class="o">=</span> <span class="s2">&quot;/dbfs/datasets/ScaDaMaLe/twitter/student-project-10_group-Geosmus/tmp/tmp.csv&quot;</span>
<span class="n">df_cc</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="r-based-plotting">
<h1>R based plotting<a class="headerlink" href="#r-based-plotting" title="Permalink to this headline">¶</a></h1>
<p>I think this section might become redundant. Python is starting to work
for cartograms.</p>
<div class="section" id="id1">
<h2>Installing dependencies<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>The following two cells need to be uncommented and run if running on a
new cluster.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># %sh </span>
<span class="c1"># sudo apt-get update</span>
<span class="c1"># sudo apt-get install libudunits2-dev -y</span>
<span class="c1"># sudo apt-get install libgdal-dev -y</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># %r</span>
<span class="c1"># install.packages(&quot;cartogram&quot;)</span>
<span class="c1"># install.packages(&quot;maptools&quot;)</span>
<span class="c1"># install.packages(&quot;rgeos&quot;)</span>
<span class="c1"># install.packages(&quot;sf&quot;)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="loading-data">
<h2>Loading data<a class="headerlink" href="#loading-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#importing libraries
library(maptools)
library(cartogram)
library(rgeos)
library(sf)

### Load csv data into data frame ###
if (nchar(Sys.getenv(&quot;SPARK_HOME&quot;)) &lt; 1) {
  Sys.setenv(SPARK_HOME = &quot;/home/spark&quot;)
}
library(SparkR, lib.loc = c(file.path(Sys.getenv(&quot;SPARK_HOME&quot;), &quot;R&quot;, &quot;lib&quot;)))
sparkR.session(master = &quot;local[*]&quot;, sparkConfig = list(spark.driver.memory = &quot;2g&quot;))

sparkR.session(sparkPackages = &quot;org.apache.spark:spark-avro_2.12:3.0.1&quot;)

csvPath &lt;- &#39;/datasets/ScaDaMaLe/twitter/student-project-10_group-Geosmus/tmp/tmp.csv&#39;

df &lt;- read.df(csvPath, &quot;csv&quot;, header = &quot;true&quot;, inferSchema = &quot;true&quot;, na.strings = &quot;NA&quot;)
names(df)[names(df) == &quot;countryCode&quot;] &lt;- &quot;ISO2&quot;
names(df)[names(df) == &quot;count&quot;] &lt;- &quot;numTweets&quot;
local_df &lt;- collect(df)

### Load the world spatialpolygondataframe ###
data(wrld_simpl)
my_map=wrld_simpl#[wrld_simpl$REGION==150,]

### Merge the spatialpolygondataframe and the data frame
df_tweet &lt;- merge(my_map, local_df,  by.x=&#39;ISO2&#39;, by.y=&#39;ISO2&#39;)
df_tweet &lt;- df_tweet[!is.na(df_tweet$numTweets), ]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_tweet</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>df_tweet_sf = st_as_sf(df_tweet)
df_tweet_sf_proj = st_transform(df_tweet_sf, 3857) #Mercator (EPSG: 3857)
drops &lt;- c(&quot;UN&quot;, &quot;FIPS&quot;, &quot;ISO3&quot;, &quot;REGION&quot;, &quot;LON&quot;, &quot;LAT&quot;, &quot;AREA&quot;, &quot;NAME&quot;, &quot;SUBREGION&quot;, &quot;popden&quot;)
df_tweet_sf_proj &lt;- df_tweet_sf_proj[ , !(names(df_tweet_sf_proj) %in% drops)]
 
# construct a cartogram using the number of tweets
df_tweet_cartogram &lt;- cartogram_cont(df_tweet_sf_proj, &quot;numTweets&quot;, itermax=20)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="todo-z-axis">
<h2>TODO: z-axis<a class="headerlink" href="#todo-z-axis" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>drops &lt;- c(&quot;UN&quot;, &quot;FIPS&quot;, &quot;ISO3&quot;, &quot;REGION&quot;, &quot;LON&quot;, &quot;LAT&quot;, &quot;AREA&quot;, &quot;NAME&quot;, &quot;SUBREGION&quot;, &quot;popden&quot;)
plot(df_tweet_cartogram[ , !(names(my_map) %in% drops)])
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="alternative-r-approach">
<h1>Alternative R approach<a class="headerlink" href="#alternative-r-approach" title="Permalink to this headline">¶</a></h1>
<p>The cartogram package is rather slow, and doesn’t seem to always
converge. In fact increasing the number of iterations sometimes leads to
worse performance. The rcartogram package is based on Mark Newman’s
method (and C code) and should be faster and hopefully also more
reliable. Uncomment the following cell to install on a new cluster.</p>
<p>This one is harder to install. I have not managed to get it to work so
far.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># %sh</span>
<span class="c1"># sudo apt-get update -y</span>
<span class="c1"># sudo apt-get install -y libfftw3-dev</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># %r</span>
<span class="c1"># install.packages(&quot;fftw&quot;)</span>
<span class="c1"># install.packages(&quot;remotes&quot;)</span>
<span class="c1"># remotes::install_github(&quot;omegahat/Rcartogram&quot;)</span>
<span class="c1"># install.packages(&quot;getcartr&quot;)</span>
<span class="c1"># install.packages(&quot;rgdal&quot;)</span>
<span class="c1"># install.packages(&quot;sp&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># %r</span>
<span class="c1"># library(rgdal)#needed for readOGR</span>
<span class="c1"># library(sp) #needed for spplot</span>
<span class="c1"># library(Rcartogram)</span>
<span class="c1"># library(getcartr)</span>
</pre></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./000_0-sds-3-x-projects/student-project-10_group-Geosmus"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By ScaDaMaLe Team<br/>
        
            &copy; Copyright 2020 Creative Commons Zero v1.0 Universal.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>