
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Extensions &#8212; Scalable Data Science &amp; Distributed Machine Learning</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Fundamental Matrix" href="../student-project-19_group-Featuring/01_FundamentalMatrix.html" />
    <link rel="prev" title="The Alternating Least Squares method (ALS)" href="01_The_ALS_method.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Scalable Data Science & Distributed Machine Learning</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/000_ScaDaMaLe.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction to Apache Spark Core
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_1-sds-3-x/001_whySpark.html">
   Why Apache Spark?
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html">
     Login to databricks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#import-course-content-now">
     Import Course Content Now!
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#cloud-free-computing-environment">
     Cloud-free Computing Environment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/002_01_multiLingualNotebooks.html">
     Multi-lingual Notebooks
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html">
   Scala Crash Course
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html">
     Scala Crash Course Continued
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_1-sds-3-x/004_RDDsTransformationsActions.html">
   Introduction to Spark
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/005_RDDsTransformationsActionsHOMEWORK.html">
     HOMEWORK on RDD Transformations and Actions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html">
     Piped RDDs and Bayesian AB Testing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#from-a-local-collection">
     From a Local Collection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#glom">
     glom
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#checkpointing">
     Checkpointing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#pipe-rdds-to-system-commands">
     Pipe RDDs to System Commands
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#mappartitions">
     mapPartitions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#foreachpartition">
     foreachPartition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#numerically-rigorous-bayesian-ab-testing">
     Numerically Rigorous Bayesian AB Testing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#usage-instructions-for-isit1or2coins">
     Usage instructions for IsIt1or2Coins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/006_WordCount.html">
     Word Count on US State of the Union (SoU) Addresses
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction to Apache Spark SQL
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html">
   Introduction to Spark SQL
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#getting-started-in-spark-2-x">
   Getting Started in Spark 2.x
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007a_SparkSQLProgGuide_HW.html">
     Spark Sql Programming Guide
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html">
     Getting Started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html#id1">
     Getting Started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007c_SparkSQLProgGuide_HW.html">
     Getting Started - Exercise
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html">
     Data Sources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html#id1">
     Data Sources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007e_SparkSQLProgGuide_HW.html">
     Performance Tuning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html">
     Distributed SQL Engine
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html#id1">
     Distributed SQL Engine
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html">
     ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#sql-pivoting-since-spark-2-4">
     SQL Pivoting since Spark 2.4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#load-data">
     Load Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-in-sql">
     Pivoting in SQL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-aggregate-expressions">
     Pivoting with Multiple Aggregate Expressions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-grouping-columns">
     Pivoting with Multiple Grouping Columns
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-pivot-columns">
     Pivoting with Multiple Pivot Columns
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Extract Transform and Load
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html">
   Diamonds ML Pipeline Workflow - DataFrame ETL and EDA Part
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#step-1-load-data-as-dataframe">
   Step 1. Load data as DataFrame
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#step-2-understand-the-data">
   Step 2. Understand the data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#let-us-run-through-some-basic-inteactive-sql-queries-next">
   Let us run through some basic inteactive SQL queries next
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#why-do-we-need-to-know-these-interactive-sql-queries">
   Why do we need to know these interactive SQL queries?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#we-will-continue-later-with-ml-pipelines-to-do-prediction-with-a-fitted-model-from-this-dataset">
   We will continue later with ML pipelines to do prediction with a fitted model from this dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html">
   Power Plant ML Pipeline Application - DataFrame Part
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-1-business-understanding">
   Step 1: Business Understanding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-2-load-your-data">
   Step 2: Load Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#use-this-for-other-smallish-datasets-you-want-to-import-to-your-ce">
   USE THIS FOR OTHER SMALLish DataSets you want to import to your CE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-3-explore-your-data">
   Step 3: Explore Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-4-visualize-your-data">
   Step 4: Visualize Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html">
   Wiki Clickstream Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html#wikipedia-logo">
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_LoadExtract.html">
   Old Bailey Online Data Analysis in Apache Spark
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_LoadExtract.html#analysing-the-full-old-bailey-online-sessions-papers-dataset">
   Analysing the Full Old Bailey Online Sessions Papers Dataset
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html">
     Piped RDDs and Bayesian AB Testing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#from-a-local-collection">
     From a Local Collection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#glom">
     glom
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#checkpointing">
     Checkpointing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#pipe-rdds-to-system-commands">
     Pipe RDDs to System Commands
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#mappartitions">
     mapPartitions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#foreachpartition">
     foreachPartition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#numerically-rigorous-bayesian-ab-testing">
     Numerically Rigorous Bayesian AB Testing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#usage-instructions-for-isit1or2coins">
     Usage instructions for IsIt1or2Coins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#parsing-the-output-from-isit1or2coins">
     Parsing the output from
     <code class="docutils literal notranslate">
      <span class="pre">
       IsIt1or2Coins
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#providing-case-classes-for-input-and-output-for-easy-spark-communication">
     Providing case classes for input and output for easy spark communication
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/035_LDA_CornellMovieDialogs.html">
   Topic Modeling of Movie Dialogs with Latent Dirichlet Allocation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Trends in Money and News
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_9-sds-3-x-trends/000_TrendsInFinancialStocksAndNewsEvents.html">
   Trends in Financial Stocks and News Events
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_9-sds-3-x-trends/00a_FX1M.html">
     Historical FX-1-M Financial Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_9-sds-3-x-trends/00b_yfinance.html">
     yfinance Stock Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_9-sds-3-x-trends/000a_finance_utils.html">
     Utilities Needed for Financial Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_9-sds-3-x-trends/000b_gdelt_utils.html">
     Utilities Needed for Mass Media Data
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_9-sds-3-x-trends/01_trend_calculus_showcase.html">
   Finding trends in oil price data.
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_9-sds-3-x-trends/02_streamable_trend_calculus.html">
     Streaming Trend Calculus with Maximum Necessary Reversals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_9-sds-3-x-trends/03_streamable_trend_calculus_estimators.html">
     Markov Model for Trend Calculus
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_9-sds-3-x-trends/030_Spark_GDELT_project_001.html">
   Plugging into GDELT Mass Media Streams
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_9-sds-3-x-trends/030a_gdelt_EOI_detection.html">
     Detecting Events of Interest to OIL/GAS Price Trends
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_9-sds-3-x-trends/030b_gdelt_POI_detection.html">
     Detecting Persons of Interest to OIL/GAS Price Trends
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Distributed Deep Learning with Horovod
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../000_7-sds-3-x-ddl/00_DDL_Introduction.html">
   Introduction to Distributed Deep Learning (DDL) with Horovod over Tensorflow/keras and Pytorch
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_7-sds-3-x-ddl/0x_mnist-tensorflow-keras.html">
     Distributed deep learning training using TensorFlow and Keras with HorovodRunner
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../000_7-sds-3-x-ddl/0y_mnist-pytorch.html">
     Distributed deep learning training using PyTorch with HorovodRunner for MNIST
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  WASP AI-Track Student Projects
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-01_group-TheTwoCultures/00_download_data.html">
   The two cultures
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-01_group-TheTwoCultures/01_load_data.html">
     Preprocessing and loading the relevant data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-01_group-TheTwoCultures/02_logisticregression.html">
     The two cultures - Classifying threads with logistic regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-01_group-TheTwoCultures/03_word2vec.html">
     Classification using Word2Vec
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-01_group-TheTwoCultures/04_LDA.html">
     Topic Modeling with LDA
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-02_group-LiUUmeaSceneGraphMotifs/01_SceneGraphMotifs.html">
   Exploring the GQA Scene Graph Dataset Structure and Properties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-03_group-GuangyiZhang/01_triads.html">
   Signed Triads in Social Media
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-04_group-DistributedLinearAlgebra/01_DistributedSVD.html">
   Distributed Linear Algebra
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-04_group-DistributedLinearAlgebra/02_CollaborativeFiltering.html">
     Music Recommendation System
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-05_group-LundDirichletAnalysts/01_Wikipedia_LDA_Analysis.html">
   Wikipedia analysis using Latent Dirichlet Allocation (LDA)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-06_group-ParticleClustering/00_Introduction.html">
   Unsupervised clustering of particle physics data with distributed training
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-06_group-ParticleClustering/00_Introduction.html#introduction">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-06_group-ParticleClustering/00_Introduction.html#background">
   Background
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-06_group-ParticleClustering/00_Introduction.html#the-uclusted-algorithm">
   The UClusted algorithm
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-06_group-ParticleClustering/00_Introduction.html#motivation">
   Motivation
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-06_group-ParticleClustering/00_Introduction.html#our-contribution">
   Our contribution
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-06_group-ParticleClustering/01_data_and_preprocessing.html">
     Important!
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-06_group-ParticleClustering/01_data_and_preprocessing.html#important-continued-from-above">
     Important (continued from above)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-06_group-ParticleClustering/04_evaluate.html">
     Evaluation
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-07_group-MathAtKTH/01_Coding_Motifs.html">
   Motif Finding
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-07_group-MathAtKTH/01_Coding_Motifs.html#application">
   Application
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-07_group-MathAtKTH/02_Data_Processing.html">
     Data Processing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-07_group-MathAtKTH/03_graph_string_converter.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-07_group-MathAtKTH/03_graph_string_converter.html#examples">
     Examples
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-08_group-DistributedEnsemble/00_project.html">
   Distributed ensembles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-08_group-DistributedEnsemble/00_project.html#distributed-ensembles-prediction-api">
   Distributed ensembles prediction API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-08_group-DistributedEnsemble/00_project.html#application-example-distributed-predictions">
   Application example: Distributed predictions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-08_group-DistributedEnsemble/00_project.html#application-example-out-of-distribution-detection">
   Application example: Out of distribution detection
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-09_group-TopicModeling/01_Introduction.html">
   Topic Modeling with SARS-Cov-2 Genome 🧬
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-09_group-TopicModeling/02_Data_Processing.html">
     Data Processing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-09_group-TopicModeling/03_LDA.html">
     LDA - Extract Features
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-09_group-TopicModeling/04_Classification_CountVector.html">
     Classification CountVector
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-09_group-TopicModeling/05_Classification.html">
     Load processed data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-09_group-TopicModeling/05_Classification.html#explore-data">
     Explore data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-09_group-TopicModeling/05_Classification.html#classification">
     Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-09_group-TopicModeling/05_Classification.html#evaluation">
     Evaluation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-09_group-TopicModeling/06_Results.html">
     Results and Conclusion
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-10_group-Geosmus/01_Introduction.html">
   Twitter Streaming Using Geolocation and Emoji Based Sentiment Analysis
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-10_group-Geosmus/02_ClusteringEmoticonsBasedOnTweets.html">
     Clustering emoticons based on tweets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-10_group-Geosmus/03_Dynamic_Tweet_Maps.html">
     Dynamic Tweet Maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-10_group-Geosmus/04_conclusion.html">
     Conclusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-10_group-Geosmus/05_appendix_get-cc-data.html">
     Notebook for collecting tweets with country codes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-10_group-Geosmus/07_a_appendix_extendedTwitterUtils2run.html">
     ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-10_group-Geosmus/07_a_appendix_extendedTwitterUtils2run.html#extended-spark-streaming-twitter-twitterutils">
     Extended spark.streaming.twitter.TwitterUtils
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-10_group-Geosmus/07_b_appendix_TTTDFfunctions.html">
     ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-11_group-Sketchings/00_QuantileEstimation.html">
   Anomaly Detection with Iterative Quantile Estimation and T-digest
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-12_group-CovidPandemic/00_ProjectDescriptionAndPlanning.html">
   Project Description and Introduction
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/01_DownloadFilesPeriodicallyScript.html">
     Download Files Periodically
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/01_StreamToFile.html">
     Stream to parquet file
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/021_DataPreprocess_Explain.html">
     Loading data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/021_DataPreprocess_Explain.html#preprocessing">
     Preprocessing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/02_DataPreprocess.html">
     Loading data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/02_DataPreprocess.html#preprocessing">
     Preprocessing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/03_ExplosiveAnalysis.html">
     This notebook is for explosive analysis of features in data.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/03_ExplosiveAnalysis.html#statistics-of-invariant-features">
     Statistics of invariant features
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/03_ExplosiveAnalysis.html#correlation-between-invariant-features">
     Correlation between invariant features
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/03_ExplosiveAnalysis.html#correlation-between-new-case-per-million-total-case-new-death-per-million-total-death-per-million-reproduction-rate-and-stringency-index">
     Correlation between new case per million, total case, new death per million, total death per million, reproduction rate and stringency index.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/04_DataVisualize.html">
     Show reproduction rate of selected countries i.e. Sweden, Germany, Danmark, Finland, Norway
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/04_DataVisualize.html#visualize-total-cases-total-deaths-new-cases-and-new-deaths-during-pandemic">
     Visualize total cases, total deaths, new cases and new deaths during pandemic
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/04_DataVisualize.html#total-deaths">
     Total Deaths
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/04_DataVisualize.html#new-cases">
     New Cases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/04_DataVisualize.html#new-deaths">
     New Deaths
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/05_Clustering.html">
     Clustering of country features in the Covid 19 dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/06_DataPredicton_LR.html">
     Prediction with Linear Regression (LR) Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/07_DataPredicton_ARIMA.html">
     Prediction with Time Series model - ARIMA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-12_group-CovidPandemic/08_DataPrediction_GP.html">
     Prediction with time series model - Gaussian Processes
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-13_group-Genomics/01_1000genomes.html">
   Genomics Analysis with Glow and Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-13_group-Genomics/01_1000genomes.html#load-libs-and-define-helper-functions">
   Load libs and define helper functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-13_group-Genomics/01_1000genomes.html#read-data">
   Read data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-13_group-Genomics/01_1000genomes.html#pca">
   PCA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-13_group-Genomics/01_1000genomes.html#predicting-ethinicity">
   Predicting Ethinicity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-13_group-Genomics/01_1000genomes.html#filtering-of-snps-based-on-chi-squared-test">
   Filtering of SNPs based on chi-squared test
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-14_group-NullHypothesisEvaluationCriteria/00_distributed_combinatorial_bandit.html">
   Distributional combinatorial bandits
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/00_video.html">
   Reinforcement Learning for Intraday Trading
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/01_rl_intraday_trading.html">
     Reinforcement Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/01_rl_intraday_trading.html#summary-and-outlook">
     Summary and Outlook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/02_rl_intraday_trading_elephas.html">
     Reinforcement Learning - Distributed model tuning with Elephas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/02_rl_intraday_trading_elephas.html#elephas">
     Elephas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/02_rl_intraday_trading_elephas.html#notes-to-the-elephas-training">
     Notes to the elephas training
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-15_group-FinancialDataStreams/03_resources.html">
     Resources
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-16_group-IntrusionDetection/00_Introduction.html">
   Intrusion Detection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-16_group-IntrusionDetection/00_Introduction.html#preparing-the-dataframe-for-training-classifers">
   Preparing the DataFrame for training classifers
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-17_group-TowardsScalableTDA/00_introduction.html">
   Density Estimation via Voronoi Diagrams in High Dimensions
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-17_group-TowardsScalableTDA/03_robotics_dataset.html">
     Robotics Dataset
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="00_Problem_Description.html">
   Recommender System
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="01_The_ALS_method.html">
     <span class="xref myst">
      The Alternating Least Squares method (ALS)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="01_The_ALS_method.html#on-a-small-dataset">
     <span class="xref myst">
      On a small dataset
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="01_The_ALS_method.html#on-a-large-dataset-netflix-dataset">
     <span class="xref myst">
      On a large dataset - Netflix dataset
     </span>
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Extensions
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-project-19_group-Featuring/01_FundamentalMatrix.html">
   Fundamental Matrix
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-20_group-Generalization/01_Background.html">
   MixUp and Generalization
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-20_group-Generalization/02_Random_Forest.html">
     Random Forests and MixUp
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-20_group-Generalization/03_CNN_MNIST.html">
     CNN for MNIST
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-20_group-Generalization/04_CNN_Intel_Image.html">
     CNN for Intel Image Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-20_group-Generalization/05_Horovod_test.html">
     CNNs and MixUp with Horovod
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-21_group-GraphSpectralAnalysis/00_introduction.html">
   Graph Spectral Analysis
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-21_group-GraphSpectralAnalysis/01_preprocess_data.html">
     Preprocess the data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-21_group-GraphSpectralAnalysis/02_generate_graphs.html">
     Generate random graphs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-21_group-GraphSpectralAnalysis/03_compute_rsvd.html">
     Compute RSVD
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-21_group-GraphSpectralAnalysis/04_analyse_eigenvalues.html">
     Analyse the eigenvalue spectrum
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../student-project-22_group-SwapWithDDP/00_Introduction.html">
   SWAP
   <em>
    With
   </em>
   DDP
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../student-project-22_group-SwapWithDDP/01_SWAP_with_DDP.html">
     SWAP
     <em>
      With
     </em>
     DDP
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/000_0-sds-3-x-projects/student-project-18_group-ProjectRL/02_Extensions.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://lamastex.github.io/ScaDaMaLe/index.html"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://lamastex.github.io/ScaDaMaLe/index.html/issues/new?title=Issue%20on%20page%20%2F000_0-sds-3-x-projects/student-project-18_group-ProjectRL/02_Extensions.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preliminaries">
   Preliminaries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ratings-distribution">
   Ratings distribution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-a-system-that-takes-user-info-and-outputs-suggestions">
   Create a system that takes user info and outputs suggestions.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#for-first-time-users-the-program-gives-the-top-rated-movies-over-all-users">
   For first time users, the program gives the top rated movies over all users.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#genres-analysis">
   Genres analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#we-investigate-whether-suggestion-based-on-genre-can-be-more-accurate-imagine-a-scenario-in-which-an-user-is-interested-in-watching-a-movie-of-a-particular-genre-say-an-animation-movie-given-this-information-can-we-suggest-a-better-film-with-respect-to-the-film-that-we-would-have-suggested-by-only-knowing-users-previous-ratings-on-such-movie">
     we investigate whether suggestion based on genre can be more accurate. Imagine a scenario in which an user is interested in watching a movie of a particular genre, say an Animation movie, given this information, can we suggest a better film with respect to the film that we would have suggested by only knowing user’s previous ratings on such movie?
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="extensions">
<h1>Extensions<a class="headerlink" href="#extensions" title="Permalink to this headline">¶</a></h1>
<p>In this notebook, we introduce multiple improvements to the original
algorithm, using the small dataset. We: - First, improve the original
algorithm by creating a system that takes user info and outputs
suggestions, which is the typical final role of a recommendation system.</p>
<ul class="simple">
<li><p>Then, we add the functionality that for first time user, we output the
top rated movies over all users. - Furthemore, we improve the existing
model by including the movie’s genres to give better recommendations.</p></li>
</ul>
<div class="section" id="preliminaries">
<h2>Preliminaries<a class="headerlink" href="#preliminaries" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>%%scala
// import the relevant libraries for `mllib`

import org.apache.spark.mllib.recommendation.ALS
import org.apache.spark.mllib.recommendation.MatrixFactorizationModel
import org.apache.spark.mllib.recommendation.Rating
import org.apache.spark.sql.expressions.UserDefinedFunction
import scala.collection.mutable.WrappedArray
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>import org.apache.spark.mllib.recommendation.ALS
import org.apache.spark.mllib.recommendation.MatrixFactorizationModel
import org.apache.spark.mllib.recommendation.Rating
import org.apache.spark.sql.expressions.UserDefinedFunction
import scala.collection.mutable.WrappedArray
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">Get</span> <span class="n">the</span> <span class="n">small</span> <span class="n">dataset</span> <span class="ow">and</span> <span class="n">display</span> <span class="n">information</span>
<span class="n">display</span><span class="p">(</span><span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s2">&quot;/databricks-datasets/cs100/lab4/data-001/&quot;</span><span class="p">))</span> <span class="o">//</span> <span class="n">The</span> <span class="n">data</span> <span class="ow">is</span> <span class="n">already</span> <span class="n">here</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead>
<tr class="header">
<th>path</th>
<th>name</th>
<th>size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>dbfs:/databricks-datasets/cs100/lab4/data-001/movies.dat</td>
<td>movies.dat</td>
<td>171308.0</td>
</tr>
<tr class="even">
<td>dbfs:/databricks-datasets/cs100/lab4/data-001/ratings.dat.gz</td>
<td>ratings.dat.gz</td>
<td>2837683.0</td>
</tr>
</tbody>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">Create</span> <span class="n">the</span> <span class="n">RDD</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">ratings</span>

<span class="n">val</span> <span class="n">ratingsRDD</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s2">&quot;/databricks-datasets/cs100/lab4/data-001/ratings.dat.gz&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">line</span> <span class="o">=&gt;</span>
      <span class="n">val</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">)</span>
      <span class="o">//</span> <span class="nb">format</span><span class="p">:</span> <span class="n">Rating</span><span class="p">(</span><span class="n">userId</span><span class="p">,</span> <span class="n">movieId</span><span class="p">,</span> <span class="n">rating</span><span class="p">)</span>
      <span class="n">Rating</span><span class="p">(</span><span class="n">fields</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">toInt</span><span class="p">,</span> <span class="n">fields</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">toInt</span><span class="p">,</span> <span class="n">fields</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">toDouble</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ratingsRDD: org.apache.spark.rdd.RDD[org.apache.spark.mllib.recommendation.Rating] = MapPartitionsRDD[21729] at map at command-3389902380791579:3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">We</span> <span class="n">take</span> <span class="n">a</span> <span class="n">look</span> <span class="n">at</span> <span class="n">the</span> <span class="n">first</span> <span class="mi">10</span> <span class="n">entries</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">Ratings</span> <span class="n">RDD</span>
<span class="n">ratingsRDD</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">println</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rating(1,1193,5.0)
Rating(1,661,3.0)
Rating(1,914,3.0)
Rating(1,3408,4.0)
Rating(1,2355,5.0)
Rating(1,1197,3.0)
Rating(1,1287,5.0)
Rating(1,2804,5.0)
Rating(1,594,4.0)
Rating(1,919,4.0)
res86: Array[Unit] = Array((), (), (), (), (), (), (), (), (), ())
</pre></div>
</div>
</div>
</div>
<p>A similar command is used to format the movies. For this first part the
genre field is ignored. They will considered in the second part of this
notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="n">val</span> <span class="n">movies</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s2">&quot;/databricks-datasets/cs100/lab4/data-001/movies.dat&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">line</span> <span class="o">=&gt;</span>
      <span class="n">val</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">)</span>
      <span class="o">//</span> <span class="nb">format</span><span class="p">:</span> <span class="p">(</span><span class="n">movieId</span><span class="p">,</span> <span class="n">movieName</span><span class="p">)</span>
      <span class="p">(</span><span class="n">fields</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">toInt</span><span class="p">,</span> <span class="n">fields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="p">}</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">toMap</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>movies: scala.collection.immutable.Map[Int,String] = Map(2163 -&gt; Attack of the Killer Tomatoes! (1980), 645 -&gt; Nelly &amp; Monsieur Arnaud (1995), 892 -&gt; Twelfth Night (1996), 69 -&gt; Friday (1995), 2199 -&gt; Phoenix (1998), 3021 -&gt; Funhouse, The (1981), 1322 -&gt; Amityville 1992: It&#39;s About Time (1992), 1665 -&gt; Bean (1997), 1036 -&gt; Die Hard (1988), 2822 -&gt; Medicine Man (1992), 2630 -&gt; Besieged (L&#39; Assedio) (1998), 3873 -&gt; Cat Ballou (1965), 1586 -&gt; G.I. Jane (1997), 1501 -&gt; Keys to Tulsa (1997), 2452 -&gt; Gate II: Trespassers, The (1990), 809 -&gt; Fled (1996), 1879 -&gt; Hanging Garden, The (1997), 1337 -&gt; Body Snatcher, The (1945), 1718 -&gt; Stranger in the House (1997), 2094 -&gt; Rocketeer, The (1991), 3944 -&gt; Bootmen (2000), 1411 -&gt; Hamlet (1996), 629 -&gt; Rude (1995), 3883 -&gt; Catfish in Black Bean Sauce (2000), 2612 -&gt; Mildred Pierce (1945), 1024 -&gt; Three Caballeros, The (1945), 365 -&gt; Little Buddha (1993), 2744 -&gt; Otello (1986), 1369 -&gt; I Can&#39;t Sleep (J&#39;ai pas sommeil) (1994), 138 -&gt; Neon Bible, The (1995), 2889 -&gt; Mystery, Alaska (1999), 1190 -&gt; Tie Me Up! Tie Me Down! (1990), 1168 -&gt; Bad Moon (1996), 2295 -&gt; Impostors, The (1998), 2306 -&gt; Holy Man (1998), 3053 -&gt; Messenger: The Story of Joan of Arc, The (1999), 3345 -&gt; Charlie, the Lonesome Cougar (1967), 760 -&gt; Stalingrad (1993), 2341 -&gt; Dancing at Lughnasa (1998), 101 -&gt; Bottle Rocket (1996), 2336 -&gt; Elizabeth (1998), 3008 -&gt; Last Night (1998), 2109 -&gt; Jerk, The (1979), 2131 -&gt; Autumn Sonata (H�stsonaten ) (1978), 1454 -&gt; SubUrbia (1997), 2031 -&gt; $1,000,000 Duck (1971), 1633 -&gt; Ulee&#39;s Gold (1997), 2778 -&gt; Never Talk to Strangers (1995), 2072 -&gt; &#39;burbs, The (1989), 3661 -&gt; Puppet Master II (1990), 1767 -&gt; Music From Another Room (1998), 3399 -&gt; Sesame Street Presents Follow That Bird (1985), 1995 -&gt; Poltergeist II: The Other Side (1986), 2263 -&gt; Seventh Sign, The (1988), 3930 -&gt; Creature From the Black Lagoon, The (1954), 479 -&gt; Judgment Night (1993), 3798 -&gt; What Lies Beneath (2000), 1559 -&gt; Next Step, The (1995), 1105 -&gt; Children of the Corn IV: The Gathering (1996), 347 -&gt; Bitter Moon (1992), 3666 -&gt; Retro Puppetmaster (1999), 1729 -&gt; Jackie Brown (1997), 3434 -&gt; Death Wish V: The Face of Death (1994), 3167 -&gt; Carnal Knowledge (1971), 2412 -&gt; Rocky V (1990), 2876 -&gt; Thumbelina (1994), 1237 -&gt; Seventh Seal, The (Sjunde inseglet, Det) (1957), 846 -&gt; Flirt (1995), 909 -&gt; Apartment, The (1960), 2921 -&gt; High Plains Drifter (1972), 3477 -&gt; Empire Records (1995), 3698 -&gt; Running Man, The (1987), 333 -&gt; Tommy Boy (1995), 628 -&gt; Primal Fear (1996), 1031 -&gt; Bedknobs and Broomsticks (1971), 249 -&gt; Immortal Beloved (1994), 2463 -&gt; Ruthless People (1986), 3397 -&gt; Great Muppet Caper, The (1981), 1899 -&gt; Passion in the Desert (1998), 893 -&gt; Mother Night (1996), 1840 -&gt; He Got Game (1998), 3581 -&gt; Human Traffic (1999), 1315 -&gt; Paris Was a Woman (1995), 3863 -&gt; Cell, The (2000), 3830 -&gt; Psycho Beach Party (2000), 2787 -&gt; Cat&#39;s Eye (1985), 2595 -&gt; Photographer (Fotoamator) (1998), 518 -&gt; Road to Wellville, The (1994), 1850 -&gt; I Love You, Don&#39;t Touch Me! (1998), 2499 -&gt; God Said &#39;Ha!&#39; (1998), 2427 -&gt; Thin Red Line, The (1998), 2480 -&gt; Dry Cleaning (Nettoyage � sec) (1997), 1083 -&gt; Great Race, The (1965), 962 -&gt; They Made Me a Criminal (1939), 1982 -&gt; Halloween (1978), 468 -&gt; Englishman Who Went Up a Hill, But Came Down a Mountain, The (1995), 2559 -&gt; King and I, The (1999), 3449 -&gt; Good Mother, The (1988), 234 -&gt; Exit to Eden (1994), 2544 -&gt; School of Flesh, The (L&#39; �cole de la chair) (1998), 941 -&gt; Mark of Zorro, The (1940), 3927 -&gt; Fantastic Voyage (1966), 1179 -&gt; Grifters, The (1990), 2331 -&gt; Living Out Loud (1998), 777 -&gt; Pharaoh&#39;s Army (1995), 3566 -&gt; Big Kahuna, The (2000), 555 -&gt; True Romance (1993), 666 -&gt; All Things Fair (1996), 1295 -&gt; Unbearable Lightness of Being, The (1988), 1956 -&gt; Ordinary People (1980), 1950 -&gt; In the Heat of the Night (1967), 88 -&gt; Black Sheep (1996), 1549 -&gt; Rough Magic (1995), 2280 -&gt; Clay Pigeons (1998), 1554 -&gt; Pillow Book, The (1995), 1110 -&gt; Bird of Prey (1996), 3172 -&gt; Ulysses (Ulisse) (1954), 1686 -&gt; Red Corner (1997), 481 -&gt; Kalifornia (1993), 352 -&gt; Crooklyn (1994), 2250 -&gt; Men Don&#39;t Leave (1990), 2363 -&gt; Godzilla (Gojira) (1954), 1855 -&gt; Krippendorf&#39;s Tribe (1998), 3680 -&gt; Decline of Western Civilization Part II: The Metal Years, The (1988), 1200 -&gt; Aliens (1986), 2077 -&gt; Journey of Natty Gann, The (1985), 3534 -&gt; 28 Days (2000), 1750 -&gt; Star Kid (1997), 3185 -&gt; Snow Falling on Cedars (1999), 408 -&gt; 8 Seconds (1994), 977 -&gt; Moonlight Murder (1936), 170 -&gt; Hackers (1995), 3681 -&gt; For a Few Dollars More (1965), 1211 -&gt; Wings of Desire (Der Himmel �ber Berlin) (1987), 523 -&gt; Ruby in Paradise (1993), 1158 -&gt; Here Comes Cookie (1935), 2309 -&gt; Inheritors, The (Die Siebtelbauern) (1998), 2512 -&gt; Ballad of Narayama, The (Narayama Bushiko) (1982), 582 -&gt; Metisse (Caf� au Lait) (1993), 2976 -&gt; Bringing Out the Dead (1999), 762 -&gt; Striptease (1996), 3072 -&gt; Moonstruck (1987), 1924 -&gt; Plan 9 from Outer Space (1958), 1005 -&gt; D3: The Mighty Ducks (1996), 2210 -&gt; Sabotage (1936), 2117 -&gt; Nineteen Eighty-Four (1984), 2940 -&gt; Gilda (1946), 1596 -&gt; Career Girls (1997), 1406 -&gt; C�r�monie, La (1995), 115 -&gt; Happiness Is in the Field (1995), 2104 -&gt; Tex (1982), 3317 -&gt; Wonder Boys (2000), 683 -&gt; Eye of Vichy, The (Oeil de Vichy, L&#39;) (1993), 730 -&gt; Low Life, The (1994), 1290 -&gt; Some Kind of Wonderful (1987), 1882 -&gt; Godzilla (1998), 217 -&gt; Babysitter, The (1995), 276 -&gt; Milk Money (1994), 2231 -&gt; Rounders (1998), 2622 -&gt; Midsummer Night&#39;s Dream, A (1999), 1068 -&gt; Crossfire (1947), 3858 -&gt; Cecil B. Demented (2000), 2808 -&gt; Universal Soldier (1992), 3905 -&gt; Specials, The (2000), 1522 -&gt; Ripe (1996), 3762 -&gt; Daughter of Dr. Jeckyll (1957), 2644 -&gt; Dracula (1931), 3813 -&gt; Interiors (1978), 2495 -&gt; Fantastic Planet, The (La Plan�te sauvage) (1973), 3230 -&gt; Odessa File, The (1974), 2381 -&gt; Police Academy 4: Citizens on Patrol (1987), 2395 -&gt; Rushmore (1998), 2908 -&gt; Boys Don&#39;t Cry (1999), 2062 -&gt; Governess, The (1998), 3549 -&gt; Guys and Dolls (1955), 1443 -&gt; Tickle in the Heart, A (1996), 2776 -&gt; Marcello Mastroianni: I Remember Yes, I Remember (1997), 2659 -&gt; It Came from Hollywood (1982), 3417 -&gt; Crimson Pirate, The (1952), 3509 -&gt; Black and White (1999), 3285 -&gt; Beach, The (2000), 3377 -&gt; Hangmen Also Die (1943), 994 -&gt; Big Night (1996), 2527 -&gt; Westworld (1973), 3040 -&gt; Meatballs (1979), 3153 -&gt; 7th Voyage of Sinbad, The (1958), 2953 -&gt; Home Alone 2: Lost in New York (1992), 2590 -&gt; Hideous Kinky (1998), 1401 -&gt; Ghosts of Mississippi (1996), 3460 -&gt; Hillbillys in a Haunted House (1967), 1422 -&gt; Murder at 1600 (1997), 308 -&gt; Three Colors: White (1994), 2947 -&gt; Goldfinger (1964), 1569 -&gt; My Best Friend&#39;s Wedding (1997), 1939 -&gt; Best Years of Our Lives, The (1946), 2248 -&gt; Say Anything... (1989), 3912 -&gt; Beautiful (2000), 3098 -&gt; Natural, The (1984), 741 -&gt; Ghost in the Shell (Kokaku kidotai) (1995), 1073 -&gt; Willy Wonka and the Chocolate Factory (1971), 2671 -&gt; Notting Hill (1999), 1544 -&gt; Lost World: Jurassic Park, The (1997), 2676 -&gt; Instinct (1999), 2014 -&gt; Freaky Friday (1977), 3910 -&gt; Dancer in the Dark (2000), 5 -&gt; Father of the Bride Part II (1995), 1728 -&gt; Winter Guest, The (1997), 3108 -&gt; Fisher King, The (1991), 873 -&gt; Shadow of Angels (Schatten der Engel) (1976), 3012 -&gt; Battling Butler (1926), 1205 -&gt; Transformers: The Movie, The (1986), 449 -&gt; Fear of a Black Hat (1993), 120 -&gt; Race the Sun (1996), 2099 -&gt; Song of the South (1946), 2282 -&gt; Pecker (1998), 247 -&gt; Heavenly Creatures (1994), 1591 -&gt; Spawn (1997), 2114 -&gt; Outsiders, The (1983), 2837 -&gt; Bedrooms &amp; Hallways (1998), 1142 -&gt; Get Over It (1996), 379 -&gt; Timecop (1994), 1269 -&gt; Arsenic and Old Lace (1944), 878 -&gt; Bye-Bye (1995), 440 -&gt; Dave (1993), 655 -&gt; Mutters Courage (1995), 3498 -&gt; Midnight Express (1978), 511 -&gt; Program, The (1993), 2380 -&gt; Police Academy 3: Back in Training (1986), 1971 -&gt; Nightmare on Elm Street 4: The Dream Master, A (1988), 1793 -&gt; Welcome to Woop-Woop (1997), 3402 -&gt; Turtle Diary (1985), 2854 -&gt; Don&#39;t Look in the Basement! (1973), 1533 -&gt; Promise, The (La Promesse) (1996), 614 -&gt; Loaded (1994), 1692 -&gt; Alien Escape (1995), 269 -&gt; My Crazy Life (Mi vida loca) (1993), 1305 -&gt; Paris, Texas (1984), 202 -&gt; Total Eclipse (1995), 597 -&gt; Pretty Woman (1990), 1437 -&gt; Cement Garden, The (1993), 1041 -&gt; Secrets &amp; Lies (1996), 861 -&gt; Supercop (1992), 3382 -&gt; Song of Freedom (1936), 1173 -&gt; Cook the Thief His Wife &amp; Her Lover, The (1989), 1486 -&gt; Quiet Room, The (1996), 3848 -&gt; Silent Fall (1994), 1497 -&gt; Double Team (1997), 10 -&gt; GoldenEye (1995), 2195 -&gt; Dirty Work (1998), 1705 -&gt; Guy (1996), 3017 -&gt; Creepshow 2 (1987), 1078 -&gt; Bananas (1971), 1788 -&gt; Men With Guns (1997), 1426 -&gt; Zeus and Roxanne (1997), 3217 -&gt; Star Is Born, A (1937), 3530 -&gt; Smoking/No Smoking (1993), 1671 -&gt; Deceiver (1997), 3794 -&gt; Chuck &amp; Buck (2000), 1608 -&gt; Air Force One (1997), 3439 -&gt; Teenage Mutant Ninja Turtles II: The Secret of the Ooze (1991), 385 -&gt; Man of No Importance, A (1994), 384 -&gt; Bad Company (1995), 56 -&gt; Kids of the Round Table (1995), 1655 -&gt; Phantoms (1998), 3120 -&gt; Distinguished Gentleman, The (1992), 3429 -&gt; Creature Comforts (1990), 3049 -&gt; How I Won the War (1967), 3745 -&gt; Titan A.E. (2000), 1137 -&gt; Hustler White (1996), 2607 -&gt; Get Real (1998), 2686 -&gt; Red Violin, The (Le Violon rouge) (1998), 1756 -&gt; Prophecy II, The (1998), 1310 -&gt; Hype! (1996), 533 -&gt; Shadow, The (1994), 3004 -&gt; Bachelor, The (1999), 2035 -&gt; Blackbeard&#39;s Ghost (1968), 3332 -&gt; Legend of Lobo, The (1962), 3367 -&gt; Devil&#39;s Brigade, The (1968), 3648 -&gt; Abominable Snowman, The (1957), 3135 -&gt; Great Santini, The (1979), 3942 -&gt; Sorority House Massacre II (1990), 550 -&gt; Threesome (1994), 3649 -&gt; American Gigolo (1980), 3365 -&gt; Searchers, The (1956), 142 -&gt; Shadows (Cienie) (1988), 2740 -&gt; Kindred, The (1986), 2918 -&gt; Ferris Bueller&#39;s Day Off (1986), 3044 -&gt; Dead Again (1991), 1735 -&gt; Great Expectations (1998), 1867 -&gt; Tarzan and the Lost City (1998), 500 -&gt; Mrs. Doubtfire (1993), 2184 -&gt; Trouble with Harry, The (1955), 3175 -&gt; Galaxy Quest (1999), 1164 -&gt; Two or Three Things I Know About Her (1966), 1999 -&gt; Exorcist III, The (1990), 797 -&gt; Old Lady Who Walked in the Sea, The (Vieille qui marchait dans la mer, La) (1991), 2316 -&gt; Practical Magic (1998), 3446 -&gt; Funny Bones (1995), 715 -&gt; Horseman on the Roof, The (Hussard sur le toit, Le) (1995), 2448 -&gt; Virus (1999), 3338 -&gt; For All Mankind (1989), 2933 -&gt; Fire Within, The (Le Feu Follet) (1963), 1275 -&gt; Highlander (1986), 2141 -&gt; American Tail, An (1986), 2434 -&gt; Down in the Delta (1998), 1872 -&gt; Go Now (1995), 2712 -&gt; Eyes Wide Shut (1999), 472 -&gt; I&#39;ll Do Anything (1994), 3616 -&gt; Loser (2000), 1233 -&gt; Boat, The (Das Boot) (1981), 3781 -&gt; Shaft in Africa (1973), 814 -&gt; Boy Called Hate, A (1995), 1327 -&gt; Amityville Horror, The (1979), 3693 -&gt; Toxic Avenger, The (1985), 2476 -&gt; Heartbreak Ridge (1986), 2627 -&gt; Endurance (1998), 2168 -&gt; Dance with Me (1998), 1260 -&gt; M (1931), 698 -&gt; Delta of Venus (1994), 1919 -&gt; Madeline (1998), 3253 -&gt; Wayne&#39;s World (1992), 1988 -&gt; Hello Mary Lou: Prom Night II (1987), 3826 -&gt; Hollow Man (2000), 2459 -&gt; Texas Chainsaw Massacre, The (1974), 3414 -&gt; Love Is a Many-Splendored Thing (1955), 1342 -&gt; Candyman (1992), 3121 -&gt; Hitch-Hiker, The (1953), 747 -&gt; Stupids, The (1996), 913 -&gt; Maltese Falcon, The (1941), 3481 -&gt; High Fidelity (2000), 3562 -&gt; Committed (2000), 1640 -&gt; How to Be a Player (1997), 2580 -&gt; Go (1999), 2901 -&gt; Phantasm (1979), 945 -&gt; Top Hat (1935), 3313 -&gt; Class Reunion (1982), 1063 -&gt; Johns (1996), 1954 -&gt; Rocky (1976), 2844 -&gt; Minus Man, The (1999), 340 -&gt; War, The (1994), 3577 -&gt; Two Moon Juction (1988), 2042 -&gt; D2: The Mighty Ducks (1994), 538 -&gt; Six Degrees of Separation (1993), 1354 -&gt; Breaking the Waves (1996), 153 -&gt; Batman Forever (1995), 2146 -&gt; St. Elmo&#39;s Fire (1985), 1507 -&gt; Paradise Road (1997), 1222 -&gt; Full Metal Jacket (1987), 930 -&gt; Notorious (1946), 3895 -&gt; Watcher, The (2000), 3717 -&gt; Gone in 60 Seconds (2000), 2360 -&gt; Celebration, The (Festen) (1998), 1458 -&gt; Touch (1997), 670 -&gt; World of Apu, The (Apur Sansar) (1959), 3276 -&gt; Gun Shy (2000), 2575 -&gt; Dreamlife of Angels, The (La Vie r�v�e des anges) (1998), 829 -&gt; Joe&#39;s Apartment (1996), 3370 -&gt; Betrayed (1988), 174 -&gt; Jury Duty (1995), 1095 -&gt; Glengarry Glen Ross (1992), 404 -&gt; Brother Minister: The Assassination of Malcolm X (1994), 3335 -&gt; Jail Bait (1954), 1196 -&gt; Star Wars: Episode V - The Empire Strikes Back (1980), 1746 -&gt; Senseless (1998), 3103 -&gt; Stanley &amp; Iris (1990), 898 -&gt; Philadelphia Story, The (1940), 185 -&gt; Net, The (1995), 1835 -&gt; City of Angels (1998), 3836 -&gt; Kelly&#39;s Heroes (1970), 2216 -&gt; Skin Game, The (1931), 3236 -&gt; Zachariah (1971), 3629 -&gt; Gold Rush, The (1925), 2348 -&gt; Sid and Nancy (1986), 3350 -&gt; Raisin in the Sun, A (1961), 1001 -&gt; Associate, The (L&#39;Associe)(1982), 3545 -&gt; Cabaret (1972), 2723 -&gt; Mystery Men (1999), 2972 -&gt; Red Sorghum (Hong Gao Liang) (1987), 3634 -&gt; Seven Days in May (1964), 2046 -&gt; Flight of the Navigator (1986), 3766 -&gt; Missing in Action (1984), 2432 -&gt; Stepmom (1998), 1914 -&gt; Smoke Signals (1998), 2491 -&gt; Simply Irresistible (1999), 1243 -&gt; Rosencrantz and Guildenstern Are Dead (1990), 1127 -&gt; Abyss, The (1989), 2763 -&gt; Thomas Crown Affair, The (1999), 3915 -&gt; Girlfight (2000), 2548 -&gt; Rage: Carrie 2, The (1999), 1782 -&gt; Little City (1998), 3502 -&gt; My Life (1993), 42 -&gt; Dead Presidents (1995), 2985 -&gt; Robocop (1987), 2227 -&gt; Lodger, The (1926), 1391 -&gt; Mars Attacks! (1996), 3249 -&gt; Hand That Rocks the Cradle, The (1992), 782 -&gt; Fan, The (1996), 1441 -&gt; Benny &amp; Joon (1993), 709 -&gt; Oliver &amp; Company (1988), 2020 -&gt; Dangerous Liaisons (1988), 841 -&gt; Eyes Without a Face (1959), 3513 -&gt; Rules of Engagement (2000), 417 -&gt; Barcelona (1994), 24 -&gt; Powder (1995), 973 -&gt; Meet John Doe (1941), 885 -&gt; Bogus (1996), 3088 -&gt; Harvey (1950), 3777 -&gt; Nekromantik (1987), 1046 -&gt; Beautiful Thing (1996), 288 -&gt; Natural Born Killers (1994), 1613 -&gt; Star Maps (1997), 3308 -&gt; Flamingo Kid, The (1984), 2010 -&gt; Metropolis (1926), 1935 -&gt; How Green Was My Valley (1941), 3947 -&gt; Get Carter (1971), 1650 -&gt; Washington Square (1997), 3730 -&gt; Conversation, The (1974), 1645 -&gt; Devil&#39;s Advocate, The (1997), 1921 -&gt; Pi (1998), 2886 -&gt; Adventures of Elmo in Grouchland, The (1999), 1359 -&gt; Jingle All the Way (1996), 1601 -&gt; Hoodlum (1997), 1386 -&gt; Terror in a Texas Town (1958), 3281 -&gt; Brandon Teena Story, The (1998), 3466 -&gt; Heart and Souls (1993), 301 -&gt; Picture Bride (1995), 3898 -&gt; Bait (2000), 2082 -&gt; Mighty Ducks, The (1992), 3140 -&gt; Three Ages, The (1923), 1724 -&gt; Full Speed (1996), 1475 -&gt; Kama Sutra: A Tale of Love (1996), 320 -&gt; Suture (1993), 3809 -&gt; What About Bob? (1991), 2173 -&gt; Navigator: A Mediaeval Odyssey, The (1988), 565 -&gt; Cronos (1992), 1366 -&gt; Crucible, The (1996), 2516 -&gt; Children of the Corn III (1994), 2400 -&gt; Prancer (1989), 2067 -&gt; Doctor Zhivago (1965), 2825 -&gt; Rosie (1998), 1529 -&gt; Nowhere (1997), 1967 -&gt; Labyrinth (1986), 2819 -&gt; Three Days of the Condor (1975), 436 -&gt; Color of Night (1994), 3880 -&gt; Ballad of Ramblin&#39; Jack, The (2000), 3878 -&gt; X: The Unknown (1956), 2136 -&gt; Nutty Professor, The (1963), 37 -&gt; Across the Sea of Time (1995), 1904 -&gt; Henry Fool (1997), 1518 -&gt; Breakdown (1997), 1265 -&gt; Groundhog Day (1993), 1703 -&gt; For Richer or Poorer (1997), 2531 -&gt; Battle for the Planet of the Apes (1973), 2405 -&gt; Jewel of the Nile, The (1985), 1228 -&gt; Raging Bull (1980), 1623 -&gt; Wishmaster (1997), 1482 -&gt; Van, The (1996), 3597 -&gt; Whipped (2000), 25 -&gt; Leaving Las Vegas (1995), 1254 -&gt; Treasure of the Sierra Madre, The (1948), 3688 -&gt; Porky&#39;s (1981), 2869 -&gt; Separation, The (La S�paration) (1994), 1887 -&gt; Almost Heroes (1998), 651 -&gt; Superweib, Das (1996), 2957 -&gt; Sparrows (1926), 257 -&gt; Just Cause (1995), 3820 -&gt; Thomas and the Magic Railroad (2000), 3891 -&gt; Turn It Up (2000), 2654 -&gt; Wolf Man, The (1941), 389 -&gt; Colonel Chabert, Le (1994), 1628 -&gt; Locusts, The (1997), 3248 -&gt; Sister Act 2: Back in the Habit (1993), 52 -&gt; Mighty Aphrodite (1995), 1055 -&gt; Shadow Conspiracy (1997), 1409 -&gt; Michael (1996), 724 -&gt; Craft, The (1996), 3204 -&gt; Boys from Brazil, The (1978), 3442 -&gt; Band of the Hand (1986), 3263 -&gt; White Men Can&#39;t Jump (1992), 1287 -&gt; Ben-Hur (1959), 3221 -&gt; Draughtsman&#39;s Contract, The (1982), 14 -&gt; Nixon (1995), 1709 -&gt; Legal Deceit (1997), 2603 -&gt; N� (1998), 2328 -&gt; Vampires (1998), 2916 -&gt; Total Recall (1990), 3938 -&gt; Slumber Party Massacre, The (1982), 3195 -&gt; Tess of the Storm Country (1922), 3029 -&gt; Nighthawks (1981), 570 -&gt; Slingshot, The (K�disbellan ) (1993), 3425 -&gt; Mo&#39; Better Blues (1990), 1792 -&gt; U.S. Marshalls (1998), 1430 -&gt; Underworld (1997), 3644 -&gt; Dark Command (1940), 2735 -&gt; Golden Child, The (1986), 2814 -&gt; Bat, The (1959), 1985 -&gt; Halloween 4: The Return of Michael Myers (1988), 2039 -&gt; Cheetah (1989), 3275 -&gt; Boondock Saints, The (1999), 184 -&gt; Nadja (1994), 2698 -&gt; Zone 39 (1997), 1760 -&gt; Spice World (1997), 3131 -&gt; Broadway Damage (1997), 1660 -&gt; Eve&#39;s Bayou (1997), 1298 -&gt; Pink Floyd - The Wall (1982), 3116 -&gt; Miss Julie (1999), 2667 -&gt; Mole People, The (1956), 719 -&gt; Multiplicity (1996), 2339 -&gt; I&#39;ll Be Home For Christmas (1998), 785 -&gt; Kingpin (1996), 3046 -&gt; Incredibly True Adventure of Two Girls in Love, The (1995), 3689 -&gt; Porky&#39;s II: The Next Day (1983), 3342 -&gt; Birdy (1984), 2269 -&gt; Indecent Proposal (1993), 2755 -&gt; Light of Day (1987), 372 -&gt; Reality Bites (1994), 3495 -&gt; Roadside Prophets (1992), 504 -&gt; No Escape (1994), 1871 -&gt; Friend of the Deceased, A (1997), 3574 -&gt; Carnosaur 3: Primal Species (1996), 3061 -&gt; Holiday Inn (1942), 110 -&gt; Braveheart (1995), 2708 -&gt; Autumn Tale, An (Conte d&#39;automne) (1998), 3821 -&gt; Nutty Professor II: The Klumps (2000), 1907 -&gt; Mulan (1998), 2501 -&gt; October Sky (1999), 3617 -&gt; Road Trip (2000), 1330 -&gt; April Fool&#39;s Day (1986), 2444 -&gt; 24 7: Twenty Four Seven (1997), 1860 -&gt; Character (Karakter) (1997), 1264 -&gt; Diva (1981), 2217 -&gt; Elstree Calling (1930), 587 -&gt; Ghost (1990), 1323 -&gt; Amityville 3-D (1983), 3612 -&gt; Slipper and the Rose, The (1976), 3148 -&gt; Cider House Rules, The (1999), 3653 -&gt; Endless Summer, The (1966), 619 -&gt; Ed (1996), 838 -&gt; Emma (1996), 1511 -&gt; A Chef in Love (1996), 2274 -&gt; Lilian&#39;s Story (1995), 917 -&gt; Little Princess, The (1939), 702 -&gt; Faces (1968), 751 -&gt; Careful (1992), 3485 -&gt; Autopsy (Macchie Solari) (1975), 802 -&gt; Phenomenon (1996), 125 -&gt; Flirting With Disaster (1996), 344 -&gt; Ace Ventura: Pet Detective (1994), 3776 -&gt; Melody Time (1948), 2682 -&gt; Limbo (1999), 3125 -&gt; End of the Affair, The (1999), 1826 -&gt; Barney&#39;s Great Adventure (1998), 3542 -&gt; Coming Apart (1969), 1313 -&gt; Mad Dog Time (1996), 1279 -&gt; Night on Earth (1991), 3410 -&gt; Soft Fruit (1999), 2185 -&gt; I Confess (1953), 1577 -&gt; Mondo (1996), 1455 -&gt; Hotel de Love (1996), 3280 -&gt; Baby, The (1973), 3749 -&gt; Time Regained (Le Temps Retrouv�) (1999), 3845 -&gt; And God Created Woman (Et Dieu&amp;#8230;Cr�a la Femme) (1956), 2562 -&gt; Bandits (1997), 3089 -&gt; Bicycle Thief, The (Ladri di biciclette) (1948), 2488 -&gt; Peeping Tom (1960), 1832 -&gt; Heaven&#39;s Burning (1997), 2897 -&gt; And the Ship Sails On (E la nave va) (1984), 934 -&gt; Father of the Bride (1950), 357 -&gt; Four Weddings and a Funeral (1994), 1191 -&gt; Madonna: Truth or Dare (1991), 3744 -&gt; Shaft (2000), 1992 -&gt; Child&#39;s Play 2 (1990), 3353 -&gt; Closer You Get, The (2000), 3803 -&gt; Greaser&#39;s Palace (1972), 2466 -&gt; Belizaire the Cajun (1986), 2126 -&gt; Snake Eyes (1998), 196 -&gt; Species (1995), 1462 -&gt; Unforgotten: Twenty-Five Years After Willowbrook (1996), 1059 -&gt; William Shakespeare&#39;s Romeo and Juliet (1996), 1132 -&gt; Manon of the Spring (Manon des sources) (1986), 3043 -&gt; Meatballs 4 (1992), 3855 -&gt; Affair of Love, An (Une Liaison Pornographique) (1999), 949 -&gt; East of Eden (1955), 2745 -&gt; Mission, The (1986), 2571 -&gt; Matrix, The (1999), 3713 -&gt; Long Walk Home, The (1990), 2356 -&gt; Celebrity (1998), 542 -&gt; Son in Law (1993), 460 -&gt; Getting Even with Dad (1994), 157 -&gt; Canadian Bacon (1994), 2703 -&gt; Broken Vessels (1998), 1545 -&gt; Ponette (1996), 2420 -&gt; Karate Kid, The (1984), 1922 -&gt; Whatever (1998), 2691 -&gt; Legend of 1900, The (Leggenda del pianista sull&#39;oceano) (1998), 902 -&gt; Breakfast at Tiffany&#39;s (1961), 559 -&gt; Paris, France (1993), 3099 -&gt; Shampoo (1975), 2713 -&gt; Lake Placid (1999), 3517 -&gt; Bells, The (1926), 638 -&gt; Jack and Sarah (1995), 853 -&gt; Dingo (1992), 3840 -&gt; Pumpkinhead (1988), 1892 -&gt; Perfect Murder, A (1998), 3463 -&gt; Last Resort (1994), 1379 -&gt; Young Guns II (1990), 3374 -&gt; Daughters of the Dust (1992), 3385 -&gt; Volunteers (1985), 2857 -&gt; Yellow Submarine (1968), 2169 -&gt; Dead Man on Campus (1998), 2403 -&gt; First Blood (1982), 3638 -&gt; Moonraker (1979), 1087 -&gt; Madame Butterfly (1995), 1514 -&gt; Temptress Moon (Feng Yue) (1996), 189 -&gt; Reckless (1995), 20 -&gt; Money Train (1995), 1147 -&gt; When We Were Kings (1996), 1247 -&gt; Graduate, The (1967), 2049 -&gt; Happiest Millionaire, The (1967), 2552 -&gt; My Boyfriend&#39;s Back (1993), 1319 -&gt; Kids of Survival (1993), 1704 -&gt; Good Will Hunting (1997), 421 -&gt; Black Beauty (1994), 870 -&gt; Gone Fishin&#39; (1997), 1890 -&gt; Little Boy Blue (1997), 2767 -&gt; Illuminata (1998), 1479 -&gt; Saint, The (1997), 46 -&gt; How to Make an American Quilt (1995), 1609 -&gt; 187 (1997), 969 -&gt; African Queen, The (1951), 93 -&gt; Vampire in Brooklyn (1995), 2373 -&gt; Red Sonja (1985), 606 -&gt; Candyman: Farewell to the Flesh (1995), 1347 -&gt; Nightmare on Elm Street, A (1984), 1572 -&gt; Contempt (Le M�pris) (1963), 3919 -&gt; Hellraiser III: Hell on Earth (1992), 1013 -&gt; Parent Trap, The (1961), 3216 -&gt; Vampyros Lesbos (Las Vampiras) (1970), 284 -&gt; New York Cop (1996), 770 -&gt; Costa Brava (1946), 1741 -&gt; Midaq Alley (Callej�n de los milagros, El) (1995), 1398 -&gt; In Love and War (1996), 881 -&gt; First Kid (1996), 3084 -&gt; Home Page (1999), 416 -&gt; Bad Girls (1994), 1115 -&gt; Sleepover (1995), 2635 -&gt; Mummy&#39;s Curse, The (1944), 2929 -&gt; Reds (1981), 325 -&gt; National Lampoon&#39;s Senior Trip (1995), 3470 -&gt; Dersu Uzala (1974), 3312 -&gt; McCullochs, The (1975), 3902 -&gt; Goya in Bordeaux (Goya en Bodeos) (1999), 3657 -&gt; Pandora and the Flying Dutchman (1951), 1931 -&gt; Mutiny on the Bounty (1935), 152 -&gt; Addiction, The (1995), 1568 -&gt; MURDER and murder (1996), 3734 -&gt; Prince of the City (1981), 3014 -&gt; Bustin&#39; Loose (1981), 2520 -&gt; Airport (1970), 2730 -&gt; Barry Lyndon (1975), 228 -&gt; Destiny Turns on the Radio (1995), 3951 -&gt; Two Family House (2000), 2158 -&gt; Henry: Portrait of a Serial Killer, Part 2 (1996), 2024 -&gt; Rapture, The (1991), 1641 -&gt; Full Monty, The (1997), 3835 -&gt; Crush, The (1993), 3708 -&gt; Firestarter (1984), 289 -&gt; Only You (1994), 1773 -&gt; Tokyo Fist (1995), 448 -&gt; Fearless (1993), 2301 -&gt; History of the World: Part I (1981), 1815 -&gt; Eden (1997), 1494 -&gt; Sixth Man, The (1997), 57 -&gt; Home for the Holidays (1995), 2989 -&gt; For Your Eyes Only (1981), 316 -&gt; Stargate (1994), 1362 -&gt; Garden of Finzi-Contini, The (Giardino dei Finzi-Contini, Il) (1970), 1963 -&gt; Take the Money and Run (1969), 3180 -&gt; Play it to the Bone (1999), 3602 -&gt; G. I. Blues (1960), 3557 -&gt; Jennifer 8 (1992), 78 -&gt; Crossing Guard, The (1995), 1875 -&gt; Clockwatchers (1997), 2852 -&gt; Soldier&#39;s Story, A (1984), 3231 -&gt; Saphead, The (1920), 2388 -&gt; Steam: The Turkish Bath (Hamam) (1997), 3866 -&gt; Sunset Strip (2000), 2533 -&gt; Escape from the Planet of the Apes (1971), 1100 -&gt; Days of Thunder (1990), 261 -&gt; Little Women (1994), 1232 -&gt; Stalker (1979), 3268 -&gt; Stop! Or My Mom Will Shoot (1992), 3258 -&gt; Death Becomes Her (1992), 1847 -&gt; Ratchet (1996), 29 -&gt; City of Lost Children, The (1995), 2829 -&gt; Muse, The (1999), 3788 -&gt; Blowup (1966), 2456 -&gt; Fly II, The (1989), 2007 -&gt; Polish Wedding (1998), 2178 -&gt; Frenzy (1972), 2222 -&gt; Champagne (1928), 216 -&gt; Billy Madison (1995), 1489 -&gt; Cats Don&#39;t Dance (1997), 2950 -&gt; Blue Lagoon, The (1980), 2237 -&gt; Without Limits (1998), 1415 -&gt; Thieves (Voleurs, Les) (1996), 475 -&gt; In the Name of the Father (1993), 924 -&gt; 2001: A Space Odyssey (1968), 3322 -&gt; 3 Strikes (2000), 2616 -&gt; Dick Tracy (1990), 1946 -&gt; Marty (1955), 492 -&gt; Manhattan Murder Mystery (1993), 164 -&gt; Devil in a Blue Dress (1995), 1465 -&gt; Rosewood (1997), 3524 -&gt; Arthur (1981), 3431 -&gt; Death Wish II (1982), 1302 -&gt; Field of Dreams (1989), 756 -&gt; Carmen Miranda: Bananas Is My Business (1994), 1664 -&gt; N�nette et Boni (1996), 2794 -&gt; European Vacation (1985), 3887 -&gt; Went to Coney Island on a Mission From God... Be Back by Five (1998), 2324 -&gt; Life Is Beautiful (La Vita � bella) (1997), 1714 -&gt; Never Met Picasso (1996), 2027 -&gt; Mafia! (1998), 3199 -&gt; Pal Joey (1957), 789 -&gt; I, Worst of All (Yo, la peor de todas) (1990), 3934 -&gt; Kronos (1957), 2105 -&gt; Tron (1982), 3075 -&gt; Repulsion (1965), 1811 -&gt; Niagara, Niagara (1997), 179 -&gt; Mad Love (1995), 1450 -&gt; Prisoner of the Mountains (Kavkazsky Plennik) (1996), 2090 -&gt; Rescuers, The (1977), 591 -&gt; Tough and Deadly (1995), 3393 -&gt; Date with an Angel (1987), 1373 -&gt; Star Trek V: The Final Frontier (1989), 2996 -&gt; Music of the Heart (1999), 443 -&gt; Endless Summer 2, The (1994), 3724 -&gt; Coming Home (1978), 1911 -&gt; Doctor Dolittle (1998), 3295 -&gt; Raining Stones (1993), 2782 -&gt; Pit and the Pendulum (1961), 1040 -&gt; Secret Agent, The (1996), 1109 -&gt; Charm&#39;s Incidents (1996), 2893 -&gt; Plunkett &amp; MaCleane (1999), 1632 -&gt; Smile Like Yours, A (1997), 321 -&gt; Strawberry and Chocolate (Fresa y chocolate) (1993), 2469 -&gt; Peggy Sue Got Married (1986), 3670 -&gt; Story of G.I. Joe, The (1945), 376 -&gt; River Wild, The (1994), 2259 -&gt; Blame It on Rio (1984), 3163 -&gt; Topsy-Turvy (1999), 2650 -&gt; Ghost of Frankenstein, The (1942), 3453 -&gt; Here on Earth (2000), 2451 -&gt; Gate, The (1987), 2236 -&gt; Simon Birch (1998), 623 -&gt; Modern Affair, A (1995), 1334 -&gt; Blob, The (1958), 211 -&gt; Browning Version, The (1994), 3527 -&gt; Predator (1987), 3473 -&gt; Jonah Who Will Be 25 in the Year 2000 (1976), 3702 -&gt; Mad Max (1979), 253 -&gt; Interview with the Vampire (1994), 2880 -&gt; Operation Condor 2 (Longxiong hudi) (1990), 1682 -&gt; Truman Show, The (1998), 485 -&gt; Last Action Hero (1993), 1136 -&gt; Monty Python and the Holy Grail (1974), 834 -&gt; Phat Beach (1996), 1858 -&gt; Mr. Nice Guy (1997), 3438 -&gt; Teenage Mutant Ninja Turtles (1990), 3525 -&gt; Bachelor Party (1984), 1864 -&gt; Sour Grapes (1998), 2122 -&gt; Children of the Corn (1984), 106 -&gt; Nobody Loves Me (Keiner liebt mich) (1994), 238 -&gt; Far From Home: The Adventures of Yellow Dog (1995), 3621 -&gt; Possession (1981), 2925 -&gt; Conformist, The (Il Conformista) (1970), 1978 -&gt; Friday the 13th Part V: A New Beginning (1985), 121 -&gt; Boys of St. Vincent, The (1993), 514 -&gt; Ref, The (1994), 1151 -&gt; Faust (1994), 937 -&gt; Love in the Afternoon (1957), 2291 -&gt; Edward Scissorhands (1990), 1383 -&gt; Adrenalin: Fear the Rush (1996), 1020 -&gt; Cool Runnings (1993), 348 -&gt; Bullets Over Broadway (1994), 3357 -&gt; East-West (Est-ouest) (1999), 574 -&gt; Spanking the Monkey (1994), 2254 -&gt; Choices (1981), 3569 -&gt; Idiots, The (Idioterne) (1998), 1677 -&gt; Critical Care (1997), 2540 -&gt; Corruptor, The (1999), 2034 -&gt; Black Hole, The (1979), 3923 -&gt; Return of the Fly (1959), 1960 -&gt; Last Emperor, The (1987), 2555 -&gt; Baby Geniuses (1999), 3290 -&gt; Soft Toilet Seats (1999), 806 -&gt; American Buffalo (1996), 84 -&gt; Last Summer in the Hamptons (1995), 3300 -&gt; Pitch Black (2000), 3093 -&gt; McCabe &amp; Mrs. Miller (1971), 1581 -&gt; Out to Sea (1997), 353 -&gt; Crow, The (1994), 2335 -&gt; Waterboy, The (1998), 966 -&gt; Walk in the Sun, A (1945), 2777 -&gt; Cobra (1925), 3152 -&gt; Last Picture Show, The (1971), 1183 -&gt; English Patient, The (1996), 1283 -&gt; High Noon (1952), 2073 -&gt; Fandango (1985), 1051 -&gt; Trees Lounge (1996), 3771 -&gt; Golden Voyage of Sinbad, The (1974), 821 -&gt; Crude Oasis, The (1995), 3851 -&gt; I&#39;m the One That I Want (2000), 2017 -&gt; Babes in Toyland (1961), 905 -&gt; It Happened One Night (1934), 480 -&gt; Jurassic Park (1993), 3389 -&gt; Let&#39;s Get Harry (1986), 602 -&gt; Great Day in Harlem, A (1994), 2508 -&gt; Breaks, The (1999), 981 -&gt; Dangerous Ground (1997), 766 -&gt; I Shot Andy Warhol (1996), 2964 -&gt; Julien Donkey-Boy (1999), 147 -&gt; Basketball Diaries, The (1995), 1843 -&gt; Slappy and the Stinkers (1998), 2058 -&gt; Negotiator, The (1998), 1169 -&gt; American Dream (1990), 397 -&gt; Fear, The (1995), 687 -&gt; Country Life (1994), 2367 -&gt; King Kong (1976), 2437 -&gt; Wilde (1997), 3537 -&gt; Where the Money Is (2000), 1928 -&gt; Cimarron (1931), 3068 -&gt; Verdict, The (1982), 1377 -&gt; Batman Returns (1992), 280 -&gt; Murder in the First (1995), 2618 -&gt; Castle, The (1997), 2833 -&gt; Lucie Aubrac (1997), 3189 -&gt; My Dog Skip (1999), 3739 -&gt; Trouble in Paradise (1932), 2281 -&gt; Monument Ave. (1998), 2861 -&gt; For Love of the Game (1999), 1215 -&gt; Army of Darkness (1993), 61 -&gt; Eye for an Eye (1996), 634 -&gt; Theodore Rex (1995), 1896 -&gt; Cousin Bette (1998), 877 -&gt; Girls Town (1996), 692 -&gt; Solo (1996), 2190 -&gt; Why Do Fools Fall In Love? (1998), 3421 -&gt; Animal House (1978), 734 -&gt; Getting Away With Murder (1996), 3712 -&gt; Soapdish (1991), 1447 -&gt; Gridlock&#39;d (1997), 2483 -&gt; Day of the Beast, The (El D�a de la bestia) (1995), 293 -&gt; Professional, The (a.k.a. Leon: The Professional) (1994), 956 -&gt; Penny Serenade (1941), 3505 -&gt; No Way Out (1987), 3685 -&gt; Prizzi&#39;s Honor (1985), 866 -&gt; Bound (1996), 1886 -&gt; I Got the Hook Up (1998), 3808 -&gt; Two Women (La Ciociara) (1961), 2523 -&gt; Rollercoaster (1977), 1796 -&gt; In God&#39;s Hands (1998), 3036 -&gt; Quest for Fire (1981), 2530 -&gt; Beneath the Planet of the Apes (1970), 453 -&gt; For Love or Money (1993), 1119 -&gt; Drunks (1997), 132 -&gt; Jade (1995), 1622 -&gt; Kicked in the Head (1997), 2424 -&gt; You&#39;ve Got Mail (1998), 774 -&gt; Wend Kuuni (God&#39;s Gift) (1982), 2371 -&gt; Fletch (1985), 2979 -&gt; Body Shots (1999), 1394 -&gt; Raising Arizona (1987), 2772 -&gt; Detroit Rock City (1999), 3157 -&gt; Stuart Little (1999), 396 -&gt; Fall Time (1995), 1526 -&gt; Fathers&#39; Day (1997), 3676 -&gt; Eraserhead (1977), 2137 -&gt; Charlotte&#39;s Web (1973), 89 -&gt; Nick of Time (1995), 1351 -&gt; Blood &amp; Wine (1997), 133 -&gt; Nueba Yol (1995), 660 -&gt; August (1996), 3361 -&gt; Bull Durham (1988), 2002 -&gt; Lethal Weapon 3 (1992), 998 -&gt; Set It Off (1996), 3756 -&gt; Golden Bowl, The (2000), 3243 -&gt; Encino Man (1992), 2809 -&gt; Love Stinks (1999), 2242 -&gt; Grandview, U.S.A. (1984), 411 -&gt; You So Crazy (1994), 1345 -&gt; Carrie (1976), 988 -&gt; Grace of My Heart (1996), 2799 -&gt; Problem Child 2 (1991), 2286 -&gt; Fiendish Plot of Dr. Fu Manchu, The (1980), 2639 -&gt; Mommie Dearest (1981), 3327 -&gt; Beyond the Mat (2000), 1433 -&gt; Machine, The (1994), 116 -&gt; Anne Frank Remembered (1995), 2103 -&gt; Tall Tale (1994), 2750 -&gt; Radio Days (1987), 243 -&gt; Gordy (1995), 1405 -&gt; Beavis and Butt-head Do America (1996), 3226 -&gt; Hellhounds on My Trail (1999), 1943 -&gt; Greatest Show on Earth, The (1952), 428 -&gt; Bronx Tale, A (1993), 1201 -&gt; Good, The Bad and The Ugly, The (1966), 2804 -&gt; Christmas Story, A (1983), 2965 -&gt; Omega Code, The (1999), 1 -&gt; Toy Story (1995), 1600 -&gt; She&#39;s So Lovely (1997), 3870 -&gt; Our Town (1940), 3588 -&gt; King of Marvin Gardens, The (1972), 1104 -&gt; Streetcar Named Desire, A (1951), 1697 -&gt; Big Bang Theory, The (1994), 1242 -&gt; Glory (1989), 265 -&gt; Like Water for Chocolate (Como agua para chocolate) (1992), 3559 -&gt; Limelight (1952), 849 -&gt; Escape from L.A. (1996), 3606 -&gt; On the Town (1949), 3211 -&gt; Cry in the Dark, A (1988), 2392 -&gt; Jack Frost (1998), 2154 -&gt; How Stella Got Her Groove Back (1998), 3906 -&gt; Under Suspicion (2000), 507 -&gt; Perfect World, A (1993), 527 -&gt; Schindler&#39;s List (1993), 312 -&gt; Stuart Saves His Family (1995), 74 -&gt; Bed of Roses (1996), 3492 -&gt; Son of the Sheik, The (1926), 2718 -&gt; Drop Dead Gorgeous (1999), 3406 -&gt; Captain Horatio Hornblower (1951), 2205 -&gt; Mr. &amp; Mrs. Smith (1941), 1696 -&gt; Bent (1997), 3184 -&gt; Montana (1998), 206 -&gt; Unzipped (1995), 2586 -&gt; Goodbye, Lover (1999), 2982 -&gt; Guardian, The (1990), 2884 -&gt; Dog Park (1998), 1975 -&gt; Friday the 13th Part 2 (1981), 3510 -&gt; Frequency (2000), 1564 -&gt; Roseanna&#39;s Grave (For Roseanna) (1997), 2762 -&gt; Sixth Sense, The (1999), 3378 -&gt; Ogre, The (Der Unhold) (1996), 1863 -&gt; Major League: Back to the Minors (1998), 3435 -&gt; Double Indemnity (1944), 2954 -&gt; Penitentiary (1979), 307 -&gt; Three Colors: Blue (1993), 1651 -&gt; Telling Lies in America (1997), 1604 -&gt; Money Talks (1997), 3899 -&gt; Circus (2000), 2922 -&gt; Hang &#39;em High (1967), 3151 -&gt; Bat Whispers, The (1930), 2011 -&gt; Back to the Future Part II (1989), 3097 -&gt; Shop Around the Corner, The (1940), 3582 -&gt; Jails, Hospitals &amp; Hip-Hop (2000), 292 -&gt; Outbreak (1995), 3229 -&gt; Another Man&#39;s Poison (1952), 3011 -&gt; They Shoot Horses, Don&#39;t They? (1969), 1206 -&gt; Clockwork Orange, A (1971), 233 -&gt; Exotica (1994), 452 -&gt; Widows&#39; Peak (1994), 6 -&gt; Heat (1995), 920 -&gt; Gone with the Wind (1939), 248 -&gt; Houseguest (1994), 3857 -&gt; Bless the Child (2000), 60 -&gt; Indian in the Cupboard, The (1995), 380 -&gt; True Lies (1994), 3450 -&gt; Grumpy Old Men (1993), 3503 -&gt; Solaris (Solyaris) (1972), 3459 -&gt; Gothic (1986), 117 -&gt; Young Poisoner&#39;s Handbook, The (1995), 512 -&gt; Robert A. Heinlein&#39;s The Puppet Masters (1994), 942 -&gt; Laura (1944), 439 -&gt; Dangerous Game (1993), 3591 -&gt; Mr. Mom (1983), 2910 -&gt; Ennui, L&#39; (1998), 3301 -&gt; Whole Nine Yards, The (2000), 2204 -&gt; Saboteur (1942), 3303 -&gt; Black Tar Heroin: The Dark End of the Street (1999), 678 -&gt; Some Folks Call It a Sling Blade (1993), 2473 -&gt; Soul Man (1986), 270 -&gt; Love Affair (1994), 529 -&gt; Searching for Bobby Fischer (1993), 3567 -&gt; Bossa Nova (1999), 2574 -&gt; Out-of-Towners, The (1999), 1438 -&gt; Dante&#39;s Peak (1997), 3720 -&gt; Sunshine (1999), 661 -&gt; James and the Giant Peach (1996), 546 -&gt; Super Mario Bros. (1993), 793 -&gt; My Life and Times With Antonin Artaud (En compagnie d&#39;Antonin Artaud) (1993), 3169 -&gt; Falcon and the Snowman, The (1984), 3265 -&gt; Hard-Boiled (Lashou shentan) (1992), 2646 -&gt; House of Dracula (1945), 925 -&gt; Golden Earrings (1947), 3852 -&gt; Tao of Steve, The (2000), 85 -&gt; Angels and Insects (1995), 1306 -&gt; Until the End of the World (Bis ans Ende der Welt) (1991), 201 -&gt; Three Wishes (1995), 3531 -&gt; All the Vermeers in New York (1990))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">check</span> <span class="n">the</span> <span class="n">size</span> <span class="n">of</span> <span class="n">the</span> <span class="n">small</span> <span class="n">dataset</span>

<span class="n">val</span> <span class="n">numRatings</span> <span class="o">=</span> <span class="n">ratingsRDD</span><span class="o">.</span><span class="n">count</span>
<span class="n">val</span> <span class="n">numUsers</span> <span class="o">=</span> <span class="n">ratingsRDD</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">user</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="o">.</span><span class="n">count</span>
<span class="n">val</span> <span class="n">numMovies</span> <span class="o">=</span> <span class="n">ratingsRDD</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">product</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="o">.</span><span class="n">count</span>

<span class="n">println</span><span class="p">(</span><span class="s2">&quot;Got &quot;</span> <span class="o">+</span> <span class="n">numRatings</span> <span class="o">+</span> <span class="s2">&quot; ratings from &quot;</span>
        <span class="o">+</span> <span class="n">numUsers</span> <span class="o">+</span> <span class="s2">&quot; users on &quot;</span> <span class="o">+</span> <span class="n">numMovies</span> <span class="o">+</span> <span class="s2">&quot; movies.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Got 487650 ratings from 2999 users on 3615 movies.
numRatings: Long = 487650
numUsers: Long = 2999
numMovies: Long = 3615
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">Creating</span> <span class="n">a</span> <span class="n">Training</span> <span class="n">Set</span><span class="p">,</span> <span class="n">test</span> <span class="n">Set</span> <span class="ow">and</span> <span class="n">Validation</span> <span class="n">Set</span>

<span class="n">val</span> <span class="n">Array</span><span class="p">(</span><span class="n">trainingRDD</span><span class="p">,</span> <span class="n">validationRDD</span><span class="p">,</span> <span class="n">testRDD</span><span class="p">)</span> <span class="o">=</span> <span class="n">ratingsRDD</span><span class="o">.</span><span class="n">randomSplit</span><span class="p">(</span><span class="n">Array</span><span class="p">(</span><span class="mf">0.60</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">),</span> <span class="mi">0</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>trainingRDD: org.apache.spark.rdd.RDD[org.apache.spark.mllib.recommendation.Rating] = MapPartitionsRDD[21741] at randomSplit at command-3389902380791584:3
validationRDD: org.apache.spark.rdd.RDD[org.apache.spark.mllib.recommendation.Rating] = MapPartitionsRDD[21742] at randomSplit at command-3389902380791584:3
testRDD: org.apache.spark.rdd.RDD[org.apache.spark.mllib.recommendation.Rating] = MapPartitionsRDD[21743] at randomSplit at command-3389902380791584:3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">let</span><span class="s1">&#39;s find the exact sizes we have next</span>
<span class="n">println</span><span class="p">(</span><span class="s2">&quot; training data size = &quot;</span> <span class="o">+</span> <span class="n">trainingRDD</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">+</span>
        <span class="s2">&quot;, validation data size = &quot;</span> <span class="o">+</span> <span class="n">validationRDD</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">+</span>
        <span class="s2">&quot;, test data size = &quot;</span> <span class="o">+</span> <span class="n">testRDD</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> training data size = 292318, validation data size = 97175, test data size = 98157.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ratings-distribution">
<h2>Ratings distribution<a class="headerlink" href="#ratings-distribution" title="Permalink to this headline">¶</a></h2>
<p>For curiosity, we start by plotting the histogram of the ratings present
in this dataset</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">Create</span> <span class="n">a</span> <span class="n">DataFrame</span> <span class="k">with</span> <span class="n">the</span> <span class="n">data</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.sql.functions._</span>

<span class="n">val</span> <span class="n">ratingsDF</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s2">&quot;/databricks-datasets/cs100/lab4/data-001/ratings.dat.gz&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">line</span> <span class="o">=&gt;</span>
      <span class="n">val</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">)</span>
      <span class="o">//</span> <span class="nb">format</span><span class="p">:</span> <span class="p">(</span><span class="n">timestamp</span> <span class="o">%</span> <span class="mi">10</span><span class="p">,</span> <span class="n">Rating</span><span class="p">(</span><span class="n">userId</span><span class="p">,</span> <span class="n">movieId</span><span class="p">,</span> <span class="n">rating</span><span class="p">))</span>
      <span class="p">(</span><span class="n">fields</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">toInt</span><span class="p">,</span> <span class="n">fields</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">toInt</span><span class="p">,</span> <span class="n">fields</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">toDouble</span><span class="p">)</span>
    <span class="p">}</span><span class="o">.</span><span class="n">toDF</span><span class="p">(</span><span class="s2">&quot;userID&quot;</span><span class="p">,</span> <span class="s2">&quot;movieID&quot;</span><span class="p">,</span> <span class="s2">&quot;rating&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">ratingsDF</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead>
<tr class="header">
<th>userID</th>
<th>movieID</th>
<th>rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1.0</td>
<td>1193.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>661.0</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td>1.0</td>
<td>914.0</td>
<td>3.0</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>3408.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>1.0</td>
<td>2355.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>1197.0</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td>1.0</td>
<td>1287.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>2804.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td>1.0</td>
<td>594.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>919.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>...</td>
<td></td>
<td></td>
</tr>
</tbody>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="n">val</span> <span class="n">history</span> <span class="o">=</span> <span class="n">ratingsDF</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">&quot;rating&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="n">asc</span><span class="p">(</span><span class="s2">&quot;rating&quot;</span><span class="p">))</span>
<span class="n">history</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+------+------+
|rating| count|
+------+------+
|   1.0| 27472|
|   2.0| 53838|
|   3.0|127216|
|   4.0|170579|
|   5.0|108545|
+------+------+

history: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [rating: double, count: bigint]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="n">display</span><span class="p">(</span><span class="n">history</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead>
<tr class="header">
<th>rating</th>
<th>count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1.0</td>
<td>27472.0</td>
</tr>
<tr class="even">
<td>2.0</td>
<td>53838.0</td>
</tr>
<tr class="odd">
<td>3.0</td>
<td>127216.0</td>
</tr>
<tr class="even">
<td>4.0</td>
<td>170579.0</td>
</tr>
<tr class="odd">
<td>5.0</td>
<td>108545.0</td>
</tr>
</tbody>
</table></div></div>
</div>
</div>
<div class="section" id="create-a-system-that-takes-user-info-and-outputs-suggestions">
<h2>Create a system that takes user info and outputs suggestions.<a class="headerlink" href="#create-a-system-that-takes-user-info-and-outputs-suggestions" title="Permalink to this headline">¶</a></h2>
<p>user info = ((movieID,rating),(movieID,rating)). It is basically an
(incomplete) line in the ratings matrix.</p>
<ul class="simple">
<li><p>Choose an user</p></li>
<li><p>Run the model and fill the columns - predict the ratings for the
movies</p></li>
<li><p>Output the ones with the best predicted score</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">Train</span> <span class="n">the</span> <span class="n">model</span> <span class="k">as</span> <span class="n">usually</span>
  <span class="n">val</span> <span class="n">rank</span> <span class="o">=</span> <span class="mi">4</span>
  <span class="n">val</span> <span class="n">numIterations</span> <span class="o">=</span> <span class="mi">10</span>
  <span class="n">val</span> <span class="n">regularizationParameter</span> <span class="o">=</span> <span class="mf">0.01</span>
  <span class="n">val</span> <span class="n">model</span> <span class="o">=</span> <span class="n">ALS</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">trainingRDD</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">numIterations</span><span class="p">,</span> <span class="n">regularizationParameter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>rank: Int = 4
numIterations: Int = 10
regularizationParameter: Double = 0.01
model: org.apache.spark.mllib.recommendation.MatrixFactorizationModel = org.apache.spark.mllib.recommendation.MatrixFactorizationModel@570cf4b3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">Choose</span> <span class="nb">any</span> <span class="n">random</span> <span class="n">user</span><span class="p">,</span><span class="n">which</span> <span class="ow">is</span> <span class="n">going</span> <span class="n">to</span> <span class="n">be</span> <span class="n">our</span> <span class="n">test</span> <span class="n">user</span>
<span class="n">val</span> <span class="n">newUserID</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="o">//</span> <span class="n">Create</span> <span class="n">a</span> <span class="nb">list</span> <span class="k">with</span> <span class="n">the</span> <span class="n">MovieIds</span> <span class="n">we</span> <span class="n">want</span> <span class="n">to</span> <span class="n">predict</span> <span class="n">its</span> <span class="n">rating</span> <span class="n">to</span>
<span class="n">val</span> <span class="n">newUser</span> <span class="o">=</span> <span class="n">Array</span><span class="p">(</span><span class="n">Rating</span><span class="p">(</span><span class="n">newUserID</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span><span class="n">Rating</span><span class="p">(</span><span class="n">newUserID</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span><span class="n">Rating</span><span class="p">(</span><span class="n">newUserID</span><span class="o">.</span><span class="n">toInt</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span><span class="n">Rating</span><span class="p">(</span><span class="n">newUserID</span><span class="o">.</span><span class="n">toInt</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span><span class="n">Rating</span><span class="p">(</span><span class="n">newUserID</span><span class="o">.</span><span class="n">toInt</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">newUser</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">println</span><span class="p">)</span>

<span class="o">//</span> <span class="n">Convert</span> <span class="n">it</span> <span class="n">to</span> <span class="n">an</span> <span class="n">RDD</span>
<span class="n">val</span> <span class="n">newTest</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">newUser</span><span class="p">)</span>
<span class="n">newTest</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">println</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rating(1000,1,0.0)
Rating(1000,2,0.0)
Rating(1000,3,0.0)
Rating(1000,4,0.0)
Rating(1000,5,0.0)
newUserID: Int = 1000
newUser: Array[org.apache.spark.mllib.recommendation.Rating] = Array(Rating(1000,1,0.0), Rating(1000,2,0.0), Rating(1000,3,0.0), Rating(1000,4,0.0), Rating(1000,5,0.0))
newTest: org.apache.spark.rdd.RDD[org.apache.spark.mllib.recommendation.Rating] = ParallelCollectionRDD[21968] at parallelize at command-3389902380791591:9
res94: org.apache.spark.rdd.RDD[Unit] = MapPartitionsRDD[21969] at map at command-3389902380791591:10
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
  <span class="o">//</span> <span class="n">Evaluate</span> <span class="n">the</span> <span class="n">model</span> <span class="n">on</span> <span class="n">this</span> <span class="n">test</span> <span class="n">user</span>
  <span class="n">val</span> <span class="n">usersProductsTest</span> <span class="o">=</span> <span class="n">newTest</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="n">Rating</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">rate</span><span class="p">)</span> <span class="o">=&gt;</span>
                                              <span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">product</span><span class="p">)</span>
  <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>usersProductsTest: org.apache.spark.rdd.RDD[(Int, Int)] = MapPartitionsRDD[21970] at map at command-3389902380791592:2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
  <span class="o">//</span> <span class="n">get</span> <span class="n">the</span> <span class="n">predictions</span> <span class="k">for</span> <span class="n">this</span> <span class="n">test</span> <span class="n">user</span>
  <span class="n">val</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">usersProductsTest</span><span class="p">)</span>
                         <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="n">Rating</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">rate</span><span class="p">)</span>
                                     <span class="o">=&gt;</span> <span class="p">((</span><span class="n">user</span><span class="p">,</span> <span class="n">product</span><span class="p">),</span> <span class="n">rate</span><span class="p">)</span>
    <span class="p">}</span>

  <span class="n">val</span> <span class="n">ratesAndPreds</span> <span class="o">=</span> <span class="n">newTest</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="n">Rating</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">rate</span><span class="p">)</span> 
                                     <span class="o">=&gt;</span> <span class="p">((</span><span class="n">user</span><span class="p">,</span> <span class="n">product</span><span class="p">),</span> <span class="n">rate</span><span class="p">)</span>
                                   <span class="p">}</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predictions: org.apache.spark.rdd.RDD[((Int, Int), Double)] = MapPartitionsRDD[21979] at map at command-3389902380791593:3
ratesAndPreds: org.apache.spark.rdd.RDD[((Int, Int), (Double, Double))] = MapPartitionsRDD[21983] at join at command-3389902380791593:9
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">Convert</span> <span class="n">the</span> <span class="n">RDD</span> <span class="k">with</span> <span class="n">the</span> <span class="n">predictions</span> <span class="n">to</span> <span class="n">a</span> <span class="n">DataFrame</span>
<span class="n">val</span> <span class="n">preds2</span> <span class="o">=</span> <span class="n">ratesAndPreds</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="p">((</span><span class="n">user</span><span class="p">,</span> <span class="n">product</span><span class="p">),</span> <span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">))</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="n">user</span><span class="p">,</span><span class="n">product</span><span class="p">,</span><span class="n">r2</span><span class="p">)</span> <span class="p">}</span>

<span class="n">var</span> <span class="n">predsDF</span> <span class="o">=</span> <span class="n">preds2</span><span class="o">.</span><span class="n">toDF</span><span class="p">(</span><span class="s2">&quot;userID&quot;</span><span class="p">,</span><span class="s2">&quot;movieID&quot;</span><span class="p">,</span><span class="s2">&quot;pred&quot;</span><span class="p">)</span>


<span class="n">predsDF</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="n">asc</span><span class="p">(</span><span class="s2">&quot;movieID&quot;</span><span class="p">))</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+------+-------+------------------+
|userID|movieID|              pred|
+------+-------+------------------+
|  1000|      1|4.3134486083287396|
|  1000|      2| 3.561695001470941|
|  1000|      3| 3.251747295342854|
|  1000|      4|2.9727526635707116|
|  1000|      5|3.1890542732727987|
+------+-------+------------------+

preds2: org.apache.spark.rdd.RDD[(Int, Int, Double)] = MapPartitionsRDD[21984] at map at command-3389902380791594:2
predsDF: org.apache.spark.sql.DataFrame = [userID: int, movieID: int ... 1 more field]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">Order</span> <span class="n">the</span> <span class="n">movies</span> <span class="n">according</span> <span class="n">to</span> <span class="n">the</span> <span class="n">predictions</span>
<span class="n">val</span> <span class="n">orderedPreds</span> <span class="o">=</span> <span class="n">predsDF</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="s2">&quot;pred&quot;</span><span class="p">))</span>
<span class="n">orderedPreds</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+------+-------+------------------+
|userID|movieID|              pred|
+------+-------+------------------+
|  1000|      1|4.3134486083287396|
|  1000|      2| 3.561695001470941|
|  1000|      3| 3.251747295342854|
|  1000|      5|3.1890542732727987|
|  1000|      4|2.9727526635707116|
+------+-------+------------------+

orderedPreds: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userID: int, movieID: int ... 1 more field]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">Return</span> <span class="n">the</span> <span class="n">ID</span> <span class="n">of</span> <span class="n">the</span> <span class="n">highest</span> <span class="n">recommended</span> <span class="n">one</span>

<span class="n">val</span> <span class="n">t</span> <span class="o">=</span> <span class="n">orderedPreds</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;movieID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">toList</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">println</span><span class="p">(</span><span class="s2">&quot;The movie highest recommended for this user is:&quot;</span><span class="p">)</span>
<span class="n">println</span><span class="p">(</span><span class="n">movies</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">asInstanceOf</span><span class="p">[</span><span class="n">Int</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The movie highest recommended for this user is:
Toy Story (1995)
t: List[Any] = List(1)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="for-first-time-users-the-program-gives-the-top-rated-movies-over-all-users">
<h2>For first time users, the program gives the top rated movies over all users.<a class="headerlink" href="#for-first-time-users-the-program-gives-the-top-rated-movies-over-all-users" title="Permalink to this headline">¶</a></h2>
<p>If newUser: - Check the ratings matrix - Compute the average rating of
each column (of each movie) - Return the columns with the highest</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">Note</span><span class="p">:</span> <span class="n">This</span> <span class="ow">is</span> <span class="n">only</span> <span class="k">for</span> <span class="n">the</span> <span class="n">ones</span> <span class="n">they</span> <span class="n">said</span><span class="o">.</span> <span class="n">Doesnt</span> <span class="n">include</span> <span class="n">the</span> <span class="n">ones</span> <span class="n">computed</span> <span class="n">by</span> <span class="n">our</span> <span class="n">model</span><span class="o">...</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.sql.functions._</span>

<span class="n">val</span> <span class="n">newUserID</span> <span class="o">=</span> <span class="mi">4000</span>

<span class="o">//</span> <span class="n">Compute</span> <span class="n">the</span> <span class="n">average</span> <span class="n">of</span> <span class="n">each</span> <span class="n">movie</span>
<span class="n">val</span> <span class="n">averageRates</span> <span class="o">=</span> <span class="n">ratingsDF</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">&quot;movieID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s2">&quot;rating&quot;</span><span class="p">)</span>
<span class="n">averageRates</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------+------------------+
|movieID|       avg(rating)|
+-------+------------------+
|   1580|3.7045454545454546|
|   2366|           3.71875|
|   1088|  3.29595015576324|
|   1959|3.6577181208053693|
|   3175|3.8145454545454545|
|   1645| 3.367021276595745|
|    496|3.3846153846153846|
|   2142|2.8256880733944953|
|   1591|2.5783132530120483|
|   2122|2.3434343434343434|
|    833| 2.130434782608696|
|    463|2.7222222222222223|
|    471| 3.665492957746479|
|   1342|2.8188976377952755|
|    148| 2.857142857142857|
|   3918| 2.806896551724138|
|   3794|               3.4|
|   1238|3.9526627218934913|
|   2866|3.7386363636363638|
|   3749|               4.0|
+-------+------------------+
only showing top 20 rows

import org.apache.spark.sql.functions._
newUserID: Int = 4000
averageRates: org.apache.spark.sql.DataFrame = [movieID: int, avg(rating): double]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">Order</span> <span class="n">the</span> <span class="n">movies</span> <span class="n">by</span> <span class="n">top</span> <span class="n">ratings</span>
<span class="n">val</span> <span class="n">orderedRates</span> <span class="o">=</span> <span class="n">averageRates</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="s2">&quot;avg(rating)&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;avg(rating)&quot;</span><span class="p">,</span><span class="s2">&quot;avg_rate&quot;</span><span class="p">)</span>
<span class="n">orderedRates</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------+-----------------+
|movieID|         avg_rate|
+-------+-----------------+
|    854|              5.0|
|    853|              5.0|
|    787|              5.0|
|   1830|              5.0|
|   3881|              5.0|
|    557|              5.0|
|   3280|              5.0|
|    578|              5.0|
|   2444|              5.0|
|   3636|              5.0|
|   3443|              5.0|
|   3800|              5.0|
|    989|              5.0|
|   1002|4.666666666666667|
|   3232|4.666666666666667|
|   2839|4.666666666666667|
|   3245|4.666666666666667|
|   2905|4.609756097560975|
|   1743|              4.6|
|   2019|4.586330935251799|
+-------+-----------------+
only showing top 20 rows

orderedRates: org.apache.spark.sql.DataFrame = [movieID: int, avg_rate: double]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">Return</span> <span class="n">the</span> <span class="n">top</span> <span class="mi">5</span> <span class="n">movies</span> <span class="k">with</span> <span class="n">highest</span> <span class="n">ratings</span> <span class="n">over</span> <span class="nb">all</span> <span class="n">users</span>

<span class="n">val</span> <span class="n">topMovies</span> <span class="o">=</span> <span class="n">orderedRates</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="o">//</span><span class="n">println</span><span class="p">(</span><span class="n">topMovies</span><span class="p">)</span>
<span class="o">//</span><span class="n">topMovies</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">t</span> <span class="o">=&gt;</span> <span class="n">println</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
<span class="n">val</span> <span class="n">moviesList</span> <span class="o">=</span> <span class="n">orderedRates</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;movieID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">toList</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="o">//</span><span class="n">println</span><span class="p">(</span><span class="n">moviesList</span><span class="p">)</span>

<span class="n">println</span><span class="p">(</span><span class="s2">&quot;The movies recommended for a new user based on the overall rating are:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;-</span>  <span class="n">moviesList</span> <span class="p">)</span>
    <span class="n">println</span><span class="p">(</span><span class="n">movies</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">asInstanceOf</span><span class="p">[</span><span class="n">Int</span><span class="p">]))</span>
 <span class="o">//</span> <span class="n">println</span><span class="p">(</span><span class="n">movies</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The movies recommended for a new user based on the overall rating are:
Dingo (1992)
Gate of Heavenly Peace, The (1995)
Hour of the Pig, The (1993)
Those Who Love Me Can Take the Train (Ceux qui m&#39;aiment prendront le train) (1998)
Schlafes Bruder (Brother of Sleep) (1995)
topMovies: Array[org.apache.spark.sql.Row] = Array([989,5.0], [787,5.0], [853,5.0], [578,5.0], [3636,5.0])
moviesList: List[Any] = List(853, 787, 578, 3636, 989)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">In</span> <span class="n">alternative</span><span class="p">,</span> <span class="k">return</span> <span class="n">the</span> <span class="n">top</span> <span class="n">movies</span> <span class="k">with</span> <span class="n">rating</span> <span class="n">of</span> <span class="mi">5</span> <span class="n">over</span> <span class="nb">all</span> <span class="n">users</span>

<span class="n">val</span> <span class="n">topMovies5</span> <span class="o">=</span> <span class="n">orderedRates</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;avg_rate == 5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;movieID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">toList</span>

<span class="n">println</span><span class="p">(</span><span class="s2">&quot;The movies recommended for a new user based on the overall rating are:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;-</span>  <span class="n">topMovies5</span> <span class="p">)</span>
    <span class="n">println</span><span class="p">(</span><span class="n">movies</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">asInstanceOf</span><span class="p">[</span><span class="n">Int</span><span class="p">]))</span>
 <span class="o">//</span> <span class="n">println</span><span class="p">(</span><span class="n">movies</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The movies recommended for a new user based on the overall rating are:
Dingo (1992)
Gate of Heavenly Peace, The (1995)
Hour of the Pig, The (1993)
Those Who Love Me Can Take the Train (Ceux qui m&#39;aiment prendront le train) (1998)
Schlafes Bruder (Brother of Sleep) (1995)
Ballad of Narayama, The (Narayama Bushiko) (1958)
Baby, The (1973)
24 7: Twenty Four Seven (1997)
Born American (1986)
Criminal Lovers (Les Amants Criminels) (1999)
Follow the Bitch (1998)
Bittersweet Motel (2000)
Mamma Roma (1962)
topMovies5: List[Any] = List(853, 787, 578, 3636, 989, 854, 3280, 2444, 3443, 3800, 1830, 3881, 557)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="genres-analysis">
<h2>Genres analysis<a class="headerlink" href="#genres-analysis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="we-investigate-whether-suggestion-based-on-genre-can-be-more-accurate-imagine-a-scenario-in-which-an-user-is-interested-in-watching-a-movie-of-a-particular-genre-say-an-animation-movie-given-this-information-can-we-suggest-a-better-film-with-respect-to-the-film-that-we-would-have-suggested-by-only-knowing-users-previous-ratings-on-such-movie">
<h3>we investigate whether suggestion based on genre can be more accurate. Imagine a scenario in which an user is interested in watching a movie of a particular genre, say an Animation movie, given this information, can we suggest a better film with respect to the film that we would have suggested by only knowing user’s previous ratings on such movie?<a class="headerlink" href="#we-investigate-whether-suggestion-based-on-genre-can-be-more-accurate-imagine-a-scenario-in-which-an-user-is-interested-in-watching-a-movie-of-a-particular-genre-say-an-animation-movie-given-this-information-can-we-suggest-a-better-film-with-respect-to-the-film-that-we-would-have-suggested-by-only-knowing-users-previous-ratings-on-such-movie" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">Read</span> <span class="n">the</span> <span class="n">movies</span> <span class="n">file</span> <span class="k">as</span> <span class="n">a</span> <span class="n">dataframe</span> <span class="ow">and</span> <span class="n">display</span> <span class="n">it</span>
<span class="n">val</span> <span class="n">movies_df</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s2">&quot;/databricks-datasets/cs100/lab4/data-001/movies.dat&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">line</span> <span class="o">=&gt;</span>
      <span class="n">val</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">)</span>
      <span class="o">//</span> <span class="nb">format</span><span class="p">:</span> <span class="p">(</span><span class="n">movieId</span><span class="p">,</span> <span class="n">movieName</span><span class="p">,</span><span class="n">genre</span><span class="p">)</span>
      <span class="p">(</span><span class="n">fields</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">toInt</span><span class="p">,</span> <span class="n">fields</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">fields</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">|&quot;</span><span class="p">))</span>
    <span class="p">}</span><span class="o">.</span><span class="n">toDF</span><span class="p">(</span><span class="s2">&quot;movieId&quot;</span><span class="p">,</span> <span class="s2">&quot;movieName&quot;</span><span class="p">,</span> <span class="s2">&quot;genre&quot;</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">movies_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>%%scala
// Select a GENRE, or a set of GENREs and filter the movies dataset according to this genre
val GENRE = &quot;Animation&quot;

def array_contains_any(s:Seq[String]): UserDefinedFunction = {
udf((c: WrappedArray[String]) =&gt;
  c.toList.intersect(s).nonEmpty)}

val b: Array[String] = Array(GENRE)
val genre_df = movies_df.where(array_contains_any(b)($&quot;genre&quot;))
display(genre_df)

val movie_ID_genres = genre_df.select(&quot;movieId&quot;).rdd.map(r =&gt; r(0)).collect()
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">We</span> <span class="n">now</span> <span class="n">read</span> <span class="ow">and</span> <span class="n">display</span> <span class="n">the</span> <span class="n">ratings</span> <span class="n">dataframe</span> <span class="p">(</span><span class="n">without</span> <span class="n">the</span> <span class="n">timestamp</span> <span class="n">field</span><span class="p">)</span> <span class="k">as</span> <span class="n">a</span> <span class="n">dataframe</span><span class="o">.</span>
<span class="n">val</span> <span class="n">RatingsDF</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s2">&quot;/databricks-datasets/cs100/lab4/data-001/ratings.dat.gz&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">line</span> <span class="o">=&gt;</span>
      <span class="n">val</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;::&quot;</span><span class="p">)</span>
      <span class="o">//</span> <span class="nb">format</span><span class="p">:</span> <span class="p">(</span><span class="n">timestamp</span> <span class="o">%</span> <span class="mi">10</span><span class="p">,</span> <span class="n">Rating</span><span class="p">(</span><span class="n">userId</span><span class="p">,</span> <span class="n">movieId</span><span class="p">,</span> <span class="n">rating</span><span class="p">))</span>
      <span class="p">(</span><span class="n">fields</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">toInt</span><span class="p">,</span> <span class="n">fields</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">toInt</span><span class="p">,</span> <span class="n">fields</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">toDouble</span><span class="p">)</span>
    <span class="p">}</span><span class="o">.</span><span class="n">toDF</span><span class="p">(</span><span class="s2">&quot;userId&quot;</span><span class="p">,</span> <span class="s2">&quot;movieId&quot;</span><span class="p">,</span> <span class="s2">&quot;rating&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">RatingsDF</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead>
<tr class="header">
<th>userId</th>
<th>movieId</th>
<th>rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1.0</td>
<td>1193.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>661.0</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td>1.0</td>
<td>914.0</td>
<td>3.0</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>3408.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>1.0</td>
<td>2355.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>1197.0</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td>1.0</td>
<td>1287.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>2804.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td>1.0</td>
<td>594.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>919.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>...</td>
<td></td>
<td></td>
</tr>
</tbody>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>%%scala
// Based on the movies id obtained by the filtering on the movie dataset we filter the ratings df and we convert it to rdd format
val Ratings_genre_df = RatingsDF.filter($&quot;movieId&quot;.isin(movie_ID_genres:_*))
val genre_rdd = Ratings_genre_df.rdd
display(Ratings_genre_df)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead>
<tr class="header">
<th>userId</th>
<th>movieId</th>
<th>rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1.0</td>
<td>661.0</td>
<td>3.0</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>2355.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td>1.0</td>
<td>594.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>595.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td>1.0</td>
<td>2687.0</td>
<td>3.0</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>2018.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>1.0</td>
<td>720.0</td>
<td>3.0</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>48.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td>1.0</td>
<td>745.0</td>
<td>3.0</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>2294.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>...</td>
<td></td>
<td></td>
</tr>
</tbody>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">Print</span> <span class="n">some</span> <span class="n">dataset</span> <span class="n">statistics</span>
<span class="n">val</span> <span class="n">numRatings</span> <span class="o">=</span> <span class="n">genre_rdd</span><span class="o">.</span><span class="n">count</span>
<span class="n">println</span><span class="p">(</span><span class="s2">&quot;Got &quot;</span> <span class="o">+</span> <span class="n">numRatings</span> <span class="o">+</span> <span class="s2">&quot; ratings&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Got 22080 ratings
numRatings: Long = 22080
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">Create</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="ow">and</span> <span class="n">evaluation</span> <span class="n">dataset</span> <span class="ow">and</span> <span class="nb">print</span> <span class="n">some</span> <span class="n">statistics</span> 
<span class="n">val</span> <span class="n">Array</span><span class="p">(</span><span class="n">temp_trainingRDD</span><span class="p">,</span> <span class="n">temp_validationRDD</span><span class="p">,</span> <span class="n">temp_testRDD</span><span class="p">)</span> <span class="o">=</span> <span class="n">genre_rdd</span><span class="o">.</span><span class="n">randomSplit</span><span class="p">(</span><span class="n">Array</span><span class="p">(</span><span class="mf">0.60</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">),</span> <span class="mi">0</span><span class="n">L</span><span class="p">)</span>

<span class="o">//</span> <span class="n">let</span><span class="s1">&#39;s find the exact sizes we have next</span>
<span class="n">println</span><span class="p">(</span><span class="s2">&quot;training data size = &quot;</span> <span class="o">+</span> <span class="n">temp_trainingRDD</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">+</span>
        <span class="s2">&quot;, validation data size = &quot;</span> <span class="o">+</span> <span class="n">temp_validationRDD</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">+</span>
        <span class="s2">&quot;, test data size = &quot;</span> <span class="o">+</span> <span class="n">temp_testRDD</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>training data size = 13229, validation data size = 4411, test data size = 4440.
temp_trainingRDD: org.apache.spark.rdd.RDD[org.apache.spark.sql.Row] = MapPartitionsRDD[19929] at randomSplit at command-3389902380791621:2
temp_validationRDD: org.apache.spark.rdd.RDD[org.apache.spark.sql.Row] = MapPartitionsRDD[19930] at randomSplit at command-3389902380791621:2
temp_testRDD: org.apache.spark.rdd.RDD[org.apache.spark.sql.Row] = MapPartitionsRDD[19931] at randomSplit at command-3389902380791621:2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">Map</span> <span class="n">the</span> <span class="n">rdds</span> <span class="n">to</span> <span class="n">the</span> <span class="n">Rating</span> <span class="nb">type</span>
<span class="n">val</span> <span class="n">maptrainingRDD</span> <span class="o">=</span> <span class="n">temp_trainingRDD</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">x</span><span class="o">=&gt;</span><span class="n">Rating</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">asInstanceOf</span><span class="p">[</span><span class="n">Int</span><span class="p">],</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">asInstanceOf</span><span class="p">[</span><span class="n">Int</span><span class="p">],</span> <span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">asInstanceOf</span><span class="p">[</span><span class="n">Double</span><span class="p">]))</span>
<span class="n">val</span> <span class="n">mapvalidationRDD</span> <span class="o">=</span> <span class="n">temp_validationRDD</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">x</span><span class="o">=&gt;</span><span class="n">Rating</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">asInstanceOf</span><span class="p">[</span><span class="n">Int</span><span class="p">],</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">asInstanceOf</span><span class="p">[</span><span class="n">Int</span><span class="p">],</span> <span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">asInstanceOf</span><span class="p">[</span><span class="n">Double</span><span class="p">]))</span>
<span class="n">val</span> <span class="n">maptestRDD</span> <span class="o">=</span> <span class="n">temp_testRDD</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">x</span><span class="o">=&gt;</span><span class="n">Rating</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">asInstanceOf</span><span class="p">[</span><span class="n">Int</span><span class="p">],</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">asInstanceOf</span><span class="p">[</span><span class="n">Int</span><span class="p">],</span> <span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">asInstanceOf</span><span class="p">[</span><span class="n">Double</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>maptrainingRDD: org.apache.spark.rdd.RDD[org.apache.spark.mllib.recommendation.Rating] = MapPartitionsRDD[19932] at map at command-3389902380791624:2
mapvalidationRDD: org.apache.spark.rdd.RDD[org.apache.spark.mllib.recommendation.Rating] = MapPartitionsRDD[19933] at map at command-3389902380791624:3
maptestRDD: org.apache.spark.rdd.RDD[org.apache.spark.mllib.recommendation.Rating] = MapPartitionsRDD[19934] at map at command-3389902380791624:4
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">scala</span>
<span class="o">//</span> <span class="n">Build</span> <span class="n">the</span> <span class="n">recommendation</span> <span class="n">model</span> <span class="n">using</span> <span class="n">ALS</span> <span class="n">by</span> <span class="n">fitting</span> <span class="n">to</span> <span class="n">the</span> <span class="n">training</span> <span class="n">data</span> <span class="p">(</span><span class="k">with</span> <span class="n">Hyperparameter</span> <span class="n">tuning</span><span class="p">)</span>
<span class="o">//</span> <span class="n">trying</span> <span class="n">different</span> <span class="n">hyper</span><span class="o">-</span><span class="n">parameter</span> <span class="p">(</span><span class="n">rank</span><span class="p">)</span> <span class="n">values</span> <span class="n">to</span> <span class="n">optimise</span> <span class="n">over</span>
<span class="n">val</span> <span class="n">ranks</span> <span class="o">=</span> <span class="n">List</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">);</span> 
<span class="n">var</span> <span class="n">rank</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="k">for</span> <span class="p">(</span> <span class="n">rank</span> <span class="o">&lt;-</span> <span class="n">ranks</span> <span class="p">){</span>
  <span class="o">//</span> <span class="n">using</span> <span class="n">a</span> <span class="n">fixed</span> <span class="n">numIterations</span><span class="o">=</span><span class="mi">10</span> <span class="ow">and</span> <span class="n">regularisation</span><span class="o">=</span><span class="mf">0.01</span>
  <span class="n">val</span> <span class="n">numIterations</span> <span class="o">=</span> <span class="mi">10</span>
  <span class="n">val</span> <span class="n">regularizationParameter</span> <span class="o">=</span> <span class="mf">0.01</span>
  <span class="n">val</span> <span class="n">model</span> <span class="o">=</span> <span class="n">ALS</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">maptrainingRDD</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">numIterations</span><span class="p">,</span> <span class="n">regularizationParameter</span><span class="p">)</span>

  <span class="o">//</span> <span class="n">Evaluate</span> <span class="n">the</span> <span class="n">model</span> <span class="n">on</span> <span class="n">test</span> <span class="n">data</span>
  <span class="n">val</span> <span class="n">usersProductsValidate</span> <span class="o">=</span> <span class="n">mapvalidationRDD</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="n">Rating</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">rate</span><span class="p">)</span> <span class="o">=&gt;</span>
                                              <span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">product</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="o">//</span> <span class="n">get</span> <span class="n">the</span> <span class="n">predictions</span> <span class="n">on</span> <span class="n">test</span> <span class="n">data</span>
  <span class="n">val</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">usersProductsValidate</span><span class="p">)</span>
                         <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="n">Rating</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">rate</span><span class="p">)</span>
                                     <span class="o">=&gt;</span> <span class="p">((</span><span class="n">user</span><span class="p">,</span> <span class="n">product</span><span class="p">),</span> <span class="n">rate</span><span class="p">)</span>
    <span class="p">}</span>

  <span class="o">//</span> <span class="n">find</span> <span class="n">the</span> <span class="n">actual</span> <span class="n">ratings</span> <span class="ow">and</span> <span class="n">join</span> <span class="k">with</span> <span class="n">predictions</span>
  <span class="n">val</span> <span class="n">ratesAndPreds</span> <span class="o">=</span> <span class="n">mapvalidationRDD</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="n">Rating</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">rate</span><span class="p">)</span> 
                                     <span class="o">=&gt;</span> <span class="p">((</span><span class="n">user</span><span class="p">,</span> <span class="n">product</span><span class="p">),</span> <span class="n">rate</span><span class="p">)</span>
                                   <span class="p">}</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
  

  <span class="n">val</span> <span class="n">MSE</span> <span class="o">=</span> <span class="n">ratesAndPreds</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="p">((</span><span class="n">user</span><span class="p">,</span> <span class="n">product</span><span class="p">),</span> <span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">))</span> <span class="o">=&gt;</span>
    <span class="n">val</span> <span class="n">err</span> <span class="o">=</span> <span class="p">(</span><span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span><span class="p">)</span>
    <span class="n">err</span> <span class="o">*</span> <span class="n">err</span>
  <span class="p">}</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
  <span class="n">println</span><span class="p">(</span><span class="s2">&quot;rank and Mean Squared Error = &quot;</span> <span class="o">+</span>  <span class="n">rank</span> <span class="o">+</span> <span class="s2">&quot; and &quot;</span> <span class="o">+</span> <span class="n">MSE</span><span class="p">)</span>
<span class="p">}</span> <span class="o">//</span> <span class="n">end</span> <span class="n">of</span> <span class="n">loop</span> <span class="n">over</span> <span class="n">ranks</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>rank and Mean Squared Error = 2 and 1.0624116959469154
rank and Mean Squared Error = 4 and 1.3393495403657538
rank and Mean Squared Error = 8 and 1.6916511125697133
rank and Mean Squared Error = 16 and 1.63542207107039
rank and Mean Squared Error = 32 and 1.311227268934932
rank and Mean Squared Error = 64 and 0.9461947532838
rank and Mean Squared Error = 128 and 0.8859420827613572
rank and Mean Squared Error = 256 and 0.8845268169033572
numIterations: Int = 10
regularisation: Double = 0.01
ranks: List[Int] = List(2, 4, 8, 16, 32, 64, 128, 256)
rank: Int = 0
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./000_0-sds-3-x-projects/student-project-18_group-ProjectRL"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="01_The_ALS_method.html" title="previous page"><span class="xref myst">The Alternating Least Squares method (ALS)</span></a>
    <a class='right-next' id="next-link" href="../student-project-19_group-Featuring/01_FundamentalMatrix.html" title="next page">Fundamental Matrix</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By ScaDaMaLe Team<br/>
        
            &copy; Copyright 2020 Creative Commons Zero v1.0 Universal.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>