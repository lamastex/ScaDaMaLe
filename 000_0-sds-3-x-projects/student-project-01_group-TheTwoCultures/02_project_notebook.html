
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flashback and Familjeliv: The two Cultures &#8212; Scalable Data Science &amp; Distributed Machine Learning</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Scalable Data Science & Distributed Machine Learning</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/000_ScaDaMaLe.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction to Apache Spark Core
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/001_whySpark.html">
   Why Apache Spark?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html">
   databricks community edition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#essentials-of-databricks-cloud-dbc-in-a-big-hurry">
   Essentials of Databricks Cloud (DBC) in a Big Hurry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-what-is-databricks-cloud">
   DBC Essentials: What is Databricks Cloud?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-shard-cluster-notebook-and-dashboard">
   DBC Essentials: Shard, Cluster, Notebook and Dashboard
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#dbc-essentials-team-state-collaboration-elastic-resources">
   DBC Essentials: Team, State, Collaboration, Elastic Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#you-should-all-have-databricks-community-edition-account-by-now">
   You Should All Have databricks community edition account by now!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#import-course-content-now">
   Import Course Content Now!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_00_loginToDatabricks.html#cloud-free-computing-environment-optional-but-recommended">
   Cloud-free Computing Environment (Optional but recommended)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_01_multiLingualNotebooks.html">
   Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/002_01_multiLingualNotebooks.html#further-reference-homework-recurrrent-points-of-reference">
   Further Reference / Homework / Recurrrent Points of Reference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html">
   Introduction to Scala through Scala Notebook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-in-your-own-computer">
   Scala in your own computer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-resources">
   Scala Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#introduction-to-scala">
   Introduction to Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#let-s-get-our-hands-dirty-in-scala">
   Letâ€™s get our hands dirty in Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#scala-types">
   Scala Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#expressions">
   Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#blocks">
   Blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#functions">
   Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#methods">
   Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#classes">
   Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#case-classes">
   Case Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#objects">
   Objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#traits">
   Traits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#main-method">
   Main Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_00_scalaCrashCourse.html#what-i-try-not-do-while-learning-a-new-language">
   What I try not do while learning a new language?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html">
   Scala Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#let-s-continue-to-get-our-hands-dirty-in-scala">
   Letâ€™s continue to get our hands dirty in Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#scala-type-hierarchy">
   Scala Type Hierarchy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#scala-collections">
   Scala Collections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#exercise-in-functional-programming">
   Exercise in Functional Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#lazy-evaluation">
   Lazy Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/003_01_scalaCrashCourse.html#recursions">
   Recursions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/004_RDDsTransformationsActions.html">
   Introduction to Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/004_RDDsTransformationsActions.html#spark-cluster-overview">
   Spark Cluster Overview:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/005_RDDsTransformationsActionsHOMEWORK.html">
   HOMEWORK notebook - RDDs Transformations and Actions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html">
   Piped RDDs and Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#from-a-local-collection">
   From a Local Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#glom">
   glom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#checkpointing">
   Checkpointing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#pipe-rdds-to-system-commands">
   Pipe RDDs to System Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#mappartitions">
   mapPartitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#foreachpartition">
   foreachPartition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#numerically-rigorous-bayesian-ab-testing">
   Numerically Rigorous Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006a_PipedRDD.html#usage-instructions-for-isit1or2coins">
   Usage instructions for IsIt1or2Coins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/006_WordCount.html">
   Word Count on US State of the Union (SoU) Addresses
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction to Apache Spark SQL
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html">
   Introduction to Spark SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#overview">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#datasets-and-dataframes">
   Datasets and DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007_SparkSQLIntroBasics.html#getting-started-in-spark-2-x">
   Getting Started in Spark 2.x
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007a_SparkSQLProgGuide_HW.html">
   Spark Sql Programming Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html#id1">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007c_SparkSQLProgGuide_HW.html">
   Getting Started - Exercise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html#id1">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007e_SparkSQLProgGuide_HW.html">
   Performance Tuning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html">
   Distributed SQL Engine
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html#id1">
   Distributed SQL Engine
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#sql-pivoting-since-spark-2-4">
   SQL Pivoting since Spark 2.4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#load-data">
   Load Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-in-sql">
   Pivoting in SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-aggregate-expressions">
   Pivoting with Multiple Aggregate Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-grouping-columns">
   Pivoting with Multiple Grouping Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/007g_PivotInSQL.html#pivoting-with-multiple-pivot-columns">
   Pivoting with Multiple Pivot Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html">
   Diamonds ML Pipeline Workflow - DataFrame ETL and EDA Part
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#step-1-load-data-as-dataframe">
   Step 1. Load data as DataFrame
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#step-2-understand-the-data">
   Step 2. Understand the data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#let-us-run-through-some-basic-inteactive-sql-queries-next">
   Let us run through some basic inteactive SQL queries next
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#why-do-we-need-to-know-these-interactive-sql-queries">
   Why do we need to know these interactive SQL queries?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html#we-will-continue-later-with-ml-pipelines-to-do-prediction-with-a-fitted-model-from-this-dataset">
   We will continue later with ML pipelines to do prediction with a fitted model from this dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html">
   Power Plant ML Pipeline Application - DataFrame Part
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-1-business-understanding">
   Step 1: Business Understanding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-2-load-your-data">
   Step 2: Load Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#use-this-for-other-smallish-datasets-you-want-to-import-to-your-ce">
   USE THIS FOR OTHER SMALLish DataSets you want to import to your CE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-3-explore-your-data">
   Step 3: Explore Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html#step-4-visualize-your-data">
   Step 4: Visualize Your Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html">
   Wiki Clickstream Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html#wikipedia-logo">
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_LoadExtract.html">
   Old Bailey Online Data Analysis in Apache Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_LoadExtract.html#analysing-the-full-old-bailey-online-sessions-papers-dataset">
   Analysing the Full Old Bailey Online Sessions Papers Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html">
   Piped RDDs and Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#from-a-local-collection">
   From a Local Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#glom">
   glom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#checkpointing">
   Checkpointing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#pipe-rdds-to-system-commands">
   Pipe RDDs to System Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#mappartitions">
   mapPartitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#foreachpartition">
   foreachPartition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#numerically-rigorous-bayesian-ab-testing">
   Numerically Rigorous Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#usage-instructions-for-isit1or2coins">
   Usage instructions for IsIt1or2Coins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#parsing-the-output-from-isit1or2coins">
   Parsing the output from
   <code class="docutils literal notranslate">
    <span class="pre">
     IsIt1or2Coins
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html#providing-case-classes-for-input-and-output-for-easy-spark-communication">
   Providing case classes for input and output for easy spark communication
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/035_LDA_CornellMovieDialogs.html">
   Topic Modeling of Movie Dialogs with Latent Dirichlet Allocation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Distribute Deep Learning with Horovod
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_7-sds-3-x-ddl/00_DDL_Introduction.html">
   Introduction to Distributed Deep Learning (DDL) with Horovod over Tensorflow/keras and Pytorch
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_7-sds-3-x-ddl/0x_mnist-tensorflow-keras.html">
   Distributed deep learning training using TensorFlow and Keras with HorovodRunner
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_7-sds-3-x-ddl/0y_mnist-pytorch.html">
   Distributed deep learning training using PyTorch with HorovodRunner for MNIST
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  WASP AI-Track Student Projects
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/035_LDA_CornellMovieDialogs.html">
   Topic Modeling of Movie Dialogs with Latent Dirichlet Allocation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Voluntary Student Projects
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/030_Spark_GDELT_project.html">
   Plugging into GDELT Streams - TODO - IN PROGRESS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/030_Spark_GDELT_project.html#this-is-just-dipping-our-pinky-toe-in-this-ocean-of-information">
   This is just dipping our pinky toe in this ocean of information!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../000_1-sds-3-x/030_Spark_GDELT_project.html#download-from-gdelt-project">
   Download from gdelt-project
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/000_0-sds-3-x-projects/student-project-01_group-TheTwoCultures/02_project_notebook.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://lamastex.github.io/ScaDaMaLe/index.html"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://lamastex.github.io/ScaDaMaLe/index.html/issues/new?title=Issue%20on%20page%20%2F000_0-sds-3-x-projects/student-project-01_group-TheTwoCultures/02_project_notebook.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="flashback-and-familjeliv-the-two-cultures">
<h1>Flashback and Familjeliv: The two Cultures<a class="headerlink" href="#flashback-and-familjeliv-the-two-cultures" title="Permalink to this headline">Â¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="o">%</span><span class="n">run</span> <span class="o">/</span><span class="n">scalable</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">science</span><span class="o">/</span><span class="mi">000_0</span><span class="o">-</span><span class="n">sds</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="n">projects</span><span class="o">/</span><span class="n">student</span><span class="o">-</span><span class="n">project</span><span class="o">-</span><span class="mi">01</span><span class="n">_group</span><span class="o">-</span><span class="n">TheTwoCultures</span><span class="o">/</span><span class="mi">00</span><span class="n">_download_data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">scalable</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">science</span><span class="o">/</span><span class="mi">000_0</span><span class="o">-</span><span class="n">sds</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="n">projects</span><span class="o">/</span><span class="n">student</span><span class="o">-</span><span class="n">project</span><span class="o">-</span><span class="mi">01</span><span class="n">_group</span><span class="o">-</span><span class="n">TheTwoCultures</span><span class="o">/</span><span class="mi">01</span><span class="n">_load_data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s2">&quot;dbfs:/datasets/student-project-01/familjeliv&quot;</span><span class="p">))</span> 
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s2">&quot;dbfs:/datasets/student-project-01/flashback&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import org.apache.spark.sql.functions.{col, concat_ws, udf, flatten, explode, collect_list, collect_set, lit}
import org.apache.spark.sql.types.{ArrayType, StructType, StructField, StringType, IntegerType}
import com.databricks.spark.xml._
import org.apache.spark.sql.functions._
read_xml: (file_name: String)org.apache.spark.sql.DataFrame
get_dataset: (file_name: String)org.apache.spark.sql.DataFrame
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">tmp_df</span> <span class="o">=</span> <span class="n">read_xml</span><span class="p">(</span><span class="s2">&quot;dbfs:/datasets/student-project-01/familjeliv/familjeliv-sexsamlevnad.xml&quot;</span><span class="p">)</span>
<span class="n">tmp_df</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>root
 |-- _id: string (nullable = false)
 |-- _title: string (nullable = false)
 |-- _url: string (nullable = false)
 |-- thread: array (nullable = false)
 |    |-- element: struct (containsNull = true)
 |    |    |-- _id: string (nullable = false)
 |    |    |-- _title: string (nullable = false)
 |    |    |-- _url: string (nullable = false)
 |    |    |-- text: struct (nullable = false)
 |    |    |    |-- sentence: array (nullable = false)
 |    |    |    |    |-- element: struct (containsNull = true)
 |    |    |    |    |    |-- w: array (nullable = true)
 |    |    |    |    |    |    |-- element: string (containsNull = true)

tmp_df: org.apache.spark.sql.DataFrame = [_id: string, _title: string ... 2 more fields]
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;dbfs:/datasets/student-project-01/familjeliv/familjeliv-sexsamlevnad.xml&quot;</span>
<span class="n">val</span> <span class="n">df</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
<span class="n">val</span> <span class="n">file_name2</span> <span class="o">=</span> <span class="s2">&quot;dbfs:/datasets/student-project-01/flashback/flashback-sex.xml&quot;</span>
<span class="n">val</span> <span class="n">df2</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">file_name2</span><span class="p">)</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>file_name: String = dbfs:/datasets/student-project-01/familjeliv/familjeliv-sexsamlevnad.xml
df: org.apache.spark.sql.DataFrame = [thread_id: string, thread_title: string ... 5 more fields]
file_name2: String = dbfs:/datasets/student-project-01/flashback/flashback-sex.xml
df2: org.apache.spark.sql.DataFrame = [thread_id: string, thread_title: string ... 5 more fields]
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>root
 |-- thread_id: string (nullable = true)
 |-- thread_title: string (nullable = true)
 |-- w: string (nullable = false)
 |-- forum_id: string (nullable = true)
 |-- forum_title: string (nullable = true)
 |-- platform: string (nullable = false)
 |-- corpus_id: string (nullable = false)
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">df</span><span class="o">.</span><span class="n">count</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>res42: Long = 7813
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.apache.spark.sql.functions.countDistinct</span>
<span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">countDistinct</span><span class="p">(</span><span class="s2">&quot;thread_id&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.apache.spark.sql.types.</span><span class="p">{</span> <span class="n">LongType</span> <span class="p">}</span>
<span class="n">val</span> <span class="n">df_test</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;thread_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;thread_id&quot;</span><span class="p">,</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;thread_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">LongType</span><span class="p">))</span><span class="o">//.</span><span class="n">limit</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">//</span><span class="n">take</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">toDF</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import org.apache.spark.sql.types.LongType
df_test: org.apache.spark.sql.DataFrame = [w: string, thread_id: bigint]
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.apache.spark.ml.feature.RegexTokenizer</span>

<span class="n">val</span> <span class="n">tokenizer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">RegexTokenizer</span><span class="p">()</span>
  <span class="o">.</span><span class="n">setPattern</span><span class="p">(</span><span class="s2">&quot;(?U)[</span><span class="se">\\</span><span class="s2">W_]+&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="k">break</span> <span class="n">by</span> <span class="n">white</span> <span class="n">space</span> <span class="n">character</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  <span class="o">-</span> <span class="k">try</span> <span class="n">to</span> <span class="n">remove</span> <span class="n">emails</span> <span class="ow">and</span> <span class="n">other</span> <span class="n">patterns</span>
  <span class="o">.</span><span class="n">setMinTokenLength</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">//</span> <span class="n">Filter</span> <span class="n">away</span> <span class="n">tokens</span> <span class="k">with</span> <span class="n">length</span> <span class="o">&lt;</span> <span class="mi">4</span>
  <span class="o">.</span><span class="n">setInputCol</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">input</span> <span class="n">column</span>
  <span class="o">.</span><span class="n">setOutputCol</span><span class="p">(</span><span class="s2">&quot;tokens&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">output</span> <span class="n">column</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import org.apache.spark.ml.feature.RegexTokenizer
tokenizer: org.apache.spark.ml.feature.RegexTokenizer = RegexTokenizer: uid=regexTok_8dfb36da5645, minTokenLength=3, gaps=true, pattern=(?U)[\W_]+, toLowercase=true
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_test</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>root
 |-- w: string (nullable = false)
 |-- thread_id: long (nullable = true)
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">test_token</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>test_token: org.apache.spark.sql.DataFrame = [w: string, thread_id: bigint ... 1 more field]
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">peterdalle</span><span class="o">/</span><span class="n">svensktext</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">stoppord</span><span class="o">/</span><span class="n">stoppord</span><span class="o">.</span><span class="n">csv</span>

</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>--2020-12-21 10:41:06--  https://raw.githubusercontent.com/peterdalle/svensktext/master/stoppord/stoppord.csv
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.52.133
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.52.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1936 (1.9K) [text/plain]
Saving to: â€˜stoppord.csvâ€™

     0K .                                                     100% 15.6M=0s

2020-12-21 10:41:06 (15.6 MB/s) - â€˜stoppord.csvâ€™ saved [1936/1936]
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="s2">&quot;file:/databricks/driver/stoppord.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;dbfs:/datasets/student-project-01/stoppord.csv&quot;</span><span class="p">)</span>
 
<span class="n">val</span> <span class="n">stoppord</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s2">&quot;dbfs:/datasets/student-project-01/stoppord.csv&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stoppord: Array[String] = Array(word, all, alla, allas, allt, alltsÃ¥, andra, andras, annan, annat, artonde, artonn, att, av, bakom, bara, bland, blev, bli, blir, blivit, bÃ¥da, bÃ¥das, bÃ¥de, dag, dagar, dagarna, dagen, de, del, delen, dem, den, denna, deras, dess, dessa, det, detta, dig, din, dina, dit, ditt, dock, dom, du, dÃ¤r, dÃ¤rfÃ¶r, dÃ¥, efter, eftersom, ej, elfte, eller, elva, en, er, era, ert, ett, fall, fanns, fast, fem, femte, femtio, femtionde, femton, femtonde, fick, fin, finnas, finns, fjorton, fjortonde, fjÃ¤rde, fler, flera, flesta, fram, framfÃ¶r, frÃ¥n, fyra, fyrtio, fyrtionde, fÃ¥, fÃ¥r, fÃ¥tt, fÃ¶r, fÃ¶re, fÃ¶rra, fÃ¶rsta, ge, genom, ger, gick, gjorde, gjort, gÃ¤lla, gÃ¤ller, gÃ¤llt, gÃ¤rna, gÃ¥, gÃ¥ng, gÃ¥r, gÃ¥tt, gÃ¶r, gÃ¶ra, ha, hade, haft, han, hans, har, hela, heller, hellre, helst, helt, henne, hennes, heter, hit, hjÃ¤lp, hon, honom, hundra, hundraen, hundraett, hur, hÃ¤r, i, ibland, icke, igen, in, infÃ¶r, inga, ingen, inget, innan, inne, inom, inte, inuti, ja, jag, ju, jÃ¤mfÃ¶rt, kan, kom, komma, kommer, kommit, kunde, kunna, kunnat, kvar, kÃ¶r, legat, ligga, ligger, lÃ¤gga, man, med, mellan, men, menar, mer, mera, mig, min, mina, mitt, mittemot, mot, ned, nederst, nedersta, nedre, nej, ner, ni, nio, nionde, nittio, nittionde, nitton, nittonde, nog, noll, nr, nu, nummer, nya, nÃ¤r, nÃ¤sta, nÃ¥gon, nÃ¥gonting, nÃ¥got, nÃ¥gra, nÃ¥n, nÃ¥t, och, ocksÃ¥, om, oss, pÃ¥, rakt, redan, sade, sagt, samt, sedan, sen, ser, sex, sextio, sextionde, sexton, sextonde, sig, sin, sina, sist, sista, siste, sitt, sitta, sju, sjunde, sjuttio, sjuttionde, sjutton, sjuttonde, sjÃ¤lv, sjÃ¤tte, ska, skall, skriver, skulle, slutligen, snart, som, stÃ¥r, sÃ¤ga, sÃ¤ger, sÃ¤tt, sÃ¥, sÃ¥dan, sÃ¥dana, sÃ¥dant, ta, tack, tar, till, tills, tio, tionde, tjugo, tjugoen, tjugoett, tjugonde, tjugotre, tjugotvÃ¥, tjungo, tog, tolfte, tolv, tre, tredje, trettio, trettionde, tretton, trettonde, tro, tror, tvÃ¥, tvÃ¥hundra, under, upp, ur, ut, utan, utanfÃ¶r, ute, vad, var, vara, varfÃ¶r, varifrÃ¥n, varit, varje, varken, vars, varsÃ¥god, vart, vem, vems, verkligen, vet, vi, vid, vidare, vilka, vilkas, vilken, vilket, vill, visst, vÃ¤l, vÃ¤rre, vÃ¥r, vÃ¥ra, vÃ¥rt, Ã¤n, Ã¤ndÃ¥, Ã¤nnu, Ã¤r, Ã¤ven, Ã¥ret, Ã¥t, Ã¥tminstone, Ã¥tta, Ã¥ttio, Ã¥ttionde, Ã¥ttonde, Ã¶ver, Ã¶vre)
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">stopwordList</span> <span class="o">=</span> <span class="n">Array</span><span class="p">(</span><span class="s2">&quot;bara&quot;</span><span class="p">,</span><span class="s2">&quot;lite&quot;</span><span class="p">,</span><span class="s2">&quot;finns&quot;</span><span class="p">,</span><span class="s2">&quot;vill&quot;</span><span class="p">,</span><span class="s2">&quot;samt&quot;</span><span class="p">,</span><span class="s2">&quot;inga&quot;</span><span class="p">,</span><span class="s2">&quot;Ã¤ven&quot;</span><span class="p">,</span><span class="s2">&quot;finns&quot;</span><span class="p">,</span><span class="s2">&quot;ganska&quot;</span><span class="p">,</span><span class="s2">&quot;ocksÃ¥&quot;</span><span class="p">,</span><span class="s2">&quot;igen&quot;</span><span class="p">,</span><span class="s2">&quot;just&quot;</span><span class="p">,</span><span class="s2">&quot;that&quot;</span><span class="p">,</span><span class="s2">&quot;with&quot;</span><span class="p">,</span><span class="s2">&quot;http&quot;</span><span class="p">,</span><span class="s2">&quot;jpg&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">stoppord</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stopwordList: Array[String] = Array(bara, lite, finns, vill, samt, inga, Ã¤ven, finns, ganska, ocksÃ¥, igen, just, that, with, http, jpg, word, all, alla, allas, allt, alltsÃ¥, andra, andras, annan, annat, artonde, artonn, att, av, bakom, bara, bland, blev, bli, blir, blivit, bÃ¥da, bÃ¥das, bÃ¥de, dag, dagar, dagarna, dagen, de, del, delen, dem, den, denna, deras, dess, dessa, det, detta, dig, din, dina, dit, ditt, dock, dom, du, dÃ¤r, dÃ¤rfÃ¶r, dÃ¥, efter, eftersom, ej, elfte, eller, elva, en, er, era, ert, ett, fall, fanns, fast, fem, femte, femtio, femtionde, femton, femtonde, fick, fin, finnas, finns, fjorton, fjortonde, fjÃ¤rde, fler, flera, flesta, fram, framfÃ¶r, frÃ¥n, fyra, fyrtio, fyrtionde, fÃ¥, fÃ¥r, fÃ¥tt, fÃ¶r, fÃ¶re, fÃ¶rra, fÃ¶rsta, ge, genom, ger, gick, gjorde, gjort, gÃ¤lla, gÃ¤ller, gÃ¤llt, gÃ¤rna, gÃ¥, gÃ¥ng, gÃ¥r, gÃ¥tt, gÃ¶r, gÃ¶ra, ha, hade, haft, han, hans, har, hela, heller, hellre, helst, helt, henne, hennes, heter, hit, hjÃ¤lp, hon, honom, hundra, hundraen, hundraett, hur, hÃ¤r, i, ibland, icke, igen, in, infÃ¶r, inga, ingen, inget, innan, inne, inom, inte, inuti, ja, jag, ju, jÃ¤mfÃ¶rt, kan, kom, komma, kommer, kommit, kunde, kunna, kunnat, kvar, kÃ¶r, legat, ligga, ligger, lÃ¤gga, man, med, mellan, men, menar, mer, mera, mig, min, mina, mitt, mittemot, mot, ned, nederst, nedersta, nedre, nej, ner, ni, nio, nionde, nittio, nittionde, nitton, nittonde, nog, noll, nr, nu, nummer, nya, nÃ¤r, nÃ¤sta, nÃ¥gon, nÃ¥gonting, nÃ¥got, nÃ¥gra, nÃ¥n, nÃ¥t, och, ocksÃ¥, om, oss, pÃ¥, rakt, redan, sade, sagt, samt, sedan, sen, ser, sex, sextio, sextionde, sexton, sextonde, sig, sin, sina, sist, sista, siste, sitt, sitta, sju, sjunde, sjuttio, sjuttionde, sjutton, sjuttonde, sjÃ¤lv, sjÃ¤tte, ska, skall, skriver, skulle, slutligen, snart, som, stÃ¥r, sÃ¤ga, sÃ¤ger, sÃ¤tt, sÃ¥, sÃ¥dan, sÃ¥dana, sÃ¥dant, ta, tack, tar, till, tills, tio, tionde, tjugo, tjugoen, tjugoett, tjugonde, tjugotre, tjugotvÃ¥, tjungo, tog, tolfte, tolv, tre, tredje, trettio, trettionde, tretton, trettonde, tro, tror, tvÃ¥, tvÃ¥hundra, under, upp, ur, ut, utan, utanfÃ¶r, ute, vad, var, vara, varfÃ¶r, varifrÃ¥n, varit, varje, varken, vars, varsÃ¥god, vart, vem, vems, verkligen, vet, vi, vid, vidare, vilka, vilkas, vilken, vilket, vill, visst, vÃ¤l, vÃ¤rre, vÃ¥r, vÃ¥ra, vÃ¥rt, Ã¤n, Ã¤ndÃ¥, Ã¤nnu, Ã¤r, Ã¤ven, Ã¥ret, Ã¥t, Ã¥tminstone, Ã¥tta, Ã¥ttio, Ã¥ttionde, Ã¥ttonde, Ã¶ver, Ã¶vre)
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.apache.spark.ml.feature.StopWordsRemover</span>


<span class="n">val</span> <span class="n">remover</span> <span class="o">=</span> <span class="n">new</span> <span class="n">StopWordsRemover</span><span class="p">()</span>
  <span class="o">.</span><span class="n">setStopWords</span><span class="p">(</span><span class="n">stopwordList</span><span class="p">)</span>
  <span class="o">.</span><span class="n">setInputCol</span><span class="p">(</span><span class="s2">&quot;tokens&quot;</span><span class="p">)</span>
  <span class="o">.</span><span class="n">setOutputCol</span><span class="p">(</span><span class="s2">&quot;filtered&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import org.apache.spark.ml.feature.StopWordsRemover
remover: org.apache.spark.ml.feature.StopWordsRemover = StopWordsRemover: uid=stopWords_fd37fe28b783, numStopWords=346, locale=en, caseSensitive=false
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">test_stop</span> <span class="o">=</span> <span class="n">remover</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_token</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;thread_id&quot;</span><span class="p">,</span><span class="s2">&quot;filtered&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>test_stop: org.apache.spark.sql.DataFrame = [thread_id: bigint, filtered: array&lt;string&gt;]
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test_stop</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>root
 |-- thread_id: long (nullable = true)
 |-- filtered: array (nullable = true)
 |    |-- element: string (containsNull = true)
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">test_stop</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">false</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.apache.spark.ml.feature.CountVectorizer</span>

<span class="n">val</span> <span class="n">vectorizer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CountVectorizer</span><span class="p">()</span>
  <span class="o">.</span><span class="n">setInputCol</span><span class="p">(</span><span class="s2">&quot;filtered&quot;</span><span class="p">)</span>
  <span class="o">.</span><span class="n">setOutputCol</span><span class="p">(</span><span class="s2">&quot;features&quot;</span><span class="p">)</span>
  <span class="o">.</span><span class="n">setVocabSize</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span> <span class="o">//</span> <span class="n">Size</span> <span class="n">of</span> <span class="n">dictonary</span>
  <span class="o">.</span><span class="n">setMinDF</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">//</span> <span class="n">the</span> <span class="n">minimum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">different</span> <span class="n">documents</span> <span class="n">a</span> <span class="n">term</span> <span class="n">must</span> <span class="n">appear</span> <span class="ow">in</span> <span class="n">to</span> <span class="n">be</span> <span class="n">included</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">vocabulary</span><span class="o">.</span>
  <span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">test_stop</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import org.apache.spark.ml.feature.CountVectorizer
vectorizer: org.apache.spark.ml.feature.CountVectorizerModel = CountVectorizerModel: uid=cntVec_70dec58904b4, vocabularySize=10000
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">countVectors</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_stop</span><span class="p">)</span><span class="o">//.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;thread_id&quot;</span><span class="p">,</span> <span class="s2">&quot;features&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>countVectors: org.apache.spark.sql.DataFrame = [thread_id: bigint, filtered: array&lt;string&gt; ... 1 more field]
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">display</span><span class="p">(</span><span class="n">countVectors</span><span class="p">)</span><span class="o">//.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">false</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">countVectors</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">false</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">countVectors</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_stop</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;thread_id&quot;</span><span class="p">,</span> <span class="s2">&quot;features&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>countVectors: org.apache.spark.sql.DataFrame = [thread_id: bigint, features: vector]
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Convert</span> <span class="n">DF</span> <span class="n">to</span> <span class="n">RDD</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.ml.linalg.Vector</span>

<span class="n">val</span> <span class="n">lda_countVector</span> <span class="o">=</span> <span class="n">countVectors</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="n">Row</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="n">Long</span><span class="p">,</span> <span class="n">countVector</span><span class="p">:</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">countVector</span><span class="p">)</span> <span class="p">}</span>

<span class="n">val</span> <span class="n">numTopics</span> <span class="o">=</span> <span class="mi">9</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import org.apache.spark.ml.linalg.Vector
lda_countVector: org.apache.spark.sql.Dataset[(Long, org.apache.spark.ml.linalg.Vector)] = [_1: bigint, _2: vector]
numTopics: Int = 9
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.apache.spark.mllib.clustering.</span><span class="p">{</span><span class="n">LDA</span><span class="p">,</span> <span class="n">OnlineLDAOptimizer</span><span class="p">}</span>

<span class="o">//</span> <span class="n">Set</span> <span class="n">LDA</span> <span class="n">params</span>
<span class="n">val</span> <span class="n">lda</span> <span class="o">=</span> <span class="n">new</span> <span class="n">LDA</span><span class="p">()</span>
<span class="o">.</span><span class="n">setOptimizer</span><span class="p">(</span><span class="n">new</span> <span class="n">OnlineLDAOptimizer</span><span class="p">()</span><span class="o">.</span><span class="n">setMiniBatchFraction</span><span class="p">(</span><span class="mf">0.8</span><span class="p">))</span>
<span class="o">.</span><span class="n">setK</span><span class="p">(</span><span class="n">numTopics</span><span class="p">)</span>
<span class="o">.</span><span class="n">setMaxIterations</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="o">.</span><span class="n">setDocConcentration</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">use</span> <span class="n">default</span> <span class="n">values</span>
<span class="o">.</span><span class="n">setTopicConcentration</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">use</span> <span class="n">default</span> <span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import org.apache.spark.mllib.clustering.{LDA, OnlineLDAOptimizer}
lda: org.apache.spark.mllib.clustering.LDA = org.apache.spark.mllib.clustering.LDA@3294220d
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">lda_countVector_mllib</span> <span class="o">=</span> <span class="n">lda_countVector</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">vector</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">mllib</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">Vectors</span><span class="o">.</span><span class="n">fromML</span><span class="p">(</span><span class="n">vector</span><span class="p">))</span> <span class="p">}</span><span class="o">.</span><span class="n">rdd</span>

<span class="n">val</span> <span class="n">ldaModel</span> <span class="o">=</span> <span class="n">lda</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">lda_countVector_mllib</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>lda_countVector_mllib: org.apache.spark.rdd.RDD[(Long, org.apache.spark.mllib.linalg.Vector)] = MapPartitionsRDD[15748] at rdd at command-4443336225071772:1
ldaModel: org.apache.spark.mllib.clustering.LDAModel = org.apache.spark.mllib.clustering.LocalLDAModel@2af3bf
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">topicIndices</span> <span class="o">=</span> <span class="n">ldaModel</span><span class="o">.</span><span class="n">describeTopics</span><span class="p">(</span><span class="n">maxTermsPerTopic</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>topicIndices: Array[(Array[Int], Array[Double])] = Array((Array(1245, 2867, 1, 1940, 0),Array(0.005828736389870819, 0.005177770692548582, 0.004281225684803414, 0.003802661243134556, 0.0037466618822440735)), (Array(2, 4, 0, 11, 119),Array(0.008472421218338572, 0.00835186048039426, 0.007028728954305847, 0.006925949553647179, 0.006778393528832462)), (Array(9, 1, 3, 81, 0),Array(0.007136098623257581, 0.006219005095591811, 0.00607101967985819, 0.005716841064824449, 0.00547781968634569)), (Array(90, 1480, 267, 379, 3),Array(0.012209939662717557, 0.010448534134872305, 0.00871415633044254, 0.004717316738793793, 0.0036140424647016466)), (Array(1, 4, 42, 2, 7),Array(0.008136396956028923, 0.007598480888602129, 0.0066038668672708575, 0.005629407585564553, 0.004621223223798453)), (Array(0, 3, 2, 1, 4),Array(0.008977479783453209, 0.00818731006415827, 0.007351349890882013, 0.007278806387254452, 0.005765657444255816)), (Array(11, 16, 4, 0, 7),Array(0.010225491273158971, 0.009673480686118726, 0.007140266582380782, 0.006741668845739555, 0.006166286203067536)), (Array(5, 2, 4, 3, 6),Array(0.007127353527224035, 0.004957423825932039, 0.004956635485595906, 0.004879988547583389, 0.004864308362389227)), (Array(1, 0, 3, 2, 4),Array(0.008605481820265399, 0.007793354439640682, 0.007702749345394846, 0.007368449734767341, 0.007331716366632319)))
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">vocabList</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">vocabulary</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>vocabList: Array[String] = Array(mycket, kanske, tjejer, bra, tycker, tjej, aldrig, mÃ¥nga, mÃ¥ste, fan, rÃ¤tt, kvinnor, killar, samma, gillar, vÃ¤ldigt, mÃ¤n, riktigt, kÃ¤nner, kille, tjejen, alltid, verkar, bÃ¤ttre, fel, faktiskt, problem, lika, folk, kÃ¤nns, frÃ¥ga, ens, typ, jÃ¤vla, knulla, olika, kvinna, precis, brukar, behÃ¶ver, svÃ¥rt, hÃ¥ller, barn, borde, kuk, runt, stor, lÃ¥ter, saker, vissa, porr, trÃ¥den, haha, sett, ofta, mest, enkelt, mÃ¤nniskor, klart, tÃ¤nka, tÃ¤nker, annars, egentligen, istÃ¤llet, direkt, killen, hÃ¥lla, fÃ¶rstÃ¥r, lÃ¤nge, mindre, alls, osv, sak, dessutom, skÃ¶nt, liten, bÃ¶rjar, sÃ¤kert, vilja, sjÃ¤lva, handlar, bilder, tÃ¤nder, stora, kuken, hitta, ville, hem, bort, sÃ¥g, the, kul, nÃ¤stan, dÃ¤remot, iaf, stÃ¶rre, kÃ¤nna, varandra, kÃ¥t, bÃ¤sta, tag, lÃ¤tt, hos, lÃ¤ngre, trÃ¥d, fÃ¶rhÃ¥llande, enda, sitter, ihop, egen, svar, tjejerna, sÃ¥nt, inlÃ¤gg, dra, sÃ¤ngen, massa, tillsammans, kolla, brÃ¶st, pengar, veta, fortfarande, tidigare, liv, funkar, fitta, flickvÃ¤n, person, liknande, enligt, hoppas, vanligt, tyvÃ¤rr, bÃ¶rja, ollon, speciellt, par, Ã¤lskar, liksom, lÃ¤r, svenska, orgasm, hÃ¤nder, kropp, ont, absolut, frÃ¥gan, beror, tips, emot, jÃ¤vligt, snygg, sidan, oftast, lÃ¥ngt, fÃ¶rst, prata, undrar, skit, vore, ifrÃ¥n, tillbaka, partner, sjukt, bÃ¶r, slut, sjÃ¤lvklart, bÃ¶rjade, sexuella, testa, livet, sluta, fÃ¶rsÃ¶ka, tÃ¤nkte, spelar, fÃ¶rsÃ¶ker, dÃ¥ligt, visa, hÃ¶rt, filmer, okej, runka, kÃ¶pa, trots, knullar, brudar, skrev, gÃ¥nger, roll, film, intressant, smÃ¥, Ã¤ldre, etc, tid, problemet, kÃ¶ra, gÃ¥ngen, hÃ¥rt, konstigt, kvinnan, hemma, brud, suga, bild, sida, hand, gott, fittan, tyckte, tÃ¤nk, hittar, visar, anser, sÃ¤tta, tycka, hel, ungefÃ¤r, rent, sexuellt, bÃ¤st, snarare, erfarenhet, bajs, kondom, skillnad, pratar, lÃ¥ta, egna, berÃ¤tta, bÃ¶rjan, slicka, sÃ¤rskilt, dvs, snygga, knappast, stort, hÃ¶ra, trodde, igÃ¥ng, illa, anvÃ¤nda, drar, munnen, personer, kompis, Ã¶vrigt, ord, oavsett, fÃ¶rstÃ¥, mannen, kroppen, intresserad, enbart, filmen, hÃ¥r, extra, satt, sÃ¥n, endast, sexet, fungerar, hej, givetvis, pga, fattar, and, analsex, trÃ¤ffat, normalt, vÃ¤nner, gammal, anvÃ¤nder, oskuld, lÃ¤sa, skriva, titta, mÃ¶jligt, rÃ¶ven, trÃ¤ffa, krogen, medan, exempel, personen, tanke, anledning, Ã¥lder, exakt, lÃ¤st, tydligen, lÃ¥t, bryr, yngre, kÃ¤nslor, svara, lÃ¤gger, snabbt, hora, vanliga, sÃ¶ker, fÃ¶rmodligen, fina, stÃ¤mmer, unga, personligen, fort, minst, efterÃ¥t, antar, prova, lilla, leva, betala, mÃ¤nniska, lÃ¥g, frÃ¥gar, nÃ¥tt, hÃ¶r, sant, polare, bor, hÃ¤nt, ansiktet, vÃ¤rlden, otroligt, sÃ¤ker, ifall, ingenting, betyder, tanken, huvudet, antagligen, mkt, vÃ¤ljer, ena, synd, fÃ¶redrar, Ã¤ckligt, tur, jobbigt, flashback, sÃ¥klart, gamla, dÃ¥lig, helvete, jobb, full, lÃ¤ttare, tagit, lycka, stÃ¥, saken, sÃ¤tter, for, suger, trevligt, kort, riktig, kÃ¤nde, pojkvÃ¤n, prostitution, trÃ¤ffar, form, vÃ¤lja, nÃ¤ra, sÃ¤g, sexuell, tÃ¤nkt, samlag, ung, minns, tex, grej, fÃ¶rsÃ¶k, lever, extremt, Ã¶gon, kontakt, you, glad, kÃ¶per, skaffa, bÃ¶g, lÃ¤ra, mÃ¥r, igenom, bilden, kÃ¶n, runkar, viss, bilderna, nÃ¤tet, antingen, prostituerade, penis, skull, relation, namn, hehe, svensk, hittade, roligt, vanlig, sexualitet, trevlig, kollar, kÃ¤rlek, fÃ¶rklara, visste, lÃ¥ng, ihÃ¥g, viktigt, vÃ¥gar, sÃ¥na, tittar, senare, naturligtvis, behÃ¶va, homosexuella, kÃ¥ta, vÃ¤nta, Ã¥ka, jobbar, hjÃ¤lpa, kalla, fint, alldeles, njutning, rÃ¤dd, utseende, hÃ¥ll, sperma, sexigt, forum, bÃ¶gar, fÃ¶rutom, iallafall, totalt, luktar, fortsÃ¤tta, horor, sÃ¤llan, internet, vÃ¤rt, ful, vÃ¤n, ensam, klipp, seriÃ¶st, naturligt, fula, snacka, upphetsande, mesta, kÃ¤r, njuta, orkar, sÃ¤lja, stÃ¥nd, tillrÃ¤ckligt, aning, kukar, testat, ordentligt, stÃ¤ller, rÃ¤cker, djur, knappt, medans, handen, erfarenheter, nere, tackar, fullt, reda, skrivit, nytt, stÃ¤lla, sidor, sÃ¥dÃ¤r, frÃ¥gade, sugen, bruden, kring, lyckas, nÃ¥gonsin, kompisar, mod, kÃ¤nsla, Ã¤mnet, jobbet, lÃ¤ste, tvÃ¤rtom, lÃ¤ser, innebÃ¤r, nÃ¶jd, klarar, mej, stÃ¶rsta, normal, vÃ¤rsta, kÃ¤nslan, sÃ¤ttet, princip, tiden, resten, vÃ¤gen, via, oralsex, betydligt, riktiga, dum, snackar, hahaha, utav, antal, trÃ¥kigt, behov, knullat, rÃ¥d, risken, benen, intresse, plÃ¶tsligt, frÃ¥gor, fÃ¶rut, passar, iofs, fru, tankar, hittat, drog, mamma, situation, tala, stÃ¤lle, talar, hÃ¤nde, njuter, gratis, slags, vÃ¤ll, chans, gilla, vis, samhÃ¤llet, klÃ¤der, annorlunda, plats, lust, fÃ¶rstÃ¥s, eget, ovanligt, sÃ¤ljer, litet, kÃ¤ndes, god, delar, trÃ¤ffade, fÃ¶rÃ¤ldrar, brÃ¶sten, sjÃ¤lvfÃ¶rtroende, killarna, jobba, spela, hÃ¤nda, definitivt, Ã¥ker, hÃ¶ll, beroende, bÃ¶rjat, kunder, verkligheten, hmm, perfekt, trÃ¥dar, naken, vÃ¥ldtÃ¤kt, avsugning, slipper, betalar, Ã¥sikter, fantasier, skÃ¶n, skiter, sÃ¶t, mÃ¤rker, avtÃ¤ndande, leta, Ã¥ring, grund, rum, stÃ¤llet, ren, ansikte, kvinnorna, fallet, spruta, lugnt, finner, lÃ¤s, gav, grejen, flickor, syn, stÃ¤llen, vÃ¤g, generellt, Ã¤rligt, ons, lÃ¥nga, sexliv, hÃ¤nger, situationen, vuxna, hÃ¥rd, fÃ¶rhÃ¥llanden, nyfiken, beteende, krav, kvinnliga, val, piller, porrfilm, Ã¤kta, forumet, svaret, Ã¶verhuvudtaget, anledningen, nÃ¥gonstans, lÃ¤nk, dela, Ã¤ta, rÃ¶v, grymt, knull, kallar, tja, mun, manliga, ragga, otrogen, oxÃ¥, lÃ¤nder, spÃ¤nnande, omÃ¶jligt, sÃ¶ka, mvh, risk, sker, vacker, svÃ¥rare, sexig, rÃ¶r, stan, stoppa, Ã¥sikt, ivÃ¤g, Ã¥ldern, menade, trÃ¶tt, umgÃ¥s, sÃ¤ng, fÃ¶rsÃ¶kte, diskutera, tÃ¤nda, rejÃ¤lt, snÃ¤lla, mat, lÃ¤gg, fÃ¶rresten, slÃ¥, fingrar, hjÃ¤lper, slutar, nice, svarar, rumpa, trycka, underbart, provat, ses, ben, ber, pass, uppenbarligen, topic, massor, stod, skicka, sÃ¥hÃ¤r, mÃ¤nnen, fet, saknar, per, leka, dagens, funka, glidmedel, smal, knullade, bakifrÃ¥n, kÃ¤nnas, skillnaden, dÃ¤rmed, dags, betalt, sambo, allmÃ¤nt, faktum, lyckats, kallas, hÃ¶gre, nja, fÃ¶rsÃ¶kt, skÃ¶nare, lagom, hÃ¶g, vafan, dildo, gillade, hatar, plus, fixa, alternativ, lagen, talat, omkring, slickar, vackra, kÃ¤nt, lÃ¤nkar, krÃ¤vs, ligg, homosexualitet, land, kostar, fÃ¶rspel, sjuk, osÃ¤ker, tvungen, rumpan, upphetsad, rÃ¤knas, koll, slÃ¥r, klitoris, hÃ¤rligt, smak, ovan, magen, fortsÃ¤tter, flicka, fantasi, hÃ¥l, bry, acceptera, klara, lÃ¤nken, hÃ¥ret, frÃ¤mst, dels, chansen, vita, sova, Ã¶gonen, massage, skiten, allra, damer, Ã¶nskar, snyggt, inser, normala, ngn, dÃ¥liga, visade, sexkÃ¶p, minsta, orgasmer, 100, alkohol, utlÃ¶sning, respekt, vatten, lÃ¤ggning, fundera, leder, stil, porren, skolan, ordet, tydligt, sjuka, sÃ¤mre, huvud, oskulden, exempelvis, diverse, lÃ¤t, pinsamt, fÃ¶rhÃ¥llandet, lagt, polisen, vare, desto, fysiskt, hiv, hÃ¥llet, argument, fÃ¶rslag, svart, fÃ¶tter, borta, angÃ¥ende, Ã¶ppna, bdsm, tjÃ¤nster, byta, analt, trÃ¤ffas, viagra, nÃ¤mligen, velat, grÃ¤nsen, rÃ¥kar, sorts, pengarna, ollonet, satte, relativt, uppskattar, bad, krÃ¤ver, pÃ¥stÃ¥, storlek, olagligt, vÃ¤rldens, oerhÃ¶rt, het, klippet, trekant, pungen, ladda, slutade, senaste, Ã¤ter, smakar, ansvar, dej, ngt, fittor, lÃ¤mna, sexiga, satsen, relationer, seriÃ¶s, pappa, snubbe, rolig, mÃ¤rkt, trÃ¤na, vÃ¤ntar, rÃ¤tta, raka, skada, akten, bla, kÃ¶rde, nÃ¤rheten, funderar, uppe, rummet, slappna, fyfan, upplever, slÃ¤ppa, halsen, allvar, far, prostituerad, fÃ¶rstÃ¥tt, snÃ¤ll, Ã¶vergrepp, lagligt, behÃ¶vs, inse, barnet, berÃ¤ttar, tvÃ¥an, garanterat, partners, idÃ©, kÃ¶pt, dominant, rÃ¤kna, faller, letar, besÃ¶k, farligt, kÃ¶p, rygg, kollade, hÃ¥rdare, kÃ¶net, fÃ¶rr, erkÃ¤nna, smeka, svarta, Ã¤ndra, inlÃ¤gget, dÃ¶rren, pÃ¥stÃ¥r, upplevelse, info, lider, sms, nakna, hÃ¶gt, ringa, finger, visserligen, mens, stark, starkt, ryggen, vuxen, majoriteten, beskriver, mage, dÃ¤rifrÃ¥n, anal, familj, personlighet, idiot, Ã¶ppet, hamnar, nivÃ¥, fÃ¶rbi, vÃ¤rld, shit, typen, kroppar, filmerna, Ã¤cklig, runk, escort, Ã¤rlig, datorn, Ã¶verallt, fest, fungera, mening, Ã¤ckliga, samhÃ¤lle, trosor, rÃ¶ra, pratat, skÃ¤l, fatta, onanera, feta, Ã¶ppen, duschen, trycker, pratade, one, tom, berÃ¤ttade, likadant, sprutar, troligen, gravid, undvika, hemsida, onani, smala, nuvarande, quote, undra, dumt, sÃ¶k, lÃ¤rt, vÃ¥t, lÃ¤ngden, brudarna, ledsen, porrfilmer, fullstÃ¤ndigt, slippa, muskler, Ã¥rig, verkade, spoiler, bestÃ¤mma, dÃ¶d, smaken, usch, dricka)
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">topics</span> <span class="o">=</span> <span class="n">topicIndices</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">termWeights</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="n">terms</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">vocabList</span><span class="p">(</span><span class="n">_</span><span class="p">))</span><span class="o">.</span><span class="n">zip</span><span class="p">(</span><span class="n">termWeights</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>topics: Array[Array[(String, Double)]] = Array(Array((com,0.005828736389870819), (font,0.005177770692548582), (kanske,0.004281225684803414), (size,0.003802661243134556), (mycket,0.0037466618822440735)), Array((tjejer,0.008472421218338572), (tycker,0.00835186048039426), (mycket,0.007028728954305847), (kvinnor,0.006925949553647179), (brÃ¶st,0.006778393528832462)), Array((fan,0.007136098623257581), (kanske,0.006219005095591811), (bra,0.00607101967985819), (bilder,0.005716841064824449), (mycket,0.00547781968634569)), Array((the,0.012209939662717557), (datanÃ¶rdar,0.010448534134872305), (and,0.00871415633044254), (you,0.004717316738793793), (bra,0.0036140424647016466)), Array((kanske,0.008136396956028923), (tycker,0.007598480888602129), (barn,0.0066038668672708575), (tjejer,0.005629407585564553), (mÃ¥nga,0.004621223223798453)), Array((mycket,0.008977479783453209), (bra,0.00818731006415827), (tjejer,0.007351349890882013), (kanske,0.007278806387254452), (tycker,0.005765657444255816)), Array((kvinnor,0.010225491273158971), (mÃ¤n,0.009673480686118726), (tycker,0.007140266582380782), (mycket,0.006741668845739555), (mÃ¥nga,0.006166286203067536)), Array((tjej,0.007127353527224035), (tjejer,0.004957423825932039), (tycker,0.004956635485595906), (bra,0.004879988547583389), (aldrig,0.004864308362389227)), Array((kanske,0.008605481820265399), (mycket,0.007793354439640682), (bra,0.007702749345394846), (tjejer,0.007368449734767341), (tycker,0.007331716366632319)))
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">topicIndices</span> <span class="o">=</span> <span class="n">ldaModel</span><span class="o">.</span><span class="n">describeTopics</span><span class="p">(</span><span class="n">maxTermsPerTopic</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">val</span> <span class="n">vocabList</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">vocabulary</span>
<span class="n">val</span> <span class="n">topics</span> <span class="o">=</span> <span class="n">topicIndices</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">termWeights</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="n">terms</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">vocabList</span><span class="p">(</span><span class="n">_</span><span class="p">))</span><span class="o">.</span><span class="n">zip</span><span class="p">(</span><span class="n">termWeights</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;$numTopics topics:&quot;</span><span class="p">)</span>
<span class="n">topics</span><span class="o">.</span><span class="n">zipWithIndex</span><span class="o">.</span><span class="n">foreach</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;TOPIC $i&quot;</span><span class="p">)</span>
  <span class="n">topic</span><span class="o">.</span><span class="n">foreach</span> <span class="p">{</span> <span class="n">case</span> <span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;$term</span><span class="se">\t</span><span class="s2">$weight&quot;</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;==========&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>9 topics:
TOPIC 0
com	0.005828736389870819
font	0.005177770692548582
kanske	0.004281225684803414
size	0.003802661243134556
mycket	0.0037466618822440735
tycker	0.0035788236930912945
tjej	0.003572148658558219
wmv	0.003492052477056438
fan	0.003387032075470724
killar	0.0030759438164969536
==========
TOPIC 1
tjejer	0.008472421218338572
tycker	0.00835186048039426
mycket	0.007028728954305847
kvinnor	0.006925949553647179
brÃ¶st	0.006778393528832462
kanske	0.006562072420550684
bra	0.005735098526572583
tjej	0.00509426741049249
mÃ¥nga	0.0048473374351092275
stora	0.00476766751743259
==========
TOPIC 2
fan	0.007136098623257581
kanske	0.006219005095591811
bra	0.00607101967985819
bilder	0.005716841064824449
mycket	0.00547781968634569
tjej	0.005384256034422819
tycker	0.005334349560442397
tjejer	0.004803912617599809
riktigt	0.004136561405063082
mÃ¥ste	0.004049538541763246
==========
TOPIC 3
the	0.012209939662717557
datanÃ¶rdar	0.010448534134872305
and	0.00871415633044254
you	0.004717316738793793
bra	0.0036140424647016466
kanske	0.002794974212182175
for	0.00257613484350404
mycket	0.0025543316673021775
tjejer	0.0025314211222808034
fan	0.0021470545469380897
==========
TOPIC 4
kanske	0.008136396956028923
tycker	0.007598480888602129
barn	0.0066038668672708575
tjejer	0.005629407585564553
mÃ¥nga	0.004621223223798453
aldrig	0.004402198423276141
bra	0.004294088390266522
mycket	0.004118530511479333
fan	0.004054347059086492
rÃ¤tt	0.003984365147630218
==========
TOPIC 5
mycket	0.008977479783453209
bra	0.00818731006415827
tjejer	0.007351349890882013
kanske	0.007278806387254452
tycker	0.005765657444255816
tjej	0.005283260728111136
aldrig	0.004850961525403287
mÃ¥ste	0.004295311331401175
mÃ¥nga	0.004098909420309231
fan	0.0037519527610768363
==========
TOPIC 6
kvinnor	0.010225491273158971
mÃ¤n	0.009673480686118726
tycker	0.007140266582380782
mycket	0.006741668845739555
mÃ¥nga	0.006166286203067536
tjejer	0.0055899906619138835
kanske	0.005496960145787021
bra	0.00450516316658287
rÃ¤tt	0.003975370248418236
samma	0.003745046376784121
==========
TOPIC 7
tjej	0.007127353527224035
tjejer	0.004957423825932039
tycker	0.004956635485595906
bra	0.004879988547583389
aldrig	0.004864308362389227
kanske	0.004588326800005052
fan	0.0045304366858314
mycket	0.004254791775847753
kille	0.003227585234792242
mÃ¥nga	0.003104815800968856
==========
TOPIC 8
kanske	0.008605481820265399
mycket	0.007793354439640682
bra	0.007702749345394846
tjejer	0.007368449734767341
tycker	0.007331716366632319
tjej	0.007143594626213114
aldrig	0.0057960981929391165
mÃ¥ste	0.004375258913740614
killar	0.004267007182925261
kÃ¤nner	0.004083723539468458
==========
topicIndices: Array[(Array[Int], Array[Double])] = Array((Array(1245, 2867, 1, 1940, 0, 4, 5, 2415, 9, 12),Array(0.005828736389870819, 0.005177770692548582, 0.004281225684803414, 0.003802661243134556, 0.0037466618822440735, 0.0035788236930912945, 0.003572148658558219, 0.003492052477056438, 0.003387032075470724, 0.0030759438164969536)), (Array(2, 4, 0, 11, 119, 1, 3, 5, 7, 83),Array(0.008472421218338572, 0.00835186048039426, 0.007028728954305847, 0.006925949553647179, 0.006778393528832462, 0.006562072420550684, 0.005735098526572583, 0.00509426741049249, 0.0048473374351092275, 0.00476766751743259)), (Array(9, 1, 3, 81, 0, 5, 4, 2, 17, 8),Array(0.007136098623257581, 0.006219005095591811, 0.00607101967985819, 0.005716841064824449, 0.00547781968634569, 0.005384256034422819, 0.005334349560442397, 0.004803912617599809, 0.004136561405063082, 0.004049538541763246)), (Array(90, 1480, 267, 379, 3, 1, 354, 0, 2, 9),Array(0.012209939662717557, 0.010448534134872305, 0.00871415633044254, 0.004717316738793793, 0.0036140424647016466, 0.002794974212182175, 0.00257613484350404, 0.0025543316673021775, 0.0025314211222808034, 0.0021470545469380897)), (Array(1, 4, 42, 2, 7, 6, 3, 0, 9, 10),Array(0.008136396956028923, 0.007598480888602129, 0.0066038668672708575, 0.005629407585564553, 0.004621223223798453, 0.004402198423276141, 0.004294088390266522, 0.004118530511479333, 0.004054347059086492, 0.003984365147630218)), (Array(0, 3, 2, 1, 4, 5, 6, 8, 7, 9),Array(0.008977479783453209, 0.00818731006415827, 0.007351349890882013, 0.007278806387254452, 0.005765657444255816, 0.005283260728111136, 0.004850961525403287, 0.004295311331401175, 0.004098909420309231, 0.0037519527610768363)), (Array(11, 16, 4, 0, 7, 2, 1, 3, 10, 13),Array(0.010225491273158971, 0.009673480686118726, 0.007140266582380782, 0.006741668845739555, 0.006166286203067536, 0.0055899906619138835, 0.005496960145787021, 0.00450516316658287, 0.003975370248418236, 0.003745046376784121)), (Array(5, 2, 4, 3, 6, 1, 9, 0, 19, 7),Array(0.007127353527224035, 0.004957423825932039, 0.004956635485595906, 0.004879988547583389, 0.004864308362389227, 0.004588326800005052, 0.0045304366858314, 0.004254791775847753, 0.003227585234792242, 0.003104815800968856)), (Array(1, 0, 3, 2, 4, 5, 6, 8, 12, 18),Array(0.008605481820265399, 0.007793354439640682, 0.007702749345394846, 0.007368449734767341, 0.007331716366632319, 0.007143594626213114, 0.0057960981929391165, 0.004375258913740614, 0.004267007182925261, 0.004083723539468458)))
vocabList: Array[String] = Array(mycket, kanske, tjejer, bra, tycker, tjej, aldrig, mÃ¥nga, mÃ¥ste, fan, rÃ¤tt, kvinnor, killar, samma, gillar, vÃ¤ldigt, mÃ¤n, riktigt, kÃ¤nner, kille, tjejen, alltid, verkar, bÃ¤ttre, fel, faktiskt, problem, lika, folk, kÃ¤nns, frÃ¥ga, ens, typ, jÃ¤vla, knulla, olika, kvinna, precis, brukar, behÃ¶ver, svÃ¥rt, hÃ¥ller, barn, borde, kuk, runt, stor, lÃ¥ter, saker, vissa, porr, trÃ¥den, haha, sett, ofta, mest, enkelt, mÃ¤nniskor, klart, tÃ¤nka, tÃ¤nker, annars, egentligen, istÃ¤llet, direkt, killen, hÃ¥lla, fÃ¶rstÃ¥r, lÃ¤nge, mindre, alls, osv, sak, dessutom, skÃ¶nt, liten, bÃ¶rjar, sÃ¤kert, vilja, sjÃ¤lva, handlar, bilder, tÃ¤nder, stora, kuken, hitta, ville, hem, bort, sÃ¥g, the, kul, nÃ¤stan, dÃ¤remot, iaf, stÃ¶rre, kÃ¤nna, varandra, kÃ¥t, bÃ¤sta, tag, lÃ¤tt, hos, lÃ¤ngre, trÃ¥d, fÃ¶rhÃ¥llande, enda, sitter, ihop, egen, svar, tjejerna, sÃ¥nt, inlÃ¤gg, dra, sÃ¤ngen, massa, tillsammans, kolla, brÃ¶st, pengar, veta, fortfarande, tidigare, liv, funkar, fitta, flickvÃ¤n, person, liknande, enligt, hoppas, vanligt, tyvÃ¤rr, bÃ¶rja, ollon, speciellt, par, Ã¤lskar, liksom, lÃ¤r, svenska, orgasm, hÃ¤nder, kropp, ont, absolut, frÃ¥gan, beror, tips, emot, jÃ¤vligt, snygg, sidan, oftast, lÃ¥ngt, fÃ¶rst, prata, undrar, skit, vore, ifrÃ¥n, tillbaka, partner, sjukt, bÃ¶r, slut, sjÃ¤lvklart, bÃ¶rjade, sexuella, testa, livet, sluta, fÃ¶rsÃ¶ka, tÃ¤nkte, spelar, fÃ¶rsÃ¶ker, dÃ¥ligt, visa, hÃ¶rt, filmer, okej, runka, kÃ¶pa, trots, knullar, brudar, skrev, gÃ¥nger, roll, film, intressant, smÃ¥, Ã¤ldre, etc, tid, problemet, kÃ¶ra, gÃ¥ngen, hÃ¥rt, konstigt, kvinnan, hemma, brud, suga, bild, sida, hand, gott, fittan, tyckte, tÃ¤nk, hittar, visar, anser, sÃ¤tta, tycka, hel, ungefÃ¤r, rent, sexuellt, bÃ¤st, snarare, erfarenhet, bajs, kondom, skillnad, pratar, lÃ¥ta, egna, berÃ¤tta, bÃ¶rjan, slicka, sÃ¤rskilt, dvs, snygga, knappast, stort, hÃ¶ra, trodde, igÃ¥ng, illa, anvÃ¤nda, drar, munnen, personer, kompis, Ã¶vrigt, ord, oavsett, fÃ¶rstÃ¥, mannen, kroppen, intresserad, enbart, filmen, hÃ¥r, extra, satt, sÃ¥n, endast, sexet, fungerar, hej, givetvis, pga, fattar, and, analsex, trÃ¤ffat, normalt, vÃ¤nner, gammal, anvÃ¤nder, oskuld, lÃ¤sa, skriva, titta, mÃ¶jligt, rÃ¶ven, trÃ¤ffa, krogen, medan, exempel, personen, tanke, anledning, Ã¥lder, exakt, lÃ¤st, tydligen, lÃ¥t, bryr, yngre, kÃ¤nslor, svara, lÃ¤gger, snabbt, hora, vanliga, sÃ¶ker, fÃ¶rmodligen, fina, stÃ¤mmer, unga, personligen, fort, minst, efterÃ¥t, antar, prova, lilla, leva, betala, mÃ¤nniska, lÃ¥g, frÃ¥gar, nÃ¥tt, hÃ¶r, sant, polare, bor, hÃ¤nt, ansiktet, vÃ¤rlden, otroligt, sÃ¤ker, ifall, ingenting, betyder, tanken, huvudet, antagligen, mkt, vÃ¤ljer, ena, synd, fÃ¶redrar, Ã¤ckligt, tur, jobbigt, flashback, sÃ¥klart, gamla, dÃ¥lig, helvete, jobb, full, lÃ¤ttare, tagit, lycka, stÃ¥, saken, sÃ¤tter, for, suger, trevligt, kort, riktig, kÃ¤nde, pojkvÃ¤n, prostitution, trÃ¤ffar, form, vÃ¤lja, nÃ¤ra, sÃ¤g, sexuell, tÃ¤nkt, samlag, ung, minns, tex, grej, fÃ¶rsÃ¶k, lever, extremt, Ã¶gon, kontakt, you, glad, kÃ¶per, skaffa, bÃ¶g, lÃ¤ra, mÃ¥r, igenom, bilden, kÃ¶n, runkar, viss, bilderna, nÃ¤tet, antingen, prostituerade, penis, skull, relation, namn, hehe, svensk, hittade, roligt, vanlig, sexualitet, trevlig, kollar, kÃ¤rlek, fÃ¶rklara, visste, lÃ¥ng, ihÃ¥g, viktigt, vÃ¥gar, sÃ¥na, tittar, senare, naturligtvis, behÃ¶va, homosexuella, kÃ¥ta, vÃ¤nta, Ã¥ka, jobbar, hjÃ¤lpa, kalla, fint, alldeles, njutning, rÃ¤dd, utseende, hÃ¥ll, sperma, sexigt, forum, bÃ¶gar, fÃ¶rutom, iallafall, totalt, luktar, fortsÃ¤tta, horor, sÃ¤llan, internet, vÃ¤rt, ful, vÃ¤n, ensam, klipp, seriÃ¶st, naturligt, fula, snacka, upphetsande, mesta, kÃ¤r, njuta, orkar, sÃ¤lja, stÃ¥nd, tillrÃ¤ckligt, aning, kukar, testat, ordentligt, stÃ¤ller, rÃ¤cker, djur, knappt, medans, handen, erfarenheter, nere, tackar, fullt, reda, skrivit, nytt, stÃ¤lla, sidor, sÃ¥dÃ¤r, frÃ¥gade, sugen, bruden, kring, lyckas, nÃ¥gonsin, kompisar, mod, kÃ¤nsla, Ã¤mnet, jobbet, lÃ¤ste, tvÃ¤rtom, lÃ¤ser, innebÃ¤r, nÃ¶jd, klarar, mej, stÃ¶rsta, normal, vÃ¤rsta, kÃ¤nslan, sÃ¤ttet, princip, tiden, resten, vÃ¤gen, via, oralsex, betydligt, riktiga, dum, snackar, hahaha, utav, antal, trÃ¥kigt, behov, knullat, rÃ¥d, risken, benen, intresse, plÃ¶tsligt, frÃ¥gor, fÃ¶rut, passar, iofs, fru, tankar, hittat, drog, mamma, situation, tala, stÃ¤lle, talar, hÃ¤nde, njuter, gratis, slags, vÃ¤ll, chans, gilla, vis, samhÃ¤llet, klÃ¤der, annorlunda, plats, lust, fÃ¶rstÃ¥s, eget, ovanligt, sÃ¤ljer, litet, kÃ¤ndes, god, delar, trÃ¤ffade, fÃ¶rÃ¤ldrar, brÃ¶sten, sjÃ¤lvfÃ¶rtroende, killarna, jobba, spela, hÃ¤nda, definitivt, Ã¥ker, hÃ¶ll, beroende, bÃ¶rjat, kunder, verkligheten, hmm, perfekt, trÃ¥dar, naken, vÃ¥ldtÃ¤kt, avsugning, slipper, betalar, Ã¥sikter, fantasier, skÃ¶n, skiter, sÃ¶t, mÃ¤rker, avtÃ¤ndande, leta, Ã¥ring, grund, rum, stÃ¤llet, ren, ansikte, kvinnorna, fallet, spruta, lugnt, finner, lÃ¤s, gav, grejen, flickor, syn, stÃ¤llen, vÃ¤g, generellt, Ã¤rligt, ons, lÃ¥nga, sexliv, hÃ¤nger, situationen, vuxna, hÃ¥rd, fÃ¶rhÃ¥llanden, nyfiken, beteende, krav, kvinnliga, val, piller, porrfilm, Ã¤kta, forumet, svaret, Ã¶verhuvudtaget, anledningen, nÃ¥gonstans, lÃ¤nk, dela, Ã¤ta, rÃ¶v, grymt, knull, kallar, tja, mun, manliga, ragga, otrogen, oxÃ¥, lÃ¤nder, spÃ¤nnande, omÃ¶jligt, sÃ¶ka, mvh, risk, sker, vacker, svÃ¥rare, sexig, rÃ¶r, stan, stoppa, Ã¥sikt, ivÃ¤g, Ã¥ldern, menade, trÃ¶tt, umgÃ¥s, sÃ¤ng, fÃ¶rsÃ¶kte, diskutera, tÃ¤nda, rejÃ¤lt, snÃ¤lla, mat, lÃ¤gg, fÃ¶rresten, slÃ¥, fingrar, hjÃ¤lper, slutar, nice, svarar, rumpa, trycka, underbart, provat, ses, ben, ber, pass, uppenbarligen, topic, massor, stod, skicka, sÃ¥hÃ¤r, mÃ¤nnen, fet, saknar, per, leka, dagens, funka, glidmedel, smal, knullade, bakifrÃ¥n, kÃ¤nnas, skillnaden, dÃ¤rmed, dags, betalt, sambo, allmÃ¤nt, faktum, lyckats, kallas, hÃ¶gre, nja, fÃ¶rsÃ¶kt, skÃ¶nare, lagom, hÃ¶g, vafan, dildo, gillade, hatar, plus, fixa, alternativ, lagen, talat, omkring, slickar, vackra, kÃ¤nt, lÃ¤nkar, krÃ¤vs, ligg, homosexualitet, land, kostar, fÃ¶rspel, sjuk, osÃ¤ker, tvungen, rumpan, upphetsad, rÃ¤knas, koll, slÃ¥r, klitoris, hÃ¤rligt, smak, ovan, magen, fortsÃ¤tter, flicka, fantasi, hÃ¥l, bry, acceptera, klara, lÃ¤nken, hÃ¥ret, frÃ¤mst, dels, chansen, vita, sova, Ã¶gonen, massage, skiten, allra, damer, Ã¶nskar, snyggt, inser, normala, ngn, dÃ¥liga, visade, sexkÃ¶p, minsta, orgasmer, 100, alkohol, utlÃ¶sning, respekt, vatten, lÃ¤ggning, fundera, leder, stil, porren, skolan, ordet, tydligt, sjuka, sÃ¤mre, huvud, oskulden, exempelvis, diverse, lÃ¤t, pinsamt, fÃ¶rhÃ¥llandet, lagt, polisen, vare, desto, fysiskt, hiv, hÃ¥llet, argument, fÃ¶rslag, svart, fÃ¶tter, borta, angÃ¥ende, Ã¶ppna, bdsm, tjÃ¤nster, byta, analt, trÃ¤ffas, viagra, nÃ¤mligen, velat, grÃ¤nsen, rÃ¥kar, sorts, pengarna, ollonet, satte, relativt, uppskattar, bad, krÃ¤ver, pÃ¥stÃ¥, storlek, olagligt, vÃ¤rldens, oerhÃ¶rt, het, klippet, trekant, pungen, ladda, slutade, senaste, Ã¤ter, smakar, ansvar, dej, ngt, fittor, lÃ¤mna, sexiga, satsen, relationer, seriÃ¶s, pappa, snubbe, rolig, mÃ¤rkt, trÃ¤na, vÃ¤ntar, rÃ¤tta, raka, skada, akten, bla, kÃ¶rde, nÃ¤rheten, funderar, uppe, rummet, slappna, fyfan, upplever, slÃ¤ppa, halsen, allvar, far, prostituerad, fÃ¶rstÃ¥tt, snÃ¤ll, Ã¶vergrepp, lagligt, behÃ¶vs, inse, barnet, berÃ¤ttar, tvÃ¥an, garanterat, partners, idÃ©, kÃ¶pt, dominant, rÃ¤kna, faller, letar, besÃ¶k, farligt, kÃ¶p, rygg, kollade, hÃ¥rdare, kÃ¶net, fÃ¶rr, erkÃ¤nna, smeka, svarta, Ã¤ndra, inlÃ¤gget, dÃ¶rren, pÃ¥stÃ¥r, upplevelse, info, lider, sms, nakna, hÃ¶gt, ringa, finger, visserligen, mens, stark, starkt, ryggen, vuxen, majoriteten, beskriver, mage, dÃ¤rifrÃ¥n, anal, familj, personlighet, idiot, Ã¶ppet, hamnar, nivÃ¥, fÃ¶rbi, vÃ¤rld, shit, typen, kroppar, filmerna, Ã¤cklig, runk, escort, Ã¤rlig, datorn, Ã¶verallt, fest, fungera, mening, Ã¤ckliga, samhÃ¤lle, trosor, rÃ¶ra, pratat, skÃ¤l, fatta, onanera, feta, Ã¶ppen, duschen, trycker, pratade, one, tom, berÃ¤ttade, likadant, sprutar, troligen, gravid, undvika, hemsida, onani, smala, nuvarande, quote, undra, dumt, sÃ¶k, lÃ¤rt, vÃ¥t, lÃ¤ngden, brudarna, ledsen, porrfilmer, fullstÃ¤ndigt, slippa, muskler, Ã¥rig, verkade, spoiler, bestÃ¤mma, dÃ¶d, smaken, usch, dricka)
topics: Array[Array[(String, Double)]] = Array(Array((com,0.005828736389870819), (font,0.005177770692548582), (kanske,0.004281225684803414), (size,0.003802661243134556), (mycket,0.0037466618822440735), (tycker,0.0035788236930912945), (tjej,0.003572148658558219), (wmv,0.003492052477056438), (fan,0.003387032075470724), (killar,0.0030759438164969536)), Array((tjejer,0.008472421218338572), (tycker,0.00835186048039426), (mycket,0.007028728954305847), (kvinnor,0.006925949553647179), (brÃ¶st,0.006778393528832462), (kanske,0.006562072420550684), (bra,0.005735098526572583), (tjej,0.00509426741049249), (mÃ¥nga,0.0048473374351092275), (stora,0.00476766751743259)), Array((fan,0.007136098623257581), (kanske,0.006219005095591811), (bra,0.00607101967985819), (bilder,0.005716841064824449), (mycket,0.00547781968634569), (tjej,0.005384256034422819), (tycker,0.005334349560442397), (tjejer,0.004803912617599809), (riktigt,0.004136561405063082), (mÃ¥ste,0.004049538541763246)), Array((the,0.012209939662717557), (datanÃ¶rdar,0.010448534134872305), (and,0.00871415633044254), (you,0.004717316738793793), (bra,0.0036140424647016466), (kanske,0.002794974212182175), (for,0.00257613484350404), (mycket,0.0025543316673021775), (tjejer,0.0025314211222808034), (fan,0.0021470545469380897)), Array((kanske,0.008136396956028923), (tycker,0.007598480888602129), (barn,0.0066038668672708575), (tjejer,0.005629407585564553), (mÃ¥nga,0.004621223223798453), (aldrig,0.004402198423276141), (bra,0.004294088390266522), (mycket,0.004118530511479333), (fan,0.004054347059086492), (rÃ¤tt,0.003984365147630218)), Array((mycket,0.008977479783453209), (bra,0.00818731006415827), (tjejer,0.007351349890882013), (kanske,0.007278806387254452), (tycker,0.005765657444255816), (tjej,0.005283260728111136), (aldrig,0.004850961525403287), (mÃ¥ste,0.004295311331401175), (mÃ¥nga,0.004098909420309231), (fan,0.0037519527610768363)), Array((kvinnor,0.010225491273158971), (mÃ¤n,0.009673480686118726), (tycker,0.007140266582380782), (mycket,0.006741668845739555), (mÃ¥nga,0.006166286203067536), (tjejer,0.0055899906619138835), (kanske,0.005496960145787021), (bra,0.00450516316658287), (rÃ¤tt,0.003975370248418236), (samma,0.003745046376784121)), Array((tjej,0.007127353527224035), (tjejer,0.004957423825932039), (tycker,0.004956635485595906), (bra,0.004879988547583389), (aldrig,0.004864308362389227), (kanske,0.004588326800005052), (fan,0.0045304366858314), (mycket,0.004254791775847753), (kille,0.003227585234792242), (mÃ¥nga,0.003104815800968856)), Array((kanske,0.008605481820265399), (mycket,0.007793354439640682), (bra,0.007702749345394846), (tjejer,0.007368449734767341), (tycker,0.007331716366632319), (tjej,0.007143594626213114), (aldrig,0.0057960981929391165), (mÃ¥ste,0.004375258913740614), (killar,0.004267007182925261), (kÃ¤nner,0.004083723539468458)))
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;det&quot;</span><span class="p">,</span><span class="s2">&quot;att&quot;</span><span class="p">,</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Zip</span> <span class="n">topic</span> <span class="n">terms</span> <span class="k">with</span> <span class="n">topic</span> <span class="n">IDs</span>
<span class="n">val</span> <span class="n">termArray</span> <span class="o">=</span> <span class="n">topics</span><span class="o">.</span><span class="n">zipWithIndex</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>termArray: Array[(Array[(String, Double)], Int)] = Array((Array((com,0.005828736389870819), (font,0.005177770692548582), (kanske,0.004281225684803414), (size,0.003802661243134556), (mycket,0.0037466618822440735), (tycker,0.0035788236930912945), (tjej,0.003572148658558219), (wmv,0.003492052477056438), (fan,0.003387032075470724), (killar,0.0030759438164969536)),0), (Array((tjejer,0.008472421218338572), (tycker,0.00835186048039426), (mycket,0.007028728954305847), (kvinnor,0.006925949553647179), (brÃ¶st,0.006778393528832462), (kanske,0.006562072420550684), (bra,0.005735098526572583), (tjej,0.00509426741049249), (mÃ¥nga,0.0048473374351092275), (stora,0.00476766751743259)),1), (Array((fan,0.007136098623257581), (kanske,0.006219005095591811), (bra,0.00607101967985819), (bilder,0.005716841064824449), (mycket,0.00547781968634569), (tjej,0.005384256034422819), (tycker,0.005334349560442397), (tjejer,0.004803912617599809), (riktigt,0.004136561405063082), (mÃ¥ste,0.004049538541763246)),2), (Array((the,0.012209939662717557), (datanÃ¶rdar,0.010448534134872305), (and,0.00871415633044254), (you,0.004717316738793793), (bra,0.0036140424647016466), (kanske,0.002794974212182175), (for,0.00257613484350404), (mycket,0.0025543316673021775), (tjejer,0.0025314211222808034), (fan,0.0021470545469380897)),3), (Array((kanske,0.008136396956028923), (tycker,0.007598480888602129), (barn,0.0066038668672708575), (tjejer,0.005629407585564553), (mÃ¥nga,0.004621223223798453), (aldrig,0.004402198423276141), (bra,0.004294088390266522), (mycket,0.004118530511479333), (fan,0.004054347059086492), (rÃ¤tt,0.003984365147630218)),4), (Array((mycket,0.008977479783453209), (bra,0.00818731006415827), (tjejer,0.007351349890882013), (kanske,0.007278806387254452), (tycker,0.005765657444255816), (tjej,0.005283260728111136), (aldrig,0.004850961525403287), (mÃ¥ste,0.004295311331401175), (mÃ¥nga,0.004098909420309231), (fan,0.0037519527610768363)),5), (Array((kvinnor,0.010225491273158971), (mÃ¤n,0.009673480686118726), (tycker,0.007140266582380782), (mycket,0.006741668845739555), (mÃ¥nga,0.006166286203067536), (tjejer,0.0055899906619138835), (kanske,0.005496960145787021), (bra,0.00450516316658287), (rÃ¤tt,0.003975370248418236), (samma,0.003745046376784121)),6), (Array((tjej,0.007127353527224035), (tjejer,0.004957423825932039), (tycker,0.004956635485595906), (bra,0.004879988547583389), (aldrig,0.004864308362389227), (kanske,0.004588326800005052), (fan,0.0045304366858314), (mycket,0.004254791775847753), (kille,0.003227585234792242), (mÃ¥nga,0.003104815800968856)),7), (Array((kanske,0.008605481820265399), (mycket,0.007793354439640682), (bra,0.007702749345394846), (tjejer,0.007368449734767341), (tycker,0.007331716366632319), (tjej,0.007143594626213114), (aldrig,0.0057960981929391165), (mÃ¥ste,0.004375258913740614), (killar,0.004267007182925261), (kÃ¤nner,0.004083723539468458)),8))
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Transform</span> <span class="n">data</span> <span class="n">into</span> <span class="n">the</span> <span class="n">form</span> <span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">probability</span><span class="p">,</span> <span class="n">topicId</span><span class="p">)</span>
<span class="n">val</span> <span class="n">termRDD</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">termArray</span><span class="p">)</span>
<span class="n">val</span> <span class="n">termRDD2</span> <span class="o">=</span><span class="n">termRDD</span><span class="o">.</span><span class="n">flatMap</span><span class="p">(</span> <span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">Array</span><span class="p">[(</span><span class="n">String</span><span class="p">,</span> <span class="n">Double</span><span class="p">)],</span> <span class="n">Int</span><span class="p">))</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="n">val</span> <span class="n">arrayOfTuple</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">_1</span>
  <span class="n">val</span> <span class="n">topicId</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">_2</span>
  <span class="n">arrayOfTuple</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">el</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">_1</span><span class="p">,</span> <span class="n">el</span><span class="o">.</span><span class="n">_2</span><span class="p">,</span> <span class="n">topicId</span><span class="p">))</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>termRDD: org.apache.spark.rdd.RDD[(Array[(String, Double)], Int)] = ParallelCollectionRDD[15773] at parallelize at command-1716517738645101:2
termRDD2: org.apache.spark.rdd.RDD[(String, Double, Int)] = MapPartitionsRDD[15774] at flatMap at command-1716517738645101:3
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">termDF</span> <span class="o">=</span> <span class="n">termRDD2</span><span class="o">.</span><span class="n">toDF</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_1&quot;</span><span class="p">,</span> <span class="s2">&quot;term&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_2&quot;</span><span class="p">,</span> <span class="s2">&quot;probability&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;_3&quot;</span><span class="p">,</span> <span class="s2">&quot;topicId&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>termDF: org.apache.spark.sql.DataFrame = [term: string, probability: double ... 1 more field]
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">termDF</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>Truncated to 30 rows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Create</span> <span class="n">JSON</span> <span class="n">data</span>
<span class="n">val</span> <span class="n">rawJson</span> <span class="o">=</span> <span class="n">termDF</span><span class="o">.</span><span class="n">toJSON</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span><span class="o">.</span><span class="n">mkString</span><span class="p">(</span><span class="s2">&quot;,</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>rawJson: String =
{&quot;term&quot;:&quot;com&quot;,&quot;probability&quot;:0.005828736389870819,&quot;topicId&quot;:0},
{&quot;term&quot;:&quot;font&quot;,&quot;probability&quot;:0.005177770692548582,&quot;topicId&quot;:0},
{&quot;term&quot;:&quot;kanske&quot;,&quot;probability&quot;:0.004281225684803414,&quot;topicId&quot;:0},
{&quot;term&quot;:&quot;size&quot;,&quot;probability&quot;:0.003802661243134556,&quot;topicId&quot;:0},
{&quot;term&quot;:&quot;mycket&quot;,&quot;probability&quot;:0.0037466618822440735,&quot;topicId&quot;:0},
{&quot;term&quot;:&quot;tycker&quot;,&quot;probability&quot;:0.0035788236930912945,&quot;topicId&quot;:0},
{&quot;term&quot;:&quot;tjej&quot;,&quot;probability&quot;:0.003572148658558219,&quot;topicId&quot;:0},
{&quot;term&quot;:&quot;wmv&quot;,&quot;probability&quot;:0.003492052477056438,&quot;topicId&quot;:0},
{&quot;term&quot;:&quot;fan&quot;,&quot;probability&quot;:0.003387032075470724,&quot;topicId&quot;:0},
{&quot;term&quot;:&quot;killar&quot;,&quot;probability&quot;:0.0030759438164969536,&quot;topicId&quot;:0},
{&quot;term&quot;:&quot;tjejer&quot;,&quot;probability&quot;:0.008472421218338572,&quot;topicId&quot;:1},
{&quot;term&quot;:&quot;tycker&quot;,&quot;probability&quot;:0.00835186048039426,&quot;topicId&quot;:1},
{&quot;term&quot;:&quot;mycket&quot;,&quot;probability&quot;:0.007028728954305847,&quot;topicId&quot;:1},
{&quot;term&quot;:&quot;kvinnor&quot;,&quot;probability&quot;:0.006925949553647179,&quot;topicId&quot;:1},
{&quot;term&quot;:&quot;brÃ¶st&quot;,&quot;probability&quot;:0.006778393528832462,&quot;topicId&quot;:1},
{&quot;term&quot;:&quot;kanske&quot;,&quot;probability&quot;:0.006562072420550684,&quot;topicId&quot;:1},
{&quot;term&quot;:&quot;bra&quot;,&quot;probability&quot;:0.005735098526572583,&quot;topicId&quot;:1},
{&quot;term&quot;:&quot;tjej&quot;,&quot;probability&quot;:0.00509426741049249,&quot;topicId&quot;:1},
{&quot;term&quot;:&quot;mÃ¥nga&quot;,&quot;probability&quot;:0.0048473374351092275,&quot;topicId&quot;:1},
{&quot;term&quot;:&quot;stora&quot;,&quot;probability&quot;:0.00476766751743259,&quot;topicId&quot;:1},
{&quot;term&quot;:&quot;fan&quot;,&quot;probability&quot;:0.007136098623257581,&quot;topicId&quot;:2},
{&quot;term&quot;:&quot;kanske&quot;,&quot;probability&quot;:0.006219005095591811,&quot;topicId&quot;:2},
{&quot;term&quot;:&quot;bra&quot;,&quot;probability&quot;:0.00607101967985819,&quot;topicId&quot;:2},
{&quot;term&quot;:&quot;bilder&quot;,&quot;probability&quot;:0.005716841064824449,&quot;topicId&quot;:2},
{&quot;term&quot;:&quot;mycket&quot;,&quot;probability&quot;:0.00547781968634569,&quot;topicId&quot;:2},
{&quot;term&quot;:&quot;tjej&quot;,&quot;probability&quot;:0.005384256034422819,&quot;topicId&quot;:2},
{&quot;term&quot;:&quot;tycker&quot;,&quot;probability&quot;:0.005334349560442397,&quot;topicId&quot;:2},
{&quot;term&quot;:&quot;tjejer&quot;,&quot;probability&quot;:0.004803912617599809,&quot;topicId&quot;:2},
{&quot;term&quot;:&quot;riktigt&quot;,&quot;probability&quot;:0.004136561405063082,&quot;topicId&quot;:2},
{&quot;term&quot;:&quot;mÃ¥ste&quot;,&quot;probability&quot;:0.004049538541763246,&quot;topicId&quot;:2},
{&quot;term&quot;:&quot;the&quot;,&quot;probability&quot;:0.012209939662717557,&quot;topicId&quot;:3},
{&quot;term&quot;:&quot;datanÃ¶rdar&quot;,&quot;probability&quot;:0.010448534134872305,&quot;topicId&quot;:3},
{&quot;term&quot;:&quot;and&quot;,&quot;probability&quot;:0.00871415633044254,&quot;topicId&quot;:3},
{&quot;term&quot;:&quot;you&quot;,&quot;probability&quot;:0.004717316738793793,&quot;topicId&quot;:3},
{&quot;term&quot;:&quot;bra&quot;,&quot;probability&quot;:0.0036140424647016466,&quot;topicId&quot;:3},
{&quot;term&quot;:&quot;kanske&quot;,&quot;probability&quot;:0.002794974212182175,&quot;topicId&quot;:3},
{&quot;term&quot;:&quot;for&quot;,&quot;probability&quot;:0.00257613484350404,&quot;topicId&quot;:3},
{&quot;term&quot;:&quot;mycket&quot;,&quot;probability&quot;:0.0025543316673021775,&quot;topicId&quot;:3},
{&quot;term&quot;:&quot;tjejer&quot;,&quot;probability&quot;:0.0025314211222808034,&quot;topicId&quot;:3},
{&quot;term&quot;:&quot;fan&quot;,&quot;probability&quot;:0.0021470545469380897,&quot;topicId&quot;:3},
{&quot;term&quot;:&quot;kanske&quot;,&quot;probability&quot;:0.008136396956028923,&quot;topicId&quot;:4},
{&quot;term&quot;:&quot;tycker&quot;,&quot;probability&quot;:0.007598480888602129,&quot;topicId&quot;:4},
{&quot;term&quot;:&quot;barn&quot;,&quot;probability&quot;:0.0066038668672708575,&quot;topicId&quot;:4},
{&quot;term&quot;:&quot;tjejer&quot;,&quot;probability&quot;:0.005629407585564553,&quot;topicId&quot;:4},
{&quot;term&quot;:&quot;mÃ¥nga&quot;,&quot;probability&quot;:0.004621223223798453,&quot;topicId&quot;:4},
{&quot;term&quot;:&quot;aldrig&quot;,&quot;probability&quot;:0.004402198423276141,&quot;topicId&quot;:4},
{&quot;term&quot;:&quot;bra&quot;,&quot;probability&quot;:0.004294088390266522,&quot;topicId&quot;:4},
{&quot;term&quot;:&quot;mycket&quot;,&quot;probability&quot;:0.004118530511479333,&quot;topicId&quot;:4},
{&quot;term&quot;:&quot;fan&quot;,&quot;probability&quot;:0.004054347059086492,&quot;topicId&quot;:4},
{&quot;term&quot;:&quot;rÃ¤tt&quot;,&quot;probability&quot;:0.003984365147630218,&quot;topicId&quot;:4},
{&quot;term&quot;:&quot;mycket&quot;,&quot;probability&quot;:0.008977479783453209,&quot;topicId&quot;:5},
{&quot;term&quot;:&quot;bra&quot;,&quot;probability&quot;:0.00818731006415827,&quot;topicId&quot;:5},
{&quot;term&quot;:&quot;tjejer&quot;,&quot;probability&quot;:0.007351349890882013,&quot;topicId&quot;:5},
{&quot;term&quot;:&quot;kanske&quot;,&quot;probability&quot;:0.007278806387254452,&quot;topicId&quot;:5},
{&quot;term&quot;:&quot;tycker&quot;,&quot;probability&quot;:0.005765657444255816,&quot;topicId&quot;:5},
{&quot;term&quot;:&quot;tjej&quot;,&quot;probability&quot;:0.005283260728111136,&quot;topicId&quot;:5},
{&quot;term&quot;:&quot;aldrig&quot;,&quot;probability&quot;:0.004850961525403287,&quot;topicId&quot;:5},
{&quot;term&quot;:&quot;mÃ¥ste&quot;,&quot;probability&quot;:0.004295311331401175,&quot;topicId&quot;:5},
{&quot;term&quot;:&quot;mÃ¥nga&quot;,&quot;probability&quot;:0.004098909420309231,&quot;topicId&quot;:5},
{&quot;term&quot;:&quot;fan&quot;,&quot;probability&quot;:0.0037519527610768363,&quot;topicId&quot;:5},
{&quot;term&quot;:&quot;kvinnor&quot;,&quot;probability&quot;:0.010225491273158971,&quot;topicId&quot;:6},
{&quot;term&quot;:&quot;mÃ¤n&quot;,&quot;probability&quot;:0.009673480686118726,&quot;topicId&quot;:6},
{&quot;term&quot;:&quot;tycker&quot;,&quot;probability&quot;:0.007140266582380782,&quot;topicId&quot;:6},
{&quot;term&quot;:&quot;mycket&quot;,&quot;probability&quot;:0.006741668845739555,&quot;topicId&quot;:6},
{&quot;term&quot;:&quot;mÃ¥nga&quot;,&quot;probability&quot;:0.006166286203067536,&quot;topicId&quot;:6},
{&quot;term&quot;:&quot;tjejer&quot;,&quot;probability&quot;:0.0055899906619138835,&quot;topicId&quot;:6},
{&quot;term&quot;:&quot;kanske&quot;,&quot;probability&quot;:0.005496960145787021,&quot;topicId&quot;:6},
{&quot;term&quot;:&quot;bra&quot;,&quot;probability&quot;:0.00450516316658287,&quot;topicId&quot;:6},
{&quot;term&quot;:&quot;rÃ¤tt&quot;,&quot;probability&quot;:0.003975370248418236,&quot;topicId&quot;:6},
{&quot;term&quot;:&quot;samma&quot;,&quot;probability&quot;:0.003745046376784121,&quot;topicId&quot;:6},
{&quot;term&quot;:&quot;tjej&quot;,&quot;probability&quot;:0.007127353527224035,&quot;topicId&quot;:7},
{&quot;term&quot;:&quot;tjejer&quot;,&quot;probability&quot;:0.004957423825932039,&quot;topicId&quot;:7},
{&quot;term&quot;:&quot;tycker&quot;,&quot;probability&quot;:0.004956635485595906,&quot;topicId&quot;:7},
{&quot;term&quot;:&quot;bra&quot;,&quot;probability&quot;:0.004879988547583389,&quot;topicId&quot;:7},
{&quot;term&quot;:&quot;aldrig&quot;,&quot;probability&quot;:0.004864308362389227,&quot;topicId&quot;:7},
{&quot;term&quot;:&quot;kanske&quot;,&quot;probability&quot;:0.004588326800005052,&quot;topicId&quot;:7},
{&quot;term&quot;:&quot;fan&quot;,&quot;probability&quot;:0.0045304366858314,&quot;topicId&quot;:7},
{&quot;term&quot;:&quot;mycket&quot;,&quot;probability&quot;:0.004254791775847753,&quot;topicId&quot;:7},
{&quot;term&quot;:&quot;kille&quot;,&quot;probability&quot;:0.003227585234792242,&quot;topicId&quot;:7},
{&quot;term&quot;:&quot;mÃ¥nga&quot;,&quot;probability&quot;:0.003104815800968856,&quot;topicId&quot;:7},
{&quot;term&quot;:&quot;kanske&quot;,&quot;probability&quot;:0.008605481820265399,&quot;topicId&quot;:8},
{&quot;term&quot;:&quot;mycket&quot;,&quot;probability&quot;:0.007793354439640682,&quot;topicId&quot;:8},
{&quot;term&quot;:&quot;bra&quot;,&quot;probability&quot;:0.007702749345394846,&quot;topicId&quot;:8},
{&quot;term&quot;:&quot;tjejer&quot;,&quot;probability&quot;:0.007368449734767341,&quot;topicId&quot;:8},
{&quot;term&quot;:&quot;tycker&quot;,&quot;probability&quot;:0.007331716366632319,&quot;topicId&quot;:8},
{&quot;term&quot;:&quot;tjej&quot;,&quot;probability&quot;:0.007143594626213114,&quot;topicId&quot;:8},
{&quot;term&quot;:&quot;aldrig&quot;,&quot;probability&quot;:0.0057960981929391165,&quot;topicId&quot;:8},
{&quot;term&quot;:&quot;mÃ¥ste&quot;,&quot;probability&quot;:0.004375258913740614,&quot;topicId&quot;:8},
{&quot;term&quot;:&quot;killar&quot;,&quot;probability&quot;:0.004267007182925261,&quot;topicId&quot;:8},
{&quot;term&quot;:&quot;kÃ¤nner&quot;,&quot;probability&quot;:0.004083723539468458,&quot;topicId&quot;:8}
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">displayHTML</span><span class="p">(</span><span class="n">s</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;!DOCTYPE html&gt;</span>
<span class="s2">&lt;meta charset=&quot;utf-8&quot;&gt;</span>
<span class="s2">&lt;style&gt;</span>

<span class="s2">circle {</span>
<span class="s2">  fill: rgb(31, 119, 180);</span>
<span class="s2">  fill-opacity: 0.5;</span>
<span class="s2">  stroke: rgb(31, 119, 180);</span>
<span class="s2">  stroke-width: 1px;</span>
<span class="s2">}</span>

<span class="s2">.leaf circle {</span>
<span class="s2">  fill: #ff7f0e;</span>
<span class="s2">  fill-opacity: 1;</span>
<span class="s2">}</span>

<span class="s2">text {</span>
<span class="s2">  font: 14px sans-serif;</span>
<span class="s2">}</span>

<span class="s2">&lt;/style&gt;</span>
<span class="s2">&lt;body&gt;</span>
<span class="s2">&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js&quot;&gt;&lt;/script&gt;</span>
<span class="s2">&lt;script&gt;</span>

<span class="s2">var json = {</span>
<span class="s2"> &quot;name&quot;: &quot;data&quot;,</span>
<span class="s2"> &quot;children&quot;: [</span>
<span class="s2">  {</span>
<span class="s2">     &quot;name&quot;: &quot;topics&quot;,</span>
<span class="s2">     &quot;children&quot;: [</span>
<span class="s2">      $</span><span class="si">{rawJson}</span><span class="s2"></span>
<span class="s2">     ]</span>
<span class="s2">    }</span>
<span class="s2">   ]</span>
<span class="s2">};</span>

<span class="s2">var r = 1000,</span>
<span class="s2">    format = d3.format(&quot;,d&quot;),</span>
<span class="s2">    fill = d3.scale.category20c();</span>

<span class="s2">var bubble = d3.layout.pack()</span>
<span class="s2">    .sort(null)</span>
<span class="s2">    .size([r, r])</span>
<span class="s2">    .padding(1.5);</span>

<span class="s2">var vis = d3.select(&quot;body&quot;).append(&quot;svg&quot;)</span>
<span class="s2">    .attr(&quot;width&quot;, r)</span>
<span class="s2">    .attr(&quot;height&quot;, r)</span>
<span class="s2">    .attr(&quot;class&quot;, &quot;bubble&quot;);</span>

<span class="s2">  </span>
<span class="s2">var node = vis.selectAll(&quot;g.node&quot;)</span>
<span class="s2">    .data(bubble.nodes(classes(json))</span>
<span class="s2">    .filter(function(d) { return !d.children; }))</span>
<span class="s2">    .enter().append(&quot;g&quot;)</span>
<span class="s2">    .attr(&quot;class&quot;, &quot;node&quot;)</span>
<span class="s2">    .attr(&quot;transform&quot;, function(d) { return &quot;translate(&quot; + d.x + &quot;,&quot; + d.y + &quot;)&quot;; })</span>
<span class="s2">    color = d3.scale.category20();</span>
<span class="s2">  </span>
<span class="s2">  node.append(&quot;title&quot;)</span>
<span class="s2">      .text(function(d) { return d.className + &quot;: &quot; + format(d.value); });</span>

<span class="s2">  node.append(&quot;circle&quot;)</span>
<span class="s2">      .attr(&quot;r&quot;, function(d) { return d.r; })</span>
<span class="s2">      .style(&quot;fill&quot;, function(d) {return color(d.topicName);});</span>

<span class="s2">var text = node.append(&quot;text&quot;)</span>
<span class="s2">    .attr(&quot;text-anchor&quot;, &quot;middle&quot;)</span>
<span class="s2">    .attr(&quot;dy&quot;, &quot;.3em&quot;)</span>
<span class="s2">    .text(function(d) { return d.className.substring(0, d.r / 3)});</span>
<span class="s2">  </span>
<span class="s2">  text.append(&quot;tspan&quot;)</span>
<span class="s2">      .attr(&quot;dy&quot;, &quot;1.2em&quot;)</span>
<span class="s2">      .attr(&quot;x&quot;, 0)</span>
<span class="s2">      .text(function(d) {return Math.ceil(d.value * 10000) /10000; });</span>

<span class="s2">// Returns a flattened hierarchy containing all leaf nodes under the root.</span>
<span class="s2">function classes(root) {</span>
<span class="s2">  var classes = [];</span>

<span class="s2">  function recurse(term, node) {</span>
<span class="s2">    if (node.children) node.children.forEach(function(child) { recurse(node.term, child); });</span>
<span class="s2">    else classes.push({topicName: node.topicId, className: node.term, value: node.probability});</span>
<span class="s2">  }</span>

<span class="s2">  recurse(null, root);</span>
<span class="s2">  return {children: classes};</span>
<span class="s2">}</span>
<span class="s2">&lt;/script&gt;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./000_0-sds-3-x-projects/student-project-01_group-TheTwoCultures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By ScaDaMaLe Team<br/>
        
            &copy; Copyright 2020 Creative Commons Zero v1.0 Universal.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>