<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>018_LinRegIntro - ScaDaMaLe/sds-3.x</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../../favicon.svg">
        
        
        <link rel="shortcut icon" href="../../favicon.png">
        
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        
        <link rel="stylesheet" href="../../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
        <link rel="stylesheet" href="../../scroll-mdbook-outputs.css">
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/000_ScaDaMaLe.html">000_ScaDaMaLe</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/001_whySpark.html">001_whySpark</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/002_00_loginToDatabricks.html">002_00_loginToDatabricks</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/002_01_multiLingualNotebooks.html">002_01_multiLingualNotebooks</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/003_00_scalaCrashCourse.html">003_00_scalaCrashCourse</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/003_01_scalaCrashCourse.html">003_01_scalaCrashCourse</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/004_RDDsTransformationsActions.html">004_RDDsTransformationsActions</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/005_RDDsTransformationsActionsHOMEWORK.html">005_RDDsTransformationsActionsHOMEWORK</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/006a_PipedRDD.html">006a_PipedRDD</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/006_WordCount.html">006_WordCount</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/007a_SparkSQLProgGuide_HW.html">007a_SparkSQLProgGuide_HW</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/007b_SparkSQLProgGuide_HW.html">007b_SparkSQLProgGuide_HW</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/007c_SparkSQLProgGuide_HW.html">007c_SparkSQLProgGuide_HW</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/007d_SparkSQLProgGuide_HW.html">007d_SparkSQLProgGuide_HW</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/007e_SparkSQLProgGuide_HW.html">007e_SparkSQLProgGuide_HW</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/007f_SparkSQLProgGuide_HW.html">007f_SparkSQLProgGuide_HW</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/007g_PivotInSQL.html">007g_PivotInSQL</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/007_SparkSQLIntroBasics.html">007_SparkSQLIntroBasics</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/008_DiamondsPipeline_01ETLEDA.html">008_DiamondsPipeline_01ETLEDA</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html">009_PowerPlantPipeline_01ETLEDA</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/010_wikipediaClickStream_01ETLEDA.html">010_wikipediaClickStream_01ETLEDA</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/033_OBO_LoadExtract.html">033_OBO_LoadExtract</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_1-sds-3-x/033_OBO_PipedRDD_RigorousBayesianABTesting.html">033_OBO_PipedRDD_RigorousBayesianABTesting</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/010a_packageCells.html">010a_packageCells</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/011_02_IntroToSimulation.html">011_02_IntroToSimulation</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/011_03_IntroToML.html">011_03_IntroToML</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/012_UnsupervisedClustering_1MSongsKMeans_Intro.html">012_UnsupervisedClustering_1MSongsKMeans_Intro</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/013_UnsupervisedClustering_1MSongsKMeans_Stage1ETL.html">013_UnsupervisedClustering_1MSongsKMeans_Stage1ETL</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/014_UnsupervisedClustering_1MSongsKMeans_Stage2Explore.html">014_UnsupervisedClustering_1MSongsKMeans_Stage2Explore</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/015_UnsupervisedClustering_1MSongsKMeans_Stage3Model.html">015_UnsupervisedClustering_1MSongsKMeans_Stage3Model</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/016_SupervisedClustering_DecisionTrees_HandWrittenDigitRecognition.html">016_SupervisedClustering_DecisionTrees_HandWrittenDigitRecognition</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/017_LAlgIntro.html">017_LAlgIntro</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/018_LinRegIntro.html" class="active">018_LinRegIntro</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019_DistLAlgForLinRegIntro.html">019_DistLAlgForLinRegIntro</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_000_dataTypesProgGuide.html">019x_000_dataTypesProgGuide</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_001_LocalVector.html">019x_001_LocalVector</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_002_LabeledPoint.html">019x_002_LabeledPoint</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_003_LocalMatrix.html">019x_003_LocalMatrix</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_004_DistributedMatrix.html">019x_004_DistributedMatrix</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_005_RowMatrix.html">019x_005_RowMatrix</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_006_IndexedRowMatrix.html">019x_006_IndexedRowMatrix</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_007_CoordinateMatrix.html">019x_007_CoordinateMatrix</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/019x_008_BlockMatrix.html">019x_008_BlockMatrix</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/020_PowerPlantPipeline_02ModelTuneEvaluate.html">020_PowerPlantPipeline_02ModelTuneEvaluate</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/021_recognizeActivityByRandomForest.html">021_recognizeActivityByRandomForest</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/022_GraphFramesUserGuide.html">022_GraphFramesUserGuide</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/023_OnTimeFlightPerformance.html">023_OnTimeFlightPerformance</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/030_PowerPlantPipeline_03ModelTuneEvaluateDeploy.html">030_PowerPlantPipeline_03ModelTuneEvaluateDeploy</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/033_OBO_LoadExtract.html">033_OBO_LoadExtract</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/033_OBO_PipedRDD_RigorousBayesianABTesting.html">033_OBO_PipedRDD_RigorousBayesianABTesting</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/034_LDA_20NewsGroupsSmall.html">034_LDA_20NewsGroupsSmall</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/035_LDA_CornellMovieDialogs.html">035_LDA_CornellMovieDialogs</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/036_ALS_MovieRecommender.html">036_ALS_MovieRecommender</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/998_EX_01_GraphXShortestWeightedPaths.html">998_EX_01_GraphXShortestWeightedPaths</a></li><li class="chapter-item expanded affix "><a href="../../contents/000_2-sds-3-x-ml/999_YT_01_FinancialFraudDetectionUsingDecisionTreeMachineLearningModels.html">999_YT_01_FinancialFraudDetectionUsingDecisionTreeMachineLearningModels</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">ScaDaMaLe/sds-3.x</h1>

                    <div class="right-buttons">
                        
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        

                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <div class="cell markdown">
<p>ScaDaMaLe Course <a href="https://lamastex.github.io/scalable-data-science/sds/3/x/">site</a> and <a href="https://lamastex.github.io/ScaDaMaLe/index.html">book</a></p>
</div>
<div class="cell markdown">
<p>Let us visit an interactive visual cognitive tool for the basics ideas in linear regression:</p>
<ul>
<li><a href="http://setosa.io/ev/ordinary-least-squares-regression/">http://setosa.io/ev/ordinary-least-squares-regression/</a></li>
</ul>
<p>The following video is a very concise and thorough treatment of linear regression for those who have taken the 200-level linear algebra. Others can fully understand it with some effort and revisiting.</p>
</div>
<div class="cell markdown">
<h4 id="linear-regression-by-ameet-talwalkar-in-berkeleyx-cs1901x-scalable-machine-learning"><a class="header" href="#linear-regression-by-ameet-talwalkar-in-berkeleyx-cs1901x-scalable-machine-learning">Linear Regression by Ameet Talwalkar in BerkeleyX: CS190.1x Scalable Machine Learning</a></h4>
<p><strong>(watch now 11:13)</strong>:</p>
<p><a href="https://www.youtube.com/watch?v=0wcMCQ8SyZM"><img src="http://img.youtube.com/vi/0wcMCQ8SyZM/0.jpg" alt="Linear Regression by Ameet Talwalkar in BerkeleyX: CS190.1x Scalable Machine Learning" /></a></p>
</div>
<div class="cell markdown">
<p>Ridge regression has a Bayesian interpretation where the weights have a zero-mean Gaussian prior. See 7.5 in Murphy's Machine Learning: A Probabilistic Perspective for details.</p>
</div>
<div class="cell markdown">
<p>Please take notes in mark-down if you want.</p>
<p>For latex math within markdown you can do the following for in-line maths: \(\mathbf{A}_{i,j} \in \mathbb{R}^1\). And to write maths in display mode do the following:</p>
<p>\[\mathbf{A} \in \mathbb{R}^{m \times d} \]</p>
<p>You will need to write such notes for your final project presentation!</p>
</div>
<div class="cell markdown">
<h4 id="millonsongs-ridge-regression-by-ameet-talwalkar-in-berkeleyx-cs1901x-scalable-machine-learning"><a class="header" href="#millonsongs-ridge-regression-by-ameet-talwalkar-in-berkeleyx-cs1901x-scalable-machine-learning">MillonSongs Ridge Regression by Ameet Talwalkar in BerkeleyX: CS190.1x Scalable Machine Learning</a></h4>
<p><strong>(watch later 7:47)</strong>:</p>
<p><a href="https://www.youtube.com/watch?v=iS2QxI57OJs"><img src="http://img.youtube.com/vi/iS2QxI57OJs/0.jpg" alt="Linear Regression by Ameet Talwalkar in BerkeleyX: CS190.1x Scalable Machine Learning" /></a></p>
<p>Covers the training, test and validation and grid search... ridger regression...</p>
</div>
<div class="cell markdown">
<p>Take your own notes if you like.</p>
</div>
<div class="cell markdown">
<h4 id="gradient-descent-by-ameet-talwalkar-in-berkeleyx-cs1901x-scalable-machine-learning"><a class="header" href="#gradient-descent-by-ameet-talwalkar-in-berkeleyx-cs1901x-scalable-machine-learning">Gradient Descent by Ameet Talwalkar in BerkeleyX: CS190.1x Scalable Machine Learning</a></h4>
<p><strong>(watch later 11:19)</strong>:</p>
<p><a href="https://www.youtube.com/watch?v=9AZYy36qLqU"><img src="http://img.youtube.com/vi/9AZYy36qLqU/0.jpg" alt="Gradient Descent by Ameet Talwalkar in BerkeleyX: CS190.1x Scalable Machine Learning" /></a></p>
</div>
<div class="cell markdown">
<p>Please take notes if you want to. Most of the above should be review to most of you.</p>
</div>
<div class="cell markdown">
<h3 id="getting-our-hands-dirty-with-darren-wilkinsons-blog-on-regression"><a class="header" href="#getting-our-hands-dirty-with-darren-wilkinsons-blog-on-regression">Getting our hands dirty with Darren Wilkinson's blog on regression</a></h3>
<p>Let's follow the exposition in:</p>
<ul>
<li><a href="https://darrenjw.wordpress.com/2017/02/08/a-quick-introduction-to-apache-spark-for-statisticians/">https://darrenjw.wordpress.com/2017/02/08/a-quick-introduction-to-apache-spark-for-statisticians/</a></li>
<li><a href="https://darrenjw.wordpress.com/2017/06/21/scala-glm-regression-modelling-in-scala/">https://darrenjw.wordpress.com/2017/06/21/scala-glm-regression-modelling-in-scala/</a></li>
</ul>
<p>You need to scroll down the fitst link embedded in iframe below to get to the section on <strong>Analysis of quantitative data</strong> with <strong>Descriptive statistics</strong> and <strong>Linear regression</strong> sub-sections (you can skip the earlier part that shows you how to run everything locally in <code>spark-shell</code> - try this on your own later).</p>
</div>
<div class="cell code" execution_count="1" scrolled="auto">
<div class="output execute_result html_result" execution_count="1">
<iframe 
 src="https://darrenjw.wordpress.com/2017/02/08/a-quick-introduction-to-apache-spark-for-statisticians/"
 width="95%" height="500"
 sandbox>
  <p>
    <a href="http://spark.apache.org/docs/latest/index.html">
      Fallback link for browsers that, unlikely, don't support frames
    </a>
  </p>
</iframe>
</div>
</div>
<div class="cell markdown">
<p>Let's do this live now...</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">import breeze.stats.distributions._
def x = Gaussian(1.0,2.0).sample(10000)
val xRdd = sc.parallelize(x)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import breeze.stats.distributions._
x: IndexedSeq[Double]
xRdd: org.apache.spark.rdd.RDD[Double] = ParallelCollectionRDD[752] at parallelize at command-2972105651606193:3
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">println(xRdd.mean)
println(xRdd.sampleVariance)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>1.0205021258164175
3.9857177279359335
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val xStats = xRdd.stats
xStats.mean
xStats.sampleVariance
xStats.sum
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>xStats: org.apache.spark.util.StatCounter = (count: 10000, mean: 1.020502, stdev: 1.996326, max: 8.089040, min: -6.775216)
res1: Double = 10205.021258164175
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val x2 = Gaussian(0.0,1.0).sample(10000) // 10,000 Gaussian samples with mean 0.0 and std dev 1.0
val xx = x zip x2 // creating tuples { (x,x2)_1, ... , (x,x2)_10000}
val lp = xx map {p =&gt; 2.0*p._1 + 1.0*p._2 + 1.5} // { lp_i := (2.0*x + 1.0 * x2 + 1.5)_i, i=1,...,10000 }
val eps = Gaussian(0.0,1.0).sample(10000) // standrad normal errors
val y = (lp zip eps) map (p =&gt; p._1 + p._2)
val yx = (y zip xx) map (p =&gt; (p._1, p._2._1, p._2._2))
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>x2: IndexedSeq[Double] = Vector(-0.39294234164655323, 0.8555415681712383, 0.5047531440104407, -1.7447287479723848, 0.24074263385944478, -2.5060458696190544, -0.3625957248008947, -1.590842317493378, 0.6957126527559235, 0.4443439308434807, 1.0693145537223456, -1.2513129429033423, -0.35885347259074074, -0.4025589013089939, -0.5152842487123, 1.132054878042222, -0.5455845613656002, 0.047570983504133746, -0.49567564166101635, 1.0696261814411365, 0.05742293214978136, -0.34714185801134384, 1.8582008120255742, -0.6693454894738627, -0.24016699291536123, -0.12433010673208071, 0.862434789491131, -1.1316281054134634, -0.10575269488815854, 1.7745918273414025, -1.3061660094876109, -0.06572880649671899, 0.3873544789319996, -0.12210660688891804, -1.165943599251054, -0.36104975279667534, 0.42769260065418174, 2.5268542442818207, -0.4635835110880271, 0.5605742432439522, -0.18424533745017588, -0.6547651770934155, -0.3093631599212501, -1.6992194371388365, 1.0251808317424254, -0.49932778415411466, -0.5267293749997577, 0.3807716044443315, -0.2309603571068235, 1.3114430446628382, 0.7028043212024827, 0.6785887021373949, -1.8552309111721363, -2.0241836407364917, 0.7390395802525692, -0.6763615336589234, -1.4151582892819992, -0.38597470816390794, -0.14486159731810427, 0.7688581936472016, -1.3626266497959367, 0.5009046399289709, -0.2169795053454745, 0.7067795443536508, 0.39016751626420015, -1.5463774953092397, -1.5372250841054858, 2.800774948623969, -1.716098527038266, -0.12531175540013217, 0.6225381046635164, -0.10110073720446931, 0.21508085343552039, 2.820777844354584, -2.133968264571182, 0.03194529766793855, -0.7259557402806757, 1.016801221526991, 0.010136691488378658, -1.1721518181177566, 0.45371525059610424, -0.378084847990481, 0.65246498923212, 1.5478890198497164, 0.9853670666812488, -0.2558061397393199, 0.4400309911595526, -0.7097573628517923, -1.3505807732496062, 0.570709336264307, -0.6758680344427768, 1.249310736077538, 1.5329864200242511, 2.1934058480067806, 0.2210587647846065, 1.5496999345258775, -0.02008178759544937, -0.7182074798739094, -1.574553120177353, -0.958792980043686, 1.7813255635141554, 0.33371717060253214, 0.409220615969245, 0.864661948971098, 0.45321316725758926, 0.5793640577986269, 0.1929236941299227, 0.8063376087514159, -0.8256218706957177, -1.3545564251072548, -0.0254183713884014, 0.4843489706620019, -0.2547387484777699, 1.413523018000126, -0.25289789625931125, -0.7310514576749854, -0.29989615115264184, -1.8363918121306806, -0.7011073045794324, 0.7618777606468017, 0.21700130623193362, 0.5506648468625105, 1.1297710404205215, 0.2260162334908117, 2.101771770966835, -1.0401885722164608, 0.02137180214574199, -0.7169360439614466, -0.613425386934265, 0.11174082723968021, -0.9886669373791672, -0.4543129014291321, -0.564846245965502, 1.0995727167228742, 1.271378633988257, -0.7702951531569466, 0.7462087643132189, 1.2725942749463925, 0.1262870057515097, -0.045893338153720944, 0.41084773670689295, -1.3024027664479396, -0.9499390632596515, 0.029261740362962387, 0.7045751511355585, 1.4422617585828663, -0.7261733429039657, -1.052342108510518, -1.5648904561390615, 1.3670421409678002, -0.20559374226242771, 0.013590987347403478, -0.3529126981766476, 0.691946010409337, -0.6960770497850841, 1.0458723890175317, 1.8863910225293368, 0.8491253516447187, 1.0689073309368422, 0.7250620374806074, -0.3901714568799757, -1.2526884263329479, 1.5337598160968535, -1.5734284492766968, -0.7626043824264306, 0.5562897446676294, -0.060403799427282315, -0.5429929788309762, -0.6132286530452334, 0.16636225858505, -0.0024321724215160944, -1.5841406068315993, -0.7986448690124527, -0.5033653324197733, 0.8639870077542707, 0.19250807868597403, 0.681426914941135, 1.4510109326483274, -2.042300652862932, -1.712300928957948, 0.10953948453393947, 1.1242791171955329, 0.8834072252776323, -0.05135912367481294, 1.009982993894816, -0.6095932412683162, 1.4956761154363034, 0.18567373438320595, 0.37090426102664004, 0.8311715544823943, 0.5054408736389208, 0.7206315427559578, 0.40680945367189725, -0.8884271435878754, -1.3287614574301743, -1.0699321446564762, -0.4819124409111812, -0.9700171568233398, 1.2167717473547208, -0.4923325750788851, 0.9623530798495777, 0.4964857718691676, 0.22158649834453947, 0.9277564837688251, -0.2700203646085002, -0.6511277226221572, 0.7351230288958747, 0.6312026140388185, 0.16910079595460528, 2.1754653115642344, -0.5715005913183382, 2.1166518725917887, -0.5783250133295226, 1.3168683720426104, -0.8204686684339494, 1.4480493283449567, -0.887210382629622, 1.3361705360924852, -0.6322330616697409, -1.2752575224545533, 0.528363163307158, 0.29556220070086997, 0.6134222803560797, -0.42585783258469845, -0.03385788265209819, -0.7331644433431, -1.0833423498733337, -2.1429965513867453, 0.08949676919665432, -1.1813938916043198, -0.09436785584099101, 1.1991103404291117, -0.4889347917249063, -0.6023561025835236, 1.0904500163003734, 1.0172984903806894, -0.41505354212896794, 0.08392028145445696, -1.0778853399047832, -0.18852154626752887, -0.22887204072785172, 0.33156234372274535, -1.5377779199033221, 0.4679148077343028, -0.5603962896924478, -0.06578481958403957, -0.014064613883901548, -1.3871720695596288, 0.23163269696904626, 0.4173835388660815, -1.142558187450436, -0.4333079768937193, 0.9125581565835416, -0.054146069085648216, -0.2968204515033061, -1.4114436839637123, 0.12997580215602508, -1.1892981491625463, 0.18220156178991903, 1.080893605757458, 0.08812154134356459, 0.7932615528527055, 0.8308626682806806, -0.9337006809708609, -0.024155730233538515, -1.4335334589679927, -1.5056297272127102, -1.2281209908048982, -1.825295380856116, 1.302205733255987, -0.2881094402216243, 0.7538942303079686, -1.1117658292709187, 0.3973123077388707, 1.2262858152226483, -0.6880010889404137, 1.025372672937538, 1.3710780444126296, -1.257636023589723, -0.4962121813964579, 0.7578964000257339, 0.6305238224870192, 2.381523923821332, -0.6995214913186962, 0.3708102567689226, 1.6902485709057429, -0.06420666805043083, -1.1373119793732236, -1.4277168567306726, -0.5759949984556316, -0.5300081207333079, 0.1865975533447568, 0.12814722080936922, -9.134935033488955E-4, 0.7355155414694727, -1.2363754787503263, -0.2881290426128966, 0.35064224051331316, 0.7563162271034706, 0.36554418438134495, -1.0226100914390588, -0.2283632433430197, 1.7577937665005126, 0.40808927185503535, -0.4569166616501099, 0.2398219529093516, -0.03950793158693447, -2.08526632517352, -0.7501838112020969, -0.22816547536021847, 0.3105134133004025, -0.8726928795323247, -0.7042517315417035, 0.08161280184859009, 0.39754713028970634, 0.6196937604346999, 0.803383262714454, 0.695770276993796, 0.29463044014738676, 0.349648457295538, 0.6854964905230979, 1.1081776677979218, -0.3417330695326503, 0.7797405426978532, -1.2721865971477166, 0.07123810722576243, -1.9098096859653089, 0.10943206405137113, -0.9027023437109339, -1.8472024587896054, -0.17563884529352491, -0.447848515452617, -1.129271218124937, 0.13324614948681693, 0.1906707250838576, -0.1368448667033391, 0.49612492826328475, 1.1370854007362705, 1.0376103414737532, -1.3464659344530465, -0.8514100295049349, 0.10406177361348633, 0.6629749441040149, 0.9813881458151125, -0.6859683540842343, -0.7071167634051384, -0.37477639151995884, -1.072024192868426, 0.6007183448749276, -0.6470138152217593, -0.8610825915198451, 0.2769258044067306, -0.5946700435245394, -1.8578306499385195, 0.1404026291463269, -0.7487500291485976, 0.001716983879369797, 0.13155560324087737, 0.29662015816753673, 0.4341314519006115, -0.6715017626213402, 1.5540141887405947, -0.920252031498412, -2.4699199420835534, -1.2767893460262942, -0.08284363302527396, 1.342250062308839, -1.2063571065766612, 0.5554736627359333, -2.427602709628615, 0.7710937814862572, 1.5566244660403479, -0.46645081190790577, 0.1796815842856939, 0.17747870080087005, -0.8388451467406387, 0.4411208486590081, -0.12850957577561956, 0.023625973966644953, -0.7324584611483932, 0.5840942357673657, 0.06791055068258786, 1.6797313039303021, 2.8771333272187025, -0.3393655107223181, -0.6167520459102225, -1.531360842069638, -0.7450533978984144, 0.2651378984077193, 0.507541728540925, 0.03552819654674335, -0.25036122068411887, -0.25392541980057814, 0.47706557832745683, -0.19495949691655287, -0.4137986200591826, 0.3581180244372452, 0.828627937651428, -1.0731595440723252, -0.8215119272414324, 0.8208762992194043, 0.16146956887963948, 0.6709270959610486, 0.5815627333627104, 0.8286305019385863, 0.15124760018186442, -0.0856556285550426, -0.1652276621912081, 0.5584507185970046, 1.0634533492395382, -0.7153398451521084, -0.19877835602653765, -0.5976196576795979, -0.13202828397639688, 0.5019225537437956, 2.400090451938005, -0.482794388537344, 0.7583063710347953, -1.101063395816904, -1.0080096271818906, 1.2563224964212352, -1.375172617232284, 0.12513341625829918, -0.678094662018079, -0.017354596848702847, -0.6525786178877381, -0.08583516585156019, -0.376314327918904, 0.8632437942675442, 0.5371620285266331, 0.46006907707142747, 0.9835047357692503, -0.8039824667182324, -1.6155584434686272, -1.0838601129725927, 0.09494883597949118, -0.18164502769652172, -1.6180588054515577, -0.5499839443032636, -1.470170085601389, 0.5246336030585661, 0.07204560219178385, -1.4799215237859675, 0.375498914792777, -0.3548006328887626, -0.6125115715056341, 0.19752901055994046, -0.02267537018327234, -1.2978681920433892, -0.1418717592792865, -0.3929094911735963, -0.2833407616778224, 0.15281405502653803, -0.3160938878250918, 0.08407769272651915, -0.6206484207796337, 0.03075730051775716, 1.090796313328222, 2.792218008898675, -0.15343647291929807, 1.6144213894377386, -0.5654989192079949, -1.090917870171114, -0.5244207703812372, -0.6929424070463835, 0.7522268639870323, 0.1767639202828313, 1.205877152435392, -0.11381349499166649, 0.7445319289825594, 0.18450366779338395, 0.118082775940314, 0.1260710646956072, 0.9812112154295519, 0.32261371849635684, 0.9403902804638258, -0.8661364423206238, 1.0185442528085524, 1.910310137753987, 0.930137857487562, -1.5890013457848617, 2.100871732763881, 0.05440158499032107, -0.32120175031922266, -1.943676647620499, 0.6397312955426308, -0.9268256702352939, 0.03445371656466987, 1.479158890339039, -1.7342231776275945, 2.345883738200544, -0.6638591414507576, -0.31261841438779303, 0.6911833508363038, -1.1404580265857653, 0.035760579673606574, -0.043563376648401174, 1.3953133669672373, -0.13154519383840338, -0.5087661601151531, -0.13920955934160847, 0.688437534855854, 1.382020040244402, 0.17362122242340142, -0.7252080007225248, 0.05544934731138812, 1.4275179195632797, -0.562485834087356, -0.18222943553591694, -0.21308563190989152, 0.7798377783028813, -1.2335920902335755, 0.6239593088850955, -0.38681536662494653, 0.5153954440507872, -0.4547634776863353, -1.0675089357258334, 0.20455738369516446, -0.4405023228090733, -0.436098409565395, -3.0914805600896087, -1.0384319108300781, 0.16237362414927542, 0.09173964941080463, 1.0546072741601624, -1.4422890792230438, -1.3370778979747984, 0.7517113206381191, 0.3935092691102775, 0.03811037742382486, 0.530154778484631, 0.3782070621461191, -1.023468891914467, 0.19316721687486774, 0.6597527265457721, -1.2236470241273742, 1.247514574470341, 2.2435222794640977, 0.2995966594358739, -0.5291073022086537, -0.5571189095542917, 0.11349223107935802, 1.1185669488897558, -0.4086114125519275, -0.25112950363112646, -1.0608970223945158, 0.17518246249620026, 0.06651951321430995, -0.33034634898439175, 0.6105745637327348, 0.5290626446720255, 2.018433101361855, -0.9984024008645774, 0.3260796702342513, -0.3250349484487747, -1.369769865042985, 0.9921216716815834, -0.3083526711709522, 1.0187493429512395, -0.24782056078650502, -0.7712163035518746, -3.5604118223788594, 0.32612291143440386, 0.4441259968243954, -1.4734210872528921, 1.4195884324887544, -1.4331865020277441, 0.5398675146254653, 0.15162238606384537, 0.43294396379213923, 1.1004558318130622, -1.6225249551448202, 0.890121110279592, -0.6294534363395626, 0.7003661935454487, -0.1295402687875722, 2.044822501564002, -0.8395262566314947, -0.07787176492505386, 0.654084260252699, -1.108634225084861, 0.5376683045798573, -0.5998211693601727, 1.0847220613718276, -1.2062551172960978, -0.07704375636574601, -0.22710371366501256, 0.6448982623891638, -1.3123779835257174, 1.5005705164947913, -0.1530590588270949, 0.2968215409652417, -0.17609073023938399, 2.0723474186637874, 0.18760101905530316, -1.1629786052155737, -0.04644466219506257, 1.102684460944185, -0.8597310131420156, 1.378930732154014, -0.6932188375333033, -1.427569318035048, -0.4316528243072038, -2.438723481595101, 0.7217274318503094, 1.0155995742344546, 0.052126413971228996, -0.48445743390746254, 0.4148805797424512, 0.6133447153641186, 0.8753910134615039, -1.068076214407843, -0.434556342004716, 3.1269586338444797, -1.0898133189009078, -1.6792860321548917, 1.1100130243189885, 0.19785059877372296, 1.1381515852738975, 1.6951931898940376, 0.4849524249938774, 1.0375329570798115, 2.3962090984380273, 0.10582200453150249, 0.12261906596813583, -0.15685142307025152, 0.39785792430853506, -2.063728946132821, 0.006718652661392625, 0.8811082917215027, 1.031451541304585, 1.03387374103542, -0.21407256559986743, -0.5812016751411385, -0.7583304518772646, -1.7509940657503635, -0.6818646320163245, 0.03344337152195518, 0.07593147801064193, 0.4280940512841111, 1.7068789507250506, 0.41457568923249366, 0.7191845635928295, -1.0212751896145356, 0.5752383319361283, 1.0226769514361524, 0.4821255564311748, 0.6925122151119577, -0.49731955088091157, -0.2964847770300842, -1.7889384504694956, -1.7308205970757709, -0.8978527372381635, 1.610161749388444, -2.3346966778146676, -0.14005235243669392, -0.2638362330334334, 3.033939148221663, -0.4723921431007955, -1.9818612938644127, -1.200180759439612, -0.1958021131712377, 1.8451977668782862, -1.5854513074199188, -0.6861915752981226, -0.8314228441600172, -0.5338604341531643, 1.781652090388434, -0.9076613846556846, -0.6071641904585964, 0.25535155484588434, 1.5909788064424866, 1.2231795468357605, -1.5369768230738219, 0.9778022047574955, -0.11568918189852785, -0.43046323075751886, 0.4802026430220832, 2.1631891668981025, 0.4690583697476523, 1.0674375424842637, 0.9208080500687618, 0.6843434412137375, -1.6794382154599943, 1.0870090254688949, 1.9248747606955043, 0.6934671953307943, 0.627881336513211, 0.3744662154421754, 1.763784024349061, -0.8493808371900399, -0.567609188833336, -0.2201046369367792, -1.6873491715309796, 0.2371190560666023, 1.075251848522166, 1.4368687592287923, 0.8762404262364163, -0.07711565494502963, 0.17698197228232837, -0.3600776896107076, 1.150261456652663, -0.5002840503675732, 0.2190456559024505, -1.0353787311463702, -1.149733715048753, -1.5446947456197704, -0.588535373800106, 0.13963634702375105, 1.1108831891598538, -0.7944992798078103, -0.18701479541554847, -1.8378413287995385, -0.043850506493627775, -0.48343601651429297, -0.8840321005189001, 0.23846432457143088, -1.0674625664636426, 2.324566988488983, -0.9522196128421111, 1.9765279947770131, -0.6643193519380749, 0.6520808182812585, -1.5992666302080147, -1.7062663454713203, 0.2757564487910003, 0.8435466565406655, -0.42045520533122144, 0.716619799222379, 0.28414743034916456, 0.3358314801088548, -1.7467587882271216, 0.5664800267199641, -2.3940926770971984, -0.8172183229053432, -1.177790952291942, -1.1154538878995968, 0.6289934748553032, -0.5684467454643073, -0.7529394959237118, -1.6690555711430606, -1.5045353883712862, -0.2412067971568627, 0.4764587131481446, -1.0924162367410453, 1.1655113518246154, -0.8244849073994791, 2.248932166369939, -0.0459449946258884, 0.81919471695202, 0.9229176223234777, -1.5382870761237748, 1.0984168516085677, -0.0854702345311503, 0.2176650701813748, 0.303738640378685, -1.8354156872490102, 0.7740342035185556, 0.19911786393505296, 1.047989868323681, 0.8266490790769497, -0.5683936642222042, 0.992475761812189, -0.2659220866634616, 0.24553115351130905, -1.825430294158945, 1.0352999055758423, -0.527518622419626, 0.3517301281727458, -1.9725666340592487, 0.1531032327414651, 1.1358789375606757, -1.1310069947982322, -1.4271164342133482, -0.8140487406223227, -0.6147904725690881, 1.5448343094414523, 0.3516260387302355, 1.5077377779076973, -0.720656806944059, 4.058563284647572, -2.0857793510927807, -0.19922572226606797, 1.937679297257118, -1.7446359269309906, -0.9965488579353379, 0.0437017745353713, -0.639451539635161, -0.26240304888284255, 0.7724983213734588, -1.488491838499974, 1.3479149174959935, -0.42764700111170884, -1.4759939607037538, 0.2499044333586732, 0.7371067338151035, 0.9316634431960211, 0.17001672153037614, -0.8788426660771226, 1.2160055831120022, 0.18316990947072553, -0.2799508027859539, -2.4180405093204635, -0.9900201591421529, -0.9467485619114566, 1.2104007140228725, -1.787879613423594, 1.1070512345116987, 0.790759961002253, 0.3343125839353365, -1.0899787658894744, 2.028587691445179, -0.21598669668814122, 1.308486017679322, 0.24079233830581265, -0.2610819077953673, -1.6802777976062877, -0.6268238281926952, 0.6604602465229432, -0.058938314824244914, 1.0834803556117802, -0.4288476877403322, -0.6380369464801998, -0.14897947514827461, -0.43681029102759444, -0.17235781067130718, 1.7063370240526137, -0.5572547899173347, 0.11377223858539612, -0.10921015721181385, 1.2999290006688153, 0.4468956243834374, -0.055797896295232, 0.8535766414349459, -0.22341968422547595, -0.582309974339072, 0.29579498066181076, 0.12068404706246855, 1.275665722886601, 0.4468968615231913, -0.16431318102518883, -0.6170461581645824, -0.08332926203736442, 0.741706570397205, -0.9162870165908649, -0.7078311769460378, -0.7247712894607449, -1.3059191011789355, -0.769697986412457, -0.18089878958313999, -1.0684595779555655, -0.02494438722557272, 0.23350725412820314, 0.5157432940867549, -0.08243929311057797, -0.5979503521708791, 0.8151335501906798, -0.33799751855951377, 1.890830155964296, 0.6121585094023474, 1.774684037885972, -0.23759387544057578, -2.03315990383119, -1.1688496443007923, -0.4397178959879119, 0.3557373625894905, -0.5561212499767515, -0.21292772250826736, -0.2979846824906505, -0.4065019329172953, 1.0707224024887492, 1.1264666476744927, 0.4328890480927651, 0.04013669355283642, -0.21203083488828137, -0.13083690020319608, -0.3792661585952008, -0.3726507229634934, -1.2899248788996516, 2.361693353132534, 0.2629946847203882, 0.6481284942580704, -1.5879182031769496, -0.8284773941452568, 0.7188360462319905, -0.2056628808839959, 0.13764745849926985, -0.12880294833353106, 0.7459536821832732, 0.06980762500690524, 0.8948725460436546, 0.04137917801126576, 1.4168762245766586, -0.72290695316646, 1.1953917538053271, 0.9189514057304163, -0.4276732831168535, -1.5920307783357037, 0.22036233996261304, -0.6618848013806111, 0.5023967833168922, -1.8798049688476268, -2.3403372999412824, 0.9517736452082185, -1.6141392992779295, 0.8436238079753076, 0.2529191874202318, -0.5541370654742706, 0.12374279522004643, -0.6301148407060546, -1.4403222157165936, 0.19542195685858585, -0.10906811858567791, 0.1194087911009539, 0.9977718703111065, 1.0831865021663063, -0.21636484434892997, 1.2080329136258738, 0.9367759158801986, -0.9188022673411079, 0.09174825433820326, -0.6264807346890113, -1.563121352500597, -0.5350867639227564, 1.8528702693046855, -0.5593977653294561, -0.4226623349939198, -0.06142863435991346, -0.9502583008581372, 1.0418177592405828, -0.3699692424678086, 0.6991496885125901, 0.25268197866078335, 0.3917327643268707, 0.604783782221425, 0.8521694159073274, -0.47315377436070644, 1.7212170900565924, 0.3951834288049461, 0.6886498407193364, -2.8525636958042004, -0.3646718390579534, 0.19758704639191982, 0.13474797158591095, -0.3421830767735643, -0.21700162301606174, 0.9142028130912175, 2.149904290084441, 0.19196915761885713, -0.47142814713655795, -0.1816812893729263, -0.4879909943188187, 2.0047970309934, 0.8279103367338273, 1.6615766502946514, 1.5537563376257797, -0.7183489213571801, 3.0447228852034645, -0.5606237112666365, 0.12068849840722734, 0.18982271379611992, 0.4802998398528769, 1.882454768570032, 0.6561135636953994, 0.8826392041945182, 0.9020565092044732, 0.23058097151835688, 0.8395514713584076, 1.1198063753911398, 0.15372012712552857, -1.470478847792197, -0.6793300938709819, -0.12387789970441512, -0.15397639561661855, -0.11043795658775445, 1.6740131329272099, 1.3117879138323714, 0.5047349049128723, 0.694311783717759, -1.3151101597813004, 0.4033420610240007, -1.304884713760368, 0.08358341133092088, 0.6112307410723428, 1.9964133145622274, -0.9032581529128374, 0.5590208656374774, -0.3260498054431936, 0.03853895665107181, 0.4146700385645396, -0.15105316919247963, 0.6720630081463373, -0.5612298111941529, -0.5294816951188696, 1.6494433292033768, 0.6967202658975186, -0.8428538299185271, 1.1628738490849835, -1.0419856317270926, -1.886849422771549)
xx: IndexedSeq[(Double, Double)] = Vector((-1.5289467818444833,-0.39294234164655323), (1.699419230239045,0.8555415681712383), (0.5678191719510146,0.5047531440104407), (4.451573214358624,-1.7447287479723848), (-0.1120835302184493,0.24074263385944478), (2.593362084700087,-2.5060458696190544), (0.5534949593776934,-0.3625957248008947), (0.610162799267687,-1.590842317493378), (0.6079959554264716,0.6957126527559235), (3.5570523071163964,0.4443439308434807), (-1.6847794191419774,1.0693145537223456), (-0.9209298511507433,-1.2513129429033423), (1.7696585529469604,-0.35885347259074074), (2.513719756856524,-0.4025589013089939), (-0.5101432900051885,-0.5152842487123), (0.9531168056474683,1.132054878042222), (-0.18160386853639432,-0.5455845613656002), (-1.6720534639191835,0.047570983504133746), (-0.1128951628965178,-0.49567564166101635), (5.053202646224175,1.0696261814411365), (3.016881707079007,0.05742293214978136), (2.228489945412831,-0.34714185801134384), (3.9432152537500693,1.8582008120255742), (-0.8128492159388399,-0.6693454894738627), (-1.0493446978319731,-0.24016699291536123), (0.455542477824066,-0.12433010673208071), (-0.6505654345096172,0.862434789491131), (1.4080971661553034,-1.1316281054134634), (0.6427351386144317,-0.10575269488815854), (2.93527597670534,1.7745918273414025), (0.3125030370768437,-1.3061660094876109), (2.2317546307052267,-0.06572880649671899), (-1.9054972116845272,0.3873544789319996), (4.808568310652596,-0.12210660688891804), (2.284815613746993,-1.165943599251054), (2.7641011375391455,-0.36104975279667534), (0.38106094999227225,0.42769260065418174), (1.0119091652998682,2.5268542442818207), (2.2360804700952235,-0.4635835110880271), (0.6479293943926987,0.5605742432439522), (-1.3488683114919278,-0.18424533745017588), (-0.018469458951885898,-0.6547651770934155), (-0.6254720085777701,-0.3093631599212501), (4.873672237044561,-1.6992194371388365), (2.792090071521142,1.0251808317424254), (-0.61613690444921,-0.49932778415411466), (7.138466574554327,-0.5267293749997577), (6.412297693165607,0.3807716044443315), (-1.186378902163335,-0.2309603571068235), (0.6652433203849859,1.3114430446628382), (2.0118577902415966,0.7028043212024827), (-2.269235949593476,0.6785887021373949), (0.7942001408277328,-1.8552309111721363), (-0.6325105670225346,-2.0241836407364917), (1.0933639757291869,0.7390395802525692), (-0.41379559669680654,-0.6763615336589234), (0.8276069210205774,-1.4151582892819992), (3.657684050519571,-0.38597470816390794), (0.1026014173118951,-0.14486159731810427), (2.0497428550124424,0.7688581936472016), (0.8566802549076746,-1.3626266497959367), (2.0620219502755024,0.5009046399289709), (-1.2819512879056423,-0.2169795053454745), (3.3103526091872144,0.7067795443536508), (2.4269972356037073,0.39016751626420015), (1.8414417452668217,-1.5463774953092397), (2.021646254770606,-1.5372250841054858), (2.5146158568063717,2.800774948623969), (-0.41875874088099607,-1.716098527038266), (3.0612558060621726,-0.12531175540013217), (1.2497224590624345,0.6225381046635164), (0.046877735289129085,-0.10110073720446931), (0.6119022535031835,0.21508085343552039), (-1.4067065190813977,2.820777844354584), (-1.210422821323724,-2.133968264571182), (2.832630152360898,0.03194529766793855), (-1.1696001383544146,-0.7259557402806757), (1.6377689974424938,1.016801221526991), (-2.056664744982475,0.010136691488378658), (1.7879188672663977,-1.1721518181177566), (-1.5040167089312275,0.45371525059610424), (4.8159997698106345,-0.378084847990481), (3.2312553534962833,0.65246498923212), (-0.6383978811586009,1.5478890198497164), (-0.32870181716621216,0.9853670666812488), (0.14959185008521048,-0.2558061397393199), (2.7939144580991107,0.4400309911595526), (1.0505027035853165,-0.7097573628517923), (1.1721428998934513,-1.3505807732496062), (2.7349195458746953,0.570709336264307), (5.792373276359145,-0.6758680344427768), (0.18168770279089197,1.249310736077538), (-0.5005718221567648,1.5329864200242511), (0.12603053626272454,2.1934058480067806), (3.298904302527441,0.2210587647846065), (-0.666187787921138,1.5496999345258775), (4.1529960715303185,-0.02008178759544937), (2.2775895479009707,-0.7182074798739094), (-0.06981231950189182,-1.574553120177353), (0.29634892140510416,-0.958792980043686), (2.9163115819316716,1.7813255635141554), (3.601864756736174,0.33371717060253214), (1.970073788893474,0.409220615969245), (3.069658961355266,0.864661948971098), (3.2058112423394745,0.45321316725758926), (-0.3118854939458713,0.5793640577986269), (0.519685861894807,0.1929236941299227), (4.486391899357848,0.8063376087514159), (3.8643026493328976,-0.8256218706957177), (3.426027816044006,-1.3545564251072548), (-0.5965656001490685,-0.0254183713884014), (2.111764209077566,0.4843489706620019), (0.5521836711433871,-0.2547387484777699), (-2.996943102635258,1.413523018000126), (-0.8434294715304442,-0.25289789625931125), (-2.011819360156546,-0.7310514576749854), (-0.8210835849449694,-0.29989615115264184), (3.8479285689603024,-1.8363918121306806), (3.5078798558286954,-0.7011073045794324), (2.0755371578884754,0.7618777606468017), (-1.4165760405999732,0.21700130623193362), (1.307908715185142,0.5506648468625105), (1.6371750321816452,1.1297710404205215), (1.5995639772928034,0.2260162334908117), (-0.2685260768859212,2.101771770966835), (0.21602705356843044,-1.0401885722164608), (2.6168006707657145,0.02137180214574199), (-0.7874798058251054,-0.7169360439614466), (-3.155806914274004,-0.613425386934265), (-1.61194279161891,0.11174082723968021), (2.3193461394377426,-0.9886669373791672), (3.0088017263316766,-0.4543129014291321), (2.504722275828909,-0.564846245965502), (3.608163177763457,1.0995727167228742), (2.763117036791874,1.271378633988257), (5.444058680853327,-0.7702951531569466), (1.9121844752533634,0.7462087643132189), (-2.375727302846371,1.2725942749463925), (1.9069187587959138,0.1262870057515097), (1.6897335459529206,-0.045893338153720944), (-0.164782448371122,0.41084773670689295), (2.725376567643623,-1.3024027664479396), (2.660084521995932,-0.9499390632596515), (1.320174312357093,0.029261740362962387), (1.6966872219642255,0.7045751511355585), (-3.2812993545913773,1.4422617585828663), (1.4572066636485799,-0.7261733429039657), (0.2037584855799477,-1.052342108510518), (1.535473571895574,-1.5648904561390615), (2.441197086403009,1.3670421409678002), (2.9926990425541815,-0.20559374226242771), (0.05475133222125128,0.013590987347403478), (2.5230441171005165,-0.3529126981766476), (0.5603836139714418,0.691946010409337), (-2.0481417811497717,-0.6960770497850841), (3.5534583252110536,1.0458723890175317), (-0.3136117357945434,1.8863910225293368), (-0.13797451874458666,0.8491253516447187), (0.6735534252335472,1.0689073309368422), (1.7209836686276945,0.7250620374806074), (-2.130641206031183,-0.3901714568799757), (-0.07010788624384112,-1.2526884263329479), (0.4309031020686621,1.5337598160968535), (0.4360032657728571,-1.5734284492766968), (5.199093060093563,-0.7626043824264306), (3.7335504974195857,0.5562897446676294), (2.44960433205387,-0.060403799427282315), (0.742544937647274,-0.5429929788309762), (0.31352114937496434,-0.6132286530452334), (4.683385850410346,0.16636225858505), (-0.4345746095792342,-0.0024321724215160944), (1.535521938543774,-1.5841406068315993), (1.7095547483884825,-0.7986448690124527), (3.705270511090156,-0.5033653324197733), (-2.222278684127421,0.8639870077542707), (-0.00816893329218571,0.19250807868597403), (-0.658307821061505,0.681426914941135), (0.3100135806207882,1.4510109326483274), (0.858484862967229,-2.042300652862932), (-2.397696244192387,-1.712300928957948), (4.7407212158009,0.10953948453393947), (1.2228780093644758,1.1242791171955329), (3.9775191445118545,0.8834072252776323), (4.2153453398310265,-0.05135912367481294), (2.70922664769053,1.009982993894816), (-1.8349916499040457,-0.6095932412683162), (0.9301139941424731,1.4956761154363034), (-0.289269590055067,0.18567373438320595), (2.756585570080306,0.37090426102664004), (2.74024614097962,0.8311715544823943), (1.065782044554717,0.5054408736389208), (-0.38333061523562506,0.7206315427559578), (-1.5809321648450072,0.40680945367189725), (1.038577032549486,-0.8884271435878754), (5.354352575074315,-1.3287614574301743), (1.9437654150818624,-1.0699321446564762), (-1.0600438799016194,-0.4819124409111812), (4.171763626185108,-0.9700171568233398), (0.30525217846836994,1.2167717473547208), (0.7497259542600718,-0.4923325750788851), (-0.34666869393831967,0.9623530798495777), (4.077653023792368,0.4964857718691676), (1.6374287069742905,0.22158649834453947), (3.3047189994445936,0.9277564837688251), (0.15398381219978063,-0.2700203646085002), (1.5140668636025345,-0.6511277226221572), (-2.2719892206423635,0.7351230288958747), (0.2109268599143994,0.6312026140388185), (2.3500964449580235,0.16910079595460528), (0.0564281318237122,2.1754653115642344), (1.9021614058059244,-0.5715005913183382), (0.23180540655603632,2.1166518725917887), (2.4537931275596474,-0.5783250133295226), (1.0260726975099743,1.3168683720426104), (1.6221573548024506,-0.8204686684339494), (1.404534374844201,1.4480493283449567), (-1.3199032535236634,-0.887210382629622), (3.1225744367504857,1.3361705360924852), (-1.987594216884074,-0.6322330616697409), (0.6939577574039522,-1.2752575224545533), (-0.4845523887557337,0.528363163307158), (-1.2972442714976182,0.29556220070086997), (-0.482762303265444,0.6134222803560797), (-0.685594856715692,-0.42585783258469845), (-0.662610483210962,-0.03385788265209819), (-3.7073959979954862,-0.7331644433431), (1.6591827842180562,-1.0833423498733337), (-0.6813117792034318,-2.1429965513867453), (-0.5441269235209982,0.08949676919665432), (1.688846846165015,-1.1813938916043198), (0.8407975208982186,-0.09436785584099101), (1.589853787331588,1.1991103404291117), (-0.4637477107527357,-0.4889347917249063), (1.2474680831190663,-0.6023561025835236), (1.2520539867537988,1.0904500163003734), (1.3126937534824887,1.0172984903806894), (0.14302216759758912,-0.41505354212896794), (-0.6317933519525909,0.08392028145445696), (0.15652677493020528,-1.0778853399047832), (2.1047208079200233,-0.18852154626752887), (1.7538793013323606,-0.22887204072785172), (3.0728946056553283,0.33156234372274535), (0.28671388712281665,-1.5377779199033221), (0.20522034081802665,0.4679148077343028), (3.1910816617753475,-0.5603962896924478), (1.846417134672993,-0.06578481958403957), (1.4197636951269776,-0.014064613883901548), (-1.6174744170191855,-1.3871720695596288), (1.5183734832447289,0.23163269696904626), (1.654512925744207,0.4173835388660815), (-0.20709604725089337,-1.142558187450436), (0.6918208751553904,-0.4333079768937193), (3.1256804009871053,0.9125581565835416), (1.4534027280753201,-0.054146069085648216), (-0.7133197914361238,-0.2968204515033061), (1.533515263222219,-1.4114436839637123), (0.6012970176470114,0.12997580215602508), (2.5454902334397693,-1.1892981491625463), (0.4553853823687859,0.18220156178991903), (-1.1216147137789116,1.080893605757458), (0.746825090495725,0.08812154134356459), (0.23833330472212333,0.7932615528527055), (-0.5226168097129307,0.8308626682806806), (0.7071226311657557,-0.9337006809708609), (0.8052952620564194,-0.024155730233538515), (2.194032568705893,-1.4335334589679927), (4.134463408572442,-1.5056297272127102), (-3.7232617765966873,-1.2281209908048982), (2.450453046456035,-1.825295380856116), (1.6842153789129783,1.302205733255987), (2.003839150651102,-0.2881094402216243), (-0.763338835061049,0.7538942303079686), (0.6178256490598055,-1.1117658292709187), (3.9697357098563195,0.3973123077388707), (-3.784902667913091,1.2262858152226483), (5.868124577242229,-0.6880010889404137), (4.109495849189301,1.025372672937538), (1.1759899699460072,1.3710780444126296), (4.5683434833676,-1.257636023589723), (1.3493191995764,-0.4962121813964579), (2.144115505107175,0.7578964000257339), (2.8024083756987057,0.6305238224870192), (1.3925807925340137,2.381523923821332), (2.241761093984951,-0.6995214913186962), (-1.842525009145509,0.3708102567689226), (3.4748472244750763,1.6902485709057429), (1.6371612690112616,-0.06420666805043083), (-1.9132805922464309,-1.1373119793732236), (0.7043775738817609,-1.4277168567306726), (0.4805179344347752,-0.5759949984556316), (4.4733102607015525,-0.5300081207333079), (-3.057398509763166,0.1865975533447568), (-1.3194297711516594,0.12814722080936922), (1.4635380193549792,-9.134935033488955E-4), (-0.6695261520750773,0.7355155414694727), (1.069968332065937,-1.2363754787503263), (1.2421062183877964,-0.2881290426128966), (4.261825307895921,0.35064224051331316), (-0.9011618695188786,0.7563162271034706), (2.563261343021873,0.36554418438134495), (1.6238498310182599,-1.0226100914390588), (0.8190693738956583,-0.2283632433430197), (0.4955244991917772,1.7577937665005126), (-0.7122431468210888,0.40808927185503535), (0.12012697246504689,-0.4569166616501099), (0.1051896090144927,0.2398219529093516), (-1.5371499595879365,-0.03950793158693447), (4.205899601561821,-2.08526632517352), (2.1584835267482045,-0.7501838112020969), (2.2810232669214314,-0.22816547536021847), (-1.5570948972489456,0.3105134133004025), (-0.25438662009321567,-0.8726928795323247), (-0.44105750293986956,-0.7042517315417035), (0.8514182283091434,0.08161280184859009), (-1.1879934820243916,0.39754713028970634), (1.3448326683133676,0.6196937604346999), (0.23821050190105986,0.803383262714454), (0.4769058301737974,0.695770276993796), (3.9095937580611957,0.29463044014738676), (0.36952215903565755,0.349648457295538), (0.5139594708806907,0.6854964905230979), (-1.8149541809980807,1.1081776677979218), (-2.3865393046034504,-0.3417330695326503), (-0.6590398984041976,0.7797405426978532), (4.49490270748118,-1.2721865971477166), (-0.01544665082884289,0.07123810722576243), (0.6650070871177172,-1.9098096859653089), (-1.6244094077041455,0.10943206405137113), (1.9976503369099792,-0.9027023437109339), (3.777759881716863,-1.8472024587896054), (0.6007168587157123,-0.17563884529352491), (2.3908536576857458,-0.447848515452617), (2.309798441255418,-1.129271218124937), (-0.3082117916153264,0.13324614948681693), (2.113902856532641,0.1906707250838576), (1.0404494437735496,-0.1368448667033391), (-0.5146290142067902,0.49612492826328475), (2.4752824934670667,1.1370854007362705), (1.0777973165051158,1.0376103414737532), (0.6647191983934743,-1.3464659344530465), (2.8064655559929172,-0.8514100295049349), (1.1580827286364657,0.10406177361348633), (1.1919907739424405,0.6629749441040149), (0.3951072514312822,0.9813881458151125), (5.432801108999088,-0.6859683540842343), (1.604676541736763,-0.7071167634051384), (0.47299316760592436,-0.37477639151995884), (0.2739749090381195,-1.072024192868426), (-0.4207616586076568,0.6007183448749276), (0.18200573150935473,-0.6470138152217593), (-1.1168283280152673,-0.8610825915198451), (0.5780078981085324,0.2769258044067306), (-0.8357386478483722,-0.5946700435245394), (2.7546250153243435,-1.8578306499385195), (5.310474615006343,0.1404026291463269), (0.6941749699924396,-0.7487500291485976), (-2.289826572516101,0.001716983879369797), (2.5423811425954845,0.13155560324087737), (2.167664116341008,0.29662015816753673), (1.8107235081063426,0.4341314519006115), (-3.2590196298599077,-0.6715017626213402), (1.1690240954851197,1.5540141887405947), (3.1578834932707966,-0.920252031498412), (4.344258552362392,-2.4699199420835534), (5.547338914531272,-1.2767893460262942), (2.146307433693676,-0.08284363302527396), (-0.6443569356954437,1.342250062308839), (4.97681852772001,-1.2063571065766612), (1.2963186516495604,0.5554736627359333), (-0.7069942983042101,-2.427602709628615), (1.5341631690295898,0.7710937814862572), (3.572911886361501,1.5566244660403479), (6.401371353090534,-0.46645081190790577), (2.655835840597372,0.1796815842856939), (-1.8965961299652587,0.17747870080087005), (2.286114163477233,-0.8388451467406387), (-1.6620645547336266,0.4411208486590081), (4.036314476953924,-0.12850957577561956), (-0.1382115139879012,0.023625973966644953), (-2.311863191261385,-0.7324584611483932), (-2.5381933878516816,0.5840942357673657), (-0.2604052101233294,0.06791055068258786), (1.1614104214991314,1.6797313039303021), (-1.267633663608151,2.8771333272187025), (-2.0713210653535556,-0.3393655107223181), (-1.134252273747662,-0.6167520459102225), (2.391257560566141,-1.531360842069638), (0.2774177066196546,-0.7450533978984144), (-0.23794573188308643,0.2651378984077193), (-2.113647266234659,0.507541728540925), (-0.050514618116106025,0.03552819654674335), (-0.34912424458147795,-0.25036122068411887), (0.4258211881587485,-0.25392541980057814), (1.0878652577602372,0.47706557832745683), (-1.3377619523620021,-0.19495949691655287), (0.32516506501116993,-0.4137986200591826), (1.2543640971571717,0.3581180244372452), (5.1271238327425674,0.828627937651428), (-0.9699403288866604,-1.0731595440723252), (1.277124306106674,-0.8215119272414324), (-1.9301342278864317,0.8208762992194043), (3.5292220443898845,0.16146956887963948), (0.2581008736178728,0.6709270959610486), (4.78509234752654,0.5815627333627104), (-1.5148708218986475,0.8286305019385863), (1.4141648238345867,0.15124760018186442), (1.2345978996434013,-0.0856556285550426), (1.5439889039463148,-0.1652276621912081), (0.4933463084753953,0.5584507185970046), (0.8766867313292435,1.0634533492395382), (0.5089301972762474,-0.7153398451521084), (-0.7080634739559164,-0.19877835602653765), (6.163353022427505,-0.5976196576795979), (3.5630218910636557,-0.13202828397639688), (0.2544582285160836,0.5019225537437956), (1.7458015844872343,2.400090451938005), (0.6100616536220745,-0.482794388537344), (1.8602660760216496,0.7583063710347953), (-0.757813741383887,-1.101063395816904), (-0.8208390581055622,-1.0080096271818906), (0.379242728230368,1.2563224964212352), (2.325219897192296,-1.375172617232284), (-0.9957552334100634,0.12513341625829918), (0.8654731818891029,-0.678094662018079), (-0.08502136097149893,-0.017354596848702847), (-1.0462855625153904,-0.6525786178877381), (-0.4554294032398636,-0.08583516585156019), (-0.6344931591941212,-0.376314327918904), (-1.2790383034510775,0.8632437942675442), (1.7910957433902996,0.5371620285266331), (4.744178958419122,0.46006907707142747), (0.5227909069687329,0.9835047357692503), (0.7157938327091021,-0.8039824667182324), (0.1782737410589118,-1.6155584434686272), (2.6027348450035204,-1.0838601129725927), (-0.8668594463510348,0.09494883597949118), (0.37989183790937653,-0.18164502769652172), (0.4031720608724475,-1.6180588054515577), (1.9815767297917135,-0.5499839443032636), (4.934970216674497,-1.470170085601389), (-0.6039525256365952,0.5246336030585661), (-1.1196471330882733,0.07204560219178385), (0.40337056355902223,-1.4799215237859675), (2.822727097100685,0.375498914792777), (1.9454302769698224,-0.3548006328887626), (0.6101525834529078,-0.6125115715056341), (1.0827099815262105,0.19752901055994046), (-0.03934737093546503,-0.02267537018327234), (-0.7115146340413543,-1.2978681920433892), (2.1153986764987955,-0.1418717592792865), (0.40751043610744675,-0.3929094911735963), (5.438651555402444,-0.2833407616778224), (0.1796155331319489,0.15281405502653803), (1.4886215305003607,-0.3160938878250918), (0.9261766958646567,0.08407769272651915), (4.9291847624458285,-0.6206484207796337), (1.0368762841176293,0.03075730051775716), (-0.003360000633939153,1.090796313328222), (2.526826725456182,2.792218008898675), (0.4903394078436619,-0.15343647291929807), (-1.0442075434558187,1.6144213894377386), (0.055064597265373494,-0.5654989192079949), (1.6751143895524434,-1.090917870171114), (1.6290608723623725,-0.5244207703812372), (-0.10936559565315562,-0.6929424070463835), (-2.2147695140536072,0.7522268639870323), (0.4386133085096875,0.1767639202828313), (1.6654284206669583,1.205877152435392), (1.7602904506257686,-0.11381349499166649), (2.4411565930487846,0.7445319289825594), (0.528960417807525,0.18450366779338395), (3.773358487720458,0.118082775940314), (-2.3714278292629016,0.1260710646956072), (0.6126123638629739,0.9812112154295519), (1.239014514521237,0.32261371849635684), (1.434834483667779,0.9403902804638258), (4.6766480743307595,-0.8661364423206238), (0.6295212900996463,1.0185442528085524), (-0.17443957315762892,1.910310137753987), (1.1631648207434429,0.930137857487562), (0.05751080632840355,-1.5890013457848617), (2.63923786351491,2.100871732763881), (2.6306261517737557,0.05440158499032107), (-2.1249293027036735,-0.32120175031922266), (-0.1764244612415269,-1.943676647620499), (-0.5140014236465322,0.6397312955426308), (-0.5148878621267023,-0.9268256702352939), (1.1305360235288657,0.03445371656466987), (-0.6937005559337415,1.479158890339039), (1.5717756084820529,-1.7342231776275945), (1.0861750021534449,2.345883738200544), (2.9162519266835987,-0.6638591414507576), (1.0573929628327223,-0.31261841438779303), (1.7382278262107655,0.6911833508363038), (-1.9756499207390856,-1.1404580265857653), (2.2426105487932535,0.035760579673606574), (3.410303327117183,-0.043563376648401174), (-1.657936243193801,1.3953133669672373), (1.5904190641915654,-0.13154519383840338), (2.109846866051348,-0.5087661601151531), (1.7383262021843078,-0.13920955934160847), (0.5656777439959259,0.688437534855854), (0.5512630960372296,1.382020040244402), (1.6028860628432642,0.17362122242340142), (-1.796745067068136,-0.7252080007225248), (0.19781901056887174,0.05544934731138812), (2.5159873192784272,1.4275179195632797), (1.4464123272358083,-0.562485834087356), (2.814098282214936,-0.18222943553591694), (1.1740804299823382,-0.21308563190989152), (0.610475789529858,0.7798377783028813), (-0.42624197632233374,-1.2335920902335755), (3.625889016113135,0.6239593088850955), (0.2763769489768022,-0.38681536662494653), (0.9377840067167913,0.5153954440507872), (0.891404804340253,-0.4547634776863353), (-0.36535447057292614,-1.0675089357258334), (1.7797108170731182,0.20455738369516446), (0.7184782760676638,-0.4405023228090733), (-0.17923517056398053,-0.436098409565395), (-1.9223979428879878,-3.0914805600896087), (0.0314887574951036,-1.0384319108300781), (3.1915512652448115,0.16237362414927542), (0.07521161361985051,0.09173964941080463), (3.5309532938682597,1.0546072741601624), (0.3660623395309208,-1.4422890792230438), (2.5372590257109966,-1.3370778979747984), (1.6559484575999996,0.7517113206381191), (1.4924288421049785,0.3935092691102775), (1.5953453623043368,0.03811037742382486), (1.3617590586446204,0.530154778484631), (-2.534062257073355,0.3782070621461191), (0.9600591339372136,-1.023468891914467), (2.174999370984257,0.19316721687486774), (0.9971110428426018,0.6597527265457721), (-0.013924552549497538,-1.2236470241273742), (-0.14967707850183243,1.247514574470341), (2.044815209793586,2.2435222794640977), (2.4410440661546104,0.2995966594358739), (-2.349135440873335,-0.5291073022086537), (0.6790935771846645,-0.5571189095542917), (3.4139257418589426,0.11349223107935802), (-0.8626084002064136,1.1185669488897558), (-0.37391747446349344,-0.4086114125519275), (0.8215544444978548,-0.25112950363112646), (3.8618090128750024,-1.0608970223945158), (1.6800857686675532,0.17518246249620026), (1.0074005694996364,0.06651951321430995), (3.5318329860970725,-0.33034634898439175), (1.7950417717994815,0.6105745637327348), (-2.0336070695788977,0.5290626446720255), (-1.7054184477763195,2.018433101361855), (4.645023899050502,-0.9984024008645774), (1.3906629527780199,0.3260796702342513), (2.4740987497226086,-0.3250349484487747), (0.07847588428334362,-1.369769865042985), (2.475868347546835,0.9921216716815834), (0.6272709897847293,-0.3083526711709522), (-0.6858175920919738,1.0187493429512395), (0.45900544246416697,-0.24782056078650502), (-0.5745269203716783,-0.7712163035518746), (1.3701280631677617,-3.5604118223788594), (0.0948731510554367,0.32612291143440386), (-1.6852745529042497,0.4441259968243954), (1.6709633112857247,-1.4734210872528921), (2.3048068787912106,1.4195884324887544), (3.7027681434110313,-1.4331865020277441), (3.9197357289539516,0.5398675146254653), (3.4591727918555657,0.15162238606384537), (0.18141111286742795,0.43294396379213923), (1.1418538021916915,1.1004558318130622), (1.8458371307314194,-1.6225249551448202), (0.9244775944028731,0.890121110279592), (1.0864146130345944,-0.6294534363395626), (-0.3509024113650585,0.7003661935454487), (3.33728122430862,-0.1295402687875722), (0.2483092092697341,2.044822501564002), (3.9964209499931576,-0.8395262566314947), (5.041222565400819,-0.07787176492505386), (3.027508004726709,0.654084260252699), (-1.4004317476058188,-1.108634225084861), (1.9893187143877324,0.5376683045798573), (-1.510601790533327,-0.5998211693601727), (3.2336996361552006,1.0847220613718276), (1.3904890738297762,-1.2062551172960978), (-0.9985183459863718,-0.07704375636574601), (-0.42290918516396814,-0.22710371366501256), (0.557145424969743,0.6448982623891638), (0.6299424035592602,-1.3123779835257174), (1.2441200282402665,1.5005705164947913), (0.1416628957035737,-0.1530590588270949), (1.658439228273565,0.2968215409652417), (3.487027565153457,-0.17609073023938399), (0.057747803745601956,2.0723474186637874), (1.8158892220290406,0.18760101905530316), (0.47388630687051536,-1.1629786052155737), (-2.8455031410603127,-0.04644466219506257), (2.568676770051918,1.102684460944185), (-0.8084331842961674,-0.8597310131420156), (2.7731501328334534,1.378930732154014), (-2.2022646763305564,-0.6932188375333033), (-2.5747511745197507,-1.427569318035048), (0.045385950152493915,-0.4316528243072038), (0.48651128153317813,-2.438723481595101), (0.17211394730373364,0.7217274318503094), (2.4559329674426524,1.0155995742344546), (-1.949177472936245,0.052126413971228996), (3.151379032883542,-0.48445743390746254), (-2.008398402592464,0.4148805797424512), (2.1051344549387263,0.6133447153641186), (1.3539082426943376,0.8753910134615039), (-0.7773573700545062,-1.068076214407843), (3.136090265926976,-0.434556342004716), (0.8659619601166967,3.1269586338444797), (-2.756659224225406,-1.0898133189009078), (0.40970541978049146,-1.6792860321548917), (0.5481531611505823,1.1100130243189885), (1.4013179773665998,0.19785059877372296), (2.2133971545815765,1.1381515852738975), (-0.9491287644096225,1.6951931898940376), (0.5209829893925308,0.4849524249938774), (-2.9358313706560333,1.0375329570798115), (-2.1863280999191628,2.3962090984380273), (1.8973103339115684,0.10582200453150249), (-0.9438088917696854,0.12261906596813583), (-3.8161788015537486,-0.15685142307025152), (4.598243989073854,0.39785792430853506), (0.14157990229434658,-2.063728946132821), (0.7712012756880778,0.006718652661392625), (1.657954492689108,0.8811082917215027), (-1.9831854962565685,1.031451541304585), (-0.3480671912553863,1.03387374103542), (2.8738286816216583,-0.21407256559986743), (1.863514328094054,-0.5812016751411385), (-0.9428403558267164,-0.7583304518772646), (1.754785995282709,-1.7509940657503635), (0.013682513757415804,-0.6818646320163245), (-0.5248686453084859,0.03344337152195518), (6.071914898933014,0.07593147801064193), (-1.958247927497752,0.4280940512841111), (4.708222732187144,1.7068789507250506), (2.945611634833644,0.41457568923249366), (-2.873611006165206,0.7191845635928295), (-0.6308622794536811,-1.0212751896145356), (1.7810775590894088,0.5752383319361283), (1.3389808014307991,1.0226769514361524), (1.810527500961158,0.4821255564311748), (-0.6433026011303964,0.6925122151119577), (2.5056823298048334,-0.49731955088091157), (-2.920132259436649,-0.2964847770300842), (2.037990236118738,-1.7889384504694956), (1.4786574552223295,-1.7308205970757709), (-3.2626435921253814,-0.8978527372381635), (3.202111558516957,1.610161749388444), (3.0775529358503873,-2.3346966778146676), (-0.004858289779320346,-0.14005235243669392), (-0.2356611818482255,-0.2638362330334334), (1.0363597159426476,3.033939148221663), (0.5951880796739928,-0.4723921431007955), (-1.385157144701036,-1.9818612938644127), (3.168627913505496,-1.200180759439612), (1.7659099443795578,-0.1958021131712377), (-2.2099743662353757,1.8451977668782862), (-2.030174316332396,-1.5854513074199188), (1.7759112730502544,-0.6861915752981226), (-1.4724017242345253,-0.8314228441600172), (-3.090438319803951,-0.5338604341531643), (-1.002042900848683,1.781652090388434), (2.6306174515890004,-0.9076613846556846), (-1.908448678609222,-0.6071641904585964), (1.4736263162987941,0.25535155484588434), (0.7736703824491263,1.5909788064424866), (1.7498656979196905,1.2231795468357605), (0.9366265907877988,-1.5369768230738219), (-0.09536435134844679,0.9778022047574955), (0.8177132188563772,-0.11568918189852785), (-3.4121939733497646,-0.43046323075751886), (3.4314196035854083,0.4802026430220832), (1.2692425660828197,2.1631891668981025), (0.9537947988635598,0.4690583697476523), (1.9696982561485377,1.0674375424842637), (3.9301829681795217,0.9208080500687618), (-0.4472709746146637,0.6843434412137375), (-2.253286341939513,-1.6794382154599943), (0.026135514256517056,1.0870090254688949), (2.4177497341772787,1.9248747606955043), (-0.835370698709712,0.6934671953307943), (4.135177415806311,0.627881336513211), (-1.3712161103055798,0.3744662154421754), (1.410688895640302,1.763784024349061), (-1.942154218131955,-0.8493808371900399), (0.38330995987308936,-0.567609188833336), (-1.0334804970971412,-0.2201046369367792), (-1.832625134688632,-1.6873491715309796), (2.5310364388620794,0.2371190560666023), (3.452713263233051,1.075251848522166), (-0.6837517757525475,1.4368687592287923), (-0.2942544269504741,0.8762404262364163), (1.4256959022956015,-0.07711565494502963), (2.7974786021190114,0.17698197228232837), (1.323363871505369,-0.3600776896107076), (2.7466288331322652,1.150261456652663), (-1.413730211824194,-0.5002...
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val rddLR = sc.parallelize(yx)
rddLR.take(5)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>rddLR: org.apache.spark.rdd.RDD[(Double, Double, Double)] = ParallelCollectionRDD[756] at parallelize at command-2972105651606197:1
res2: Array[(Double, Double, Double)] = Array((-0.6846711453351213,-1.5289467818444833,-0.39294234164655323), (5.497385056408215,1.699419230239045,0.8555415681712383), (3.192289974143172,0.5678191719510146,0.5047531440104407), (9.62629002945858,4.451573214358624,-1.7447287479723848), (2.3798191201086443,-0.1120835302184493,0.24074263385944478))
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="true">
<pre><code class="language-scala">val dfLR = rddLR.toDF(&quot;y&quot;,&quot;x1&quot;,&quot;x2&quot;)
dfLR.show
dfLR.show(5)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>+--------------------+--------------------+--------------------+
|                   y|                  x1|                  x2|
+--------------------+--------------------+--------------------+
| -0.6846711453351213| -1.5289467818444833|-0.39294234164655323|
|   5.497385056408215|   1.699419230239045|  0.8555415681712383|
|   3.192289974143172|  0.5678191719510146|  0.5047531440104407|
|    9.62629002945858|   4.451573214358624| -1.7447287479723848|
|  2.3798191201086443| -0.1120835302184493| 0.24074263385944478|
|  2.8219504009739422|   2.593362084700087| -2.5060458696190544|
|   3.612693960033294|  0.5534949593776934| -0.3625957248008947|
|-0.43223384405620746|   0.610162799267687|  -1.590842317493378|
|  2.6768474073335398|  0.6079959554264716|  0.6957126527559235|
|  7.1521815633527535|  3.5570523071163964|  0.4443439308434807|
| -0.9227166193659311| -1.6847794191419774|  1.0693145537223456|
|  -2.468553589310911| -0.9209298511507433| -1.2513129429033423|
|   3.898027197661611|  1.7696585529469604|-0.35885347259074074|
|   6.732593845464607|   2.513719756856524| -0.4025589013089939|
| 0.43416427898655346| -0.5101432900051885|    -0.5152842487123|
|   4.214978206657414|  0.9531168056474683|   1.132054878042222|
|  1.4665466181948976|-0.18160386853639432| -0.5455845613656002|
| -3.7361996916879003| -1.6720534639191835|0.047570983504133746|
|  0.9602040797406759| -0.1128951628965178|-0.49567564166101635|
|  12.928871086510929|   5.053202646224175|  1.0696261814411365|
+--------------------+--------------------+--------------------+
only showing top 20 rows

+-------------------+-------------------+--------------------+
|                  y|                 x1|                  x2|
+-------------------+-------------------+--------------------+
|-0.6846711453351213|-1.5289467818444833|-0.39294234164655323|
|  5.497385056408215|  1.699419230239045|  0.8555415681712383|
|  3.192289974143172| 0.5678191719510146|  0.5047531440104407|
|   9.62629002945858|  4.451573214358624| -1.7447287479723848|
| 2.3798191201086443|-0.1120835302184493| 0.24074263385944478|
+-------------------+-------------------+--------------------+
only showing top 5 rows

dfLR: org.apache.spark.sql.DataFrame = [y: double, x1: double ... 1 more field]
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// importing for regression
import org.apache.spark.ml.regression.LinearRegression
import org.apache.spark.ml.linalg._

val lm = new LinearRegression
lm.explainParams
lm.getStandardization
lm.setStandardization(false)
lm.getStandardization
lm.explainParams
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import org.apache.spark.ml.regression.LinearRegression
import org.apache.spark.ml.linalg._
lm: org.apache.spark.ml.regression.LinearRegression = linReg_6bc65ac2a454
res5: String =
aggregationDepth: suggested depth for treeAggregate (&gt;= 2) (default: 2)
elasticNetParam: the ElasticNet mixing parameter, in range [0, 1]. For alpha = 0, the penalty is an L2 penalty. For alpha = 1, it is an L1 penalty (default: 0.0)
epsilon: The shape parameter to control the amount of robustness. Must be &gt; 1.0. (default: 1.35)
featuresCol: features column name (default: features)
fitIntercept: whether to fit an intercept term (default: true)
labelCol: label column name (default: label)
loss: The loss function to be optimized. Supported options: squaredError, huber. (Default squaredError) (default: squaredError)
maxIter: maximum number of iterations (&gt;= 0) (default: 100)
predictionCol: prediction column name (default: prediction)
regParam: regularization parameter (&gt;= 0) (default: 0.0)
solver: The solver algorithm for optimization. Supported options: auto, normal, l-bfgs. (Default auto) (default: auto)
standardization: whether to standardize the training features before fitting the model (default: true, current: false)
tol: the convergence tolerance for iterative algorithms (&gt;= 0) (default: 1.0E-6)
weightCol: weight column name. If this is not set or empty, we treat all instance weights as 1.0 (undefined)
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// Transform data frame to required format
val dflr = (dfLR map {row =&gt; (row.getDouble(0), 
           Vectors.dense(row.getDouble(1),row.getDouble(2)))}).
           toDF(&quot;label&quot;,&quot;features&quot;)
dflr.show(5)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>+-------------------+--------------------+
|              label|            features|
+-------------------+--------------------+
|-0.6846711453351213|[-1.5289467818444...|
|  5.497385056408215|[1.69941923023904...|
|  3.192289974143172|[0.56781917195101...|
|   9.62629002945858|[4.45157321435862...|
| 2.3798191201086443|[-0.1120835302184...|
+-------------------+--------------------+
only showing top 5 rows

dflr: org.apache.spark.sql.DataFrame = [label: double, features: vector]
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">// Fit model
val fit = lm.fit(dflr)
fit.intercept
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>fit: org.apache.spark.ml.regression.LinearRegressionModel = LinearRegressionModel: uid=linReg_6bc65ac2a454, numFeatures=2
res8: Double = 1.4864717388481623
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">fit.coefficients
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res9: org.apache.spark.ml.linalg.Vector = [2.0076393809346107,1.0168498373858426]
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val summ = fit.summary
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>summ: org.apache.spark.ml.regression.LinearRegressionTrainingSummary = org.apache.spark.ml.regression.LinearRegressionTrainingSummary@3ff7b1a0
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">summ.r2
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res10: Double = 0.9439028933334824
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">summ.rootMeanSquaredError
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res11: Double = 0.9917259206430321
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">summ.coefficientStandardErrors
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res12: Array[Double] = Array(0.005062858724537394, 0.0098766852367649, 0.01122127338207313)
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">summ.pValues
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res13: Array[Double] = Array(0.0, 0.0, 0.0)
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">summ.tValues
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res14: Array[Double] = Array(396.5426432312811, 102.95456552576245, 132.46907799456326)
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">summ.predictions.show(5)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>+-------------------+--------------------+-------------------+
|              label|            features|         prediction|
+-------------------+--------------------+-------------------+
|-0.6846711453351213|[-1.5289467818444...|-1.9826653879413711|
|  5.497385056408215|[1.69941923023904...|  5.768250014665403|
|  3.192289974143172|[0.56781917195101...| 3.1397060221137103|
|   9.62629002945858|[4.45157321435862...|  8.649498287450083|
| 2.3798191201086443|[-0.1120835302184...| 1.5062475377192448|
+-------------------+--------------------+-------------------+
only showing top 5 rows
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">summ.residuals.show(5)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>+--------------------+
|           residuals|
+--------------------+
|  1.2979942426062498|
| -0.2708649582571878|
|0.052583952029461756|
|  0.9767917420084977|
|  0.8735715823893995|
+--------------------+
only showing top 5 rows
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>This gives you more on doing generalised linear modelling in Scala. But let's go back to out pipeline using the power-plant data.</p>
</div>
<div class="cell code" execution_count="1" scrolled="auto">
<div class="output execute_result html_result" execution_count="1">
<iframe 
 src="https://darrenjw.wordpress.com/2017/06/21/scala-glm-regression-modelling-in-scala/"
 width="95%" height="500"
 sandbox>
  <p>
    <a href="http://spark.apache.org/docs/latest/index.html">
      Fallback link for browsers that, unlikely, don't support frames
    </a>
  </p>
</iframe>
</div>
</div>
<div class="cell markdown">
<h3 id="exercise-writing-your-own-spark-program-for-the-least-squares-fit"><a class="header" href="#exercise-writing-your-own-spark-program-for-the-least-squares-fit">Exercise: Writing your own Spark program for the least squares fit</a></h3>
<h4 id="your-task-is-to-use-the-syntactic-sugar-below-to-write-your-own-linear-regression-function-using-reduce-and-broadcast-operations"><a class="header" href="#your-task-is-to-use-the-syntactic-sugar-below-to-write-your-own-linear-regression-function-using-reduce-and-broadcast-operations">Your task is to use the syntactic sugar below to write your own linear regression function using <code>reduce</code> and <code>broadcast</code> operations</a></h4>
<p>How would you write your own Spark program to find the <em>least squares fit</em> on the following 1000 data points in RDD <code>rddLR</code>, where the variable <code>y</code> is the response variable, and <code>X1</code> and <code>X2</code> are independent variables?</p>
<p>More precisely, find \(w_1, w_2\), such that,</p>
<p>\(\sum_{i=1}^{10} (w_1 X1_i + w_2 X2_i - y_i)^2\) is minimized.</p>
<p>Report \(w_1\), \(w_2\), and the Root Mean Square Error and submit code in Spark. Analyze the resulting algorithm in terms of all-to-all, one-to-all, and all-to-one communication patterns.</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">rddLR.count
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res39: Long = 10000
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">rddLR.take(10)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res33: Array[(Double, Double, Double)] = Array((-0.6846711453351213,-1.5289467818444833,-0.39294234164655323), (5.497385056408215,1.699419230239045,0.8555415681712383), (3.192289974143172,0.5678191719510146,0.5047531440104407), (9.62629002945858,4.451573214358624,-1.7447287479723848), (2.3798191201086443,-0.1120835302184493,0.24074263385944478), (2.8219504009739422,2.593362084700087,-2.5060458696190544), (3.612693960033294,0.5534949593776934,-0.3625957248008947), (-0.43223384405620746,0.610162799267687,-1.590842317493378), (2.6768474073335398,0.6079959554264716,0.6957126527559235), (7.1521815633527535,3.5570523071163964,0.4443439308434807))
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val dfLR = rddLR.toDF(&quot;y&quot;,&quot;x1&quot;,&quot;x2&quot;)
dfLR.show(10)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>+--------------------+-------------------+--------------------+
|                   y|                 x1|                  x2|
+--------------------+-------------------+--------------------+
| -0.6846711453351213|-1.5289467818444833|-0.39294234164655323|
|   5.497385056408215|  1.699419230239045|  0.8555415681712383|
|   3.192289974143172| 0.5678191719510146|  0.5047531440104407|
|    9.62629002945858|  4.451573214358624| -1.7447287479723848|
|  2.3798191201086443|-0.1120835302184493| 0.24074263385944478|
|  2.8219504009739422|  2.593362084700087| -2.5060458696190544|
|   3.612693960033294| 0.5534949593776934| -0.3625957248008947|
|-0.43223384405620746|  0.610162799267687|  -1.590842317493378|
|  2.6768474073335398| 0.6079959554264716|  0.6957126527559235|
|  7.1521815633527535| 3.5570523071163964|  0.4443439308434807|
+--------------------+-------------------+--------------------+
only showing top 10 rows

dfLR: org.apache.spark.sql.DataFrame = [y: double, x1: double ... 1 more field]
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">rddLR.getNumPartitions
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res47: Int = 8
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">rddLR.map( yx1x2 =&gt; (yx1x2._2, yx1x2._3, yx1x2._1) ).take(10)
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res45: Array[(Double, Double, Double)] = Array((-1.5289467818444833,-0.39294234164655323,-0.6846711453351213), (1.699419230239045,0.8555415681712383,5.497385056408215), (0.5678191719510146,0.5047531440104407,3.192289974143172), (4.451573214358624,-1.7447287479723848,9.62629002945858), (-0.1120835302184493,0.24074263385944478,2.3798191201086443), (2.593362084700087,-2.5060458696190544,2.8219504009739422), (0.5534949593776934,-0.3625957248008947,3.612693960033294), (0.610162799267687,-1.590842317493378,-0.43223384405620746), (0.6079959554264716,0.6957126527559235,2.6768474073335398), (3.5570523071163964,0.4443439308434807,7.1521815633527535))
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">import breeze.linalg.DenseVector
    val pts = rddLR.map( yx1x2 =&gt; DenseVector(yx1x2._2, yx1x2._3, yx1x2._1) ).cache
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>import breeze.linalg.DenseVector
pts: org.apache.spark.rdd.RDD[breeze.linalg.DenseVector[Double]] = MapPartitionsRDD[810] at map at command-2744653148556786:3
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Now all we need to do is one-to-all and all-to-one broadcast of the gradient...</p>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">val w = DenseVector(0.0, 0.0, 0.0)
val w_bc = sc.broadcast(w)
val step = 0.1
val max_iter = 100

/*
YouTry: Fix the expressions for grad_w0, grad_w1 and grad_w2 to have w_bc.value be the same as that from ml lib's fit.coefficients
*/    
for (i &lt;- 1 to max_iter) {
        val grad_w0 = pts.map(x =&gt; 2*(w_bc.value(0)*1.0 + w_bc.value(1)*x(0) + w_bc.value(2)*x(1) - x(2))*1.0).reduce(_+_)
        val grad_w1 = pts.map(x =&gt; 2*(w_bc.value(0)*1.0 + w_bc.value(1)*x(0) + w_bc.value(2)*x(1) - x(2))*x(0)).reduce(_+_)
        val grad_w2 = pts.map(x =&gt; 2*(w_bc.value(0)*1.0 + w_bc.value(1)*x(0) + w_bc.value(2)*x(1) - x(2))*x(1)).reduce(_+_)
        w_bc.value(0) = w_bc.value(0) - step*grad_w0
        w_bc.value(1) = w_bc.value(1) - step*grad_w1
        w_bc.value(2) = w_bc.value(2) - step*grad_w2
}
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>w: breeze.linalg.DenseVector[Double] = DenseVector(713529.4020469891, 2282475.3330477937, 208861.12768314985)
w_bc: org.apache.spark.broadcast.Broadcast[breeze.linalg.DenseVector[Double]] = Broadcast(2899)
step: Double = 0.1
max_iter: Int = 100
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">w_bc.value
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res69: breeze.linalg.DenseVector[Double] = DenseVector(713529.4020469891, 2282475.3330477937, 208861.12768314985)
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">fit.intercept
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res70: Double = 1.4864717388481623
</code></pre>
</div>
</div>
<div class="cell code" execution_count="1" scrolled="false">
<pre><code class="language-scala">fit.coefficients
</code></pre>
<div class="output execute_result plain_result" execution_count="1">
<pre><code>res71: org.apache.spark.ml.linalg.Vector = [2.0076393809346107,1.0168498373858426]
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Computing each of the gradients requires an all-to-one communication (due to the <code>.reduce(_+_)</code>). There are two of these per iteration. Broadcasting the updated <code>w_bc</code> requires one to all communication.</p>
</div>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../../contents/000_2-sds-3-x-ml/017_LAlgIntro.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../../contents/000_2-sds-3-x-ml/019_DistLAlgForLinRegIntro.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../../contents/000_2-sds-3-x-ml/017_LAlgIntro.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../../contents/000_2-sds-3-x-ml/019_DistLAlgForLinRegIntro.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        
        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:3000/__livereload");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
