
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ScaDaMaLe, Scalable Data Science and Distributed Machine Learning &#8212; Scalable Data Science &amp; Distributed Machine Learning</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ScaDaMaLe, Scalable Data Science and Distributed Machine Learning" href="010_wikipediaClickStream_01ETLEDA.html" />
    <link rel="prev" title="ScaDaMaLe, Scalable Data Science and Distributed Machine Learning" href="008_DiamondsPipeline_01ETLEDA.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Scalable Data Science & Distributed Machine Learning</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="000_ScaDaMaLe.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="001_whySpark.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="001_whySpark.html#why-apache-spark">
   Why Apache Spark?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="002_00_loginToDatabricks.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="002_00_loginToDatabricks.html#you-should-all-have-databricks-community-edition-account-by-now">
   You Should All Have databricks community edition account by now!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="002_00_loginToDatabricks.html#import-course-content-now">
   Import Course Content Now!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="002_00_loginToDatabricks.html#cloud-free-computing-environment-optional-but-recommended">
   Cloud-free Computing Environment (Optional but recommended)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="002_01_multiLingualNotebooks.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="002_01_multiLingualNotebooks.html#notebooks">
   Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="002_01_multiLingualNotebooks.html#further-reference-homework-recurrrent-points-of-reference">
   Further Reference / Homework / Recurrrent Points of Reference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_00_scalaCrashCourse.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_00_scalaCrashCourse.html#introduction-to-scala">
   Introduction to Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_00_scalaCrashCourse.html#let-s-get-our-hands-dirty-in-scala">
   Let’s get our hands dirty in Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_00_scalaCrashCourse.html#scala-types">
   Scala Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_00_scalaCrashCourse.html#expressions">
   Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_00_scalaCrashCourse.html#blocks">
   Blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_00_scalaCrashCourse.html#functions">
   Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_00_scalaCrashCourse.html#methods">
   Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_00_scalaCrashCourse.html#classes">
   Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_00_scalaCrashCourse.html#case-classes">
   Case Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_00_scalaCrashCourse.html#objects">
   Objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_00_scalaCrashCourse.html#traits">
   Traits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_00_scalaCrashCourse.html#main-method">
   Main Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_00_scalaCrashCourse.html#what-i-try-not-do-while-learning-a-new-language">
   What I try not do while learning a new language?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_01_scalaCrashCourse.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_01_scalaCrashCourse.html#let-s-continue-to-get-our-hands-dirty-in-scala">
   Let’s continue to get our hands dirty in Scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_01_scalaCrashCourse.html#scala-type-hierarchy">
   Scala Type Hierarchy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_01_scalaCrashCourse.html#scala-collections">
   Scala Collections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_01_scalaCrashCourse.html#exercise-in-functional-programming">
   Exercise in Functional Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_01_scalaCrashCourse.html#lazy-evaluation">
   Lazy Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_01_scalaCrashCourse.html#recursions">
   Recursions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="004_RDDsTransformationsActions.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="004_RDDsTransformationsActions.html#introduction-to-spark">
   Introduction to Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="004_RDDsTransformationsActions.html#spark-cluster-overview">
   Spark Cluster Overview:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="005_RDDsTransformationsActionsHOMEWORK.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="005_RDDsTransformationsActionsHOMEWORK.html#homework-notebook-rdds-transformations-and-actions">
   HOMEWORK notebook - RDDs Transformations and Actions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="006a_PipedRDD.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="006a_PipedRDD.html#piped-rdds-and-bayesian-ab-testing">
   Piped RDDs and Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="006a_PipedRDD.html#from-a-local-collection">
   From a Local Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="006a_PipedRDD.html#glom">
   glom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="006a_PipedRDD.html#checkpointing">
   Checkpointing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="006a_PipedRDD.html#pipe-rdds-to-system-commands">
   Pipe RDDs to System Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="006a_PipedRDD.html#mappartitions">
   mapPartitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="006a_PipedRDD.html#foreachpartition">
   foreachPartition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="006a_PipedRDD.html#numerically-rigorous-bayesian-ab-testing">
   Numerically Rigorous Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="006a_PipedRDD.html#usage-instructions-for-isit1or2coins">
   Usage instructions for IsIt1or2Coins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="006_WordCount.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="006_WordCount.html#word-count-on-us-state-of-the-union-sou-addresses">
   Word Count on US State of the Union (SoU) Addresses
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007a_SparkSQLProgGuide_HW.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007a_SparkSQLProgGuide_HW.html#spark-sql-programming-guide">
   Spark Sql Programming Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007b_SparkSQLProgGuide_HW.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007b_SparkSQLProgGuide_HW.html#getting-started">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007b_SparkSQLProgGuide_HW.html#id1">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007c_SparkSQLProgGuide_HW.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007c_SparkSQLProgGuide_HW.html#getting-started-exercise">
   Getting Started - Exercise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007d_SparkSQLProgGuide_HW.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007d_SparkSQLProgGuide_HW.html#data-sources">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007d_SparkSQLProgGuide_HW.html#id1">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007e_SparkSQLProgGuide_HW.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007e_SparkSQLProgGuide_HW.html#performance-tuning">
   Performance Tuning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007f_SparkSQLProgGuide_HW.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007f_SparkSQLProgGuide_HW.html#distributed-sql-engine">
   Distributed SQL Engine
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007f_SparkSQLProgGuide_HW.html#id1">
   Distributed SQL Engine
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007g_PivotInSQL.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007g_PivotInSQL.html#sql-pivoting-since-spark-2-4">
   SQL Pivoting since Spark 2.4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007g_PivotInSQL.html#load-data">
   Load Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007g_PivotInSQL.html#pivoting-in-sql">
   Pivoting in SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007g_PivotInSQL.html#pivoting-with-multiple-aggregate-expressions">
   Pivoting with Multiple Aggregate Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007g_PivotInSQL.html#pivoting-with-multiple-grouping-columns">
   Pivoting with Multiple Grouping Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007g_PivotInSQL.html#pivoting-with-multiple-pivot-columns">
   Pivoting with Multiple Pivot Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007_SparkSQLIntroBasics.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007_SparkSQLIntroBasics.html#introduction-to-spark-sql">
   Introduction to Spark SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007_SparkSQLIntroBasics.html#overview">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007_SparkSQLIntroBasics.html#datasets-and-dataframes">
   Datasets and DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007_SparkSQLIntroBasics.html#getting-started-in-spark-2-x">
   Getting Started in Spark 2.x
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="008_DiamondsPipeline_01ETLEDA.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="010_wikipediaClickStream_01ETLEDA.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="010_wikipediaClickStream_01ETLEDA.html#wiki-clickstream-analysis">
   Wiki Clickstream Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="010_wikipediaClickStream_01ETLEDA.html#wikipedia-logo">
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="030_Spark_GDELT_project.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="030_Spark_GDELT_project.html#plugging-into-gdelt-streams">
   Plugging into GDELT Streams
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="030_Spark_GDELT_project.html#this-is-just-dipping-our-pinky-toe-in-this-ocean-of-information">
   This is just dipping our pinky toe in this ocean of information!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="030_Spark_GDELT_project.html#download-from-gdelt-project">
   Download from gdelt-project
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="033_OBO_LoadExtract.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="033_OBO_LoadExtract.html#old-bailey-online-data-analysis-in-apache-spark">
   Old Bailey Online Data Analysis in Apache Spark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="033_OBO_LoadExtract.html#analysing-the-full-old-bailey-online-sessions-papers-dataset">
   Analysing the Full Old Bailey Online Sessions Papers Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="033_OBO_PipedRDD_RigorousBayesianABTesting.html">
   Piped RDDs and Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="033_OBO_PipedRDD_RigorousBayesianABTesting.html#from-a-local-collection">
   From a Local Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="033_OBO_PipedRDD_RigorousBayesianABTesting.html#glom">
   glom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="033_OBO_PipedRDD_RigorousBayesianABTesting.html#checkpointing">
   Checkpointing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="033_OBO_PipedRDD_RigorousBayesianABTesting.html#pipe-rdds-to-system-commands">
   Pipe RDDs to System Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="033_OBO_PipedRDD_RigorousBayesianABTesting.html#mappartitions">
   mapPartitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="033_OBO_PipedRDD_RigorousBayesianABTesting.html#foreachpartition">
   foreachPartition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="033_OBO_PipedRDD_RigorousBayesianABTesting.html#numerically-rigorous-bayesian-ab-testing">
   Numerically Rigorous Bayesian AB Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="033_OBO_PipedRDD_RigorousBayesianABTesting.html#usage-instructions-for-isit1or2coins">
   Usage instructions for IsIt1or2Coins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="033_OBO_PipedRDD_RigorousBayesianABTesting.html#parsing-the-output-from-isit1or2coins">
   Parsing the output from
   <code class="docutils literal notranslate">
    <span class="pre">
     IsIt1or2Coins
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="033_OBO_PipedRDD_RigorousBayesianABTesting.html#providing-case-classes-for-input-and-output-for-easy-spark-communication">
   Providing case classes for input and output for easy spark communication
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="035_LDA_CornellMovieDialogs.html">
   ScaDaMaLe, Scalable Data Science and Distributed Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="035_LDA_CornellMovieDialogs.html#topic-modeling-of-movie-dialogs-with-latent-dirichlet-allocation">
   Topic Modeling of Movie Dialogs with Latent Dirichlet Allocation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks.html">
   Content with notebooks
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/ScaDaMaLe"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/ScaDaMaLe/issues/new?title=Issue%20on%20page%20%2F000_1-sds-3-x/009_PowerPlantPipeline_01ETLEDA.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#power-plant-ml-pipeline-application-dataframe-part">
   Power Plant ML Pipeline Application - DataFrame Part
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#table-of-contents">
     Table of Contents
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-1-business-understanding">
   Step 1: Business Understanding
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-2-load-your-data">
   Step 2: Load Your Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#alternatively-load-data-via-the-upload-gui-feature-in-databricks">
     2.1. Alternatively, load data via the upload GUI feature in databricks
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#use-this-for-other-smallish-datasets-you-want-to-import-to-your-ce">
   USE THIS FOR OTHER SMALLish DataSets you want to import to your CE
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-3-explore-your-data">
   Step 3: Explore Your Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#viewing-the-table-as-text">
     Viewing the table as text
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#viewing-as-dataframe">
     Viewing as DataFrame
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#viewing-as-table-via-sql">
     Viewing as Table via SQL
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-4-visualize-your-data">
   Step 4: Visualize Your Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#we-will-continue-later-with-ml-pipelines-to-do-prediction-with-a-fitted-model-from-this-dataset">
     We will continue later with ML pipelines to do prediction with a fitted model from this dataset
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="scadamale-scalable-data-science-and-distributed-machine-learning">
<h1><a class="reference external" href="https://lamastex.github.io/scalable-data-science/sds/3/x/">ScaDaMaLe, Scalable Data Science and Distributed Machine Learning</a><a class="headerlink" href="#scadamale-scalable-data-science-and-distributed-machine-learning" title="Permalink to this headline">¶</a></h1>
<div class="section" id="power-plant-ml-pipeline-application-dataframe-part">
<h2>Power Plant ML Pipeline Application - DataFrame Part<a class="headerlink" href="#power-plant-ml-pipeline-application-dataframe-part" title="Permalink to this headline">¶</a></h2>
<p>This is the Spark SQL parts of an end-to-end example of using a number
of different machine learning algorithms to solve a supervised
regression problem.</p>
<p>This is a break-down of <em>Power Plant ML Pipeline Application</em> from
databricks.</p>
<p><strong>This will be a recurring example in the sequel</strong></p>
<div class="section" id="table-of-contents">
<h3>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong>Step 1: Business Understanding</strong></p></li>
<li><p><strong>Step 2: Load Your Data</strong></p></li>
<li><p><strong>Step 3: Explore Your Data</strong></p></li>
<li><p><strong>Step 4: Visualize Your Data</strong></p></li>
<li><p><em>Step 5: Data Preparation</em></p></li>
<li><p><em>Step 6: Data Modeling</em></p></li>
<li><p><em>Step 7: Tuning and Evaluation</em></p></li>
<li><p><em>Step 8: Deployment</em></p></li>
</ul>
<p><em>We are trying to predict power output given a set of readings from
various sensors in a gas-fired power generation plant. Power generation
is a complex process, and understanding and predicting power output is
an important element in managing a plant and its connection to the power
grid.</em></p>
<ul class="simple">
<li><p>Given this business problem, we need to translate it to a Machine
Learning task (actually a <em>Statistical</em> Machine Learning task).</p></li>
<li><p>The ML task here is <em>regression</em> since the label (or target) we will
be trying to predict takes a <em>continuous numeric</em> value</p>
<ul>
<li><p>Note: if the labels took values from a finite discrete set, such
as, <code class="docutils literal notranslate"><span class="pre">Spam</span></code>/<code class="docutils literal notranslate"><span class="pre">Not-Spam</span></code> or <code class="docutils literal notranslate"><span class="pre">Good</span></code>/<code class="docutils literal notranslate"><span class="pre">Bad</span></code>/<code class="docutils literal notranslate"><span class="pre">Ugly</span></code>, then the ML task
would be <em>classification</em>.</p></li>
</ul>
</li>
</ul>
<p><strong>Today, we will only cover Steps 1, 2, 3 and 4 above</strong>. You need
introductions to linear algebra, stochastic gradient descent and
decision trees before we can accomplish the <strong>applied ML task</strong> with
some intuitive understanding. If you can’t wait for ML then <strong>check out
<a class="reference external" href="https://spark.apache.org/docs/latest/mllib-guide.html">Spark MLLib Programming
Guide</a> for
comming attractions!</strong></p>
<p>The example data is provided by UCI at <a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/Combined+Cycle+Power+Plant">UCI Machine Learning Repository
Combined Cycle Power Plant Data
Set</a></p>
<p>You can read the background on the UCI page, but in summary:</p>
<ul class="simple">
<li><p>we have collected a number of readings from sensors at a Gas Fired
Power Plant (also called a Peaker Plant) and</p></li>
<li><p>want to use those sensor readings to predict how much power the
plant will generate in a couple weeks from now.</p></li>
<li><p>Again, today we will just focus on Steps 1-4 above that pertain to
DataFrames.</p></li>
</ul>
<p>More information about Peaker or Peaking Power Plants can be found on
Wikipedia
<a class="reference external" href="https://en.wikipedia.org/wiki/Peaking_power_plant">https://en.wikipedia.org/wiki/Peaking<em>power</em>plant</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">toInt</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>res0: Int = 300
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">a</span> <span class="n">good</span> <span class="n">habit</span> <span class="n">to</span> <span class="n">ensure</span> <span class="n">the</span> <span class="n">code</span> <span class="ow">is</span> <span class="n">being</span> <span class="n">run</span> <span class="n">on</span> <span class="n">the</span> <span class="n">appropriate</span> <span class="n">version</span> <span class="n">of</span> <span class="n">Spark</span> <span class="o">-</span> <span class="n">we</span> <span class="n">are</span> <span class="n">using</span> <span class="n">Spark</span> <span class="mf">2.2</span> <span class="n">actually</span> <span class="k">if</span> <span class="n">we</span> <span class="n">use</span> <span class="n">SparkSession</span> <span class="nb">object</span> <span class="n">spark</span> <span class="n">down</span> <span class="n">the</span> <span class="n">road</span><span class="o">...</span>
<span class="n">require</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">toInt</span> <span class="o">&gt;=</span> <span class="mi">140</span><span class="p">,</span> <span class="s2">&quot;Spark 1.4.0+ is required to run this notebook. Please attach it to a Spark 1.4.0+ cluster.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="step-1-business-understanding">
<h2>Step 1: Business Understanding<a class="headerlink" href="#step-1-business-understanding" title="Permalink to this headline">¶</a></h2>
<p>The first step in any machine learning task is to understand the
business need.</p>
<p>As described in the overview we are trying to predict power output given
a set of readings from various sensors in a gas-fired power generation
plant.</p>
<p>The problem is a regression problem since the label (or target) we are
trying to predict is numeric</p>
</div>
<div class="section" id="step-2-load-your-data">
<h2>Step 2: Load Your Data<a class="headerlink" href="#step-2-load-your-data" title="Permalink to this headline">¶</a></h2>
<p>Now that we understand what we are trying to do, we need to load our
data and describe it, explore it and verify it.</p>
<p>Data was downloaded already as these five Tab-separated-variable or tsv
files.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s2">&quot;/databricks-datasets/power-plant/data&quot;</span><span class="p">))</span> <span class="o">//</span> <span class="n">Ctrl</span><span class="o">+</span><span class="n">Enter</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>Now let us load the data from the Tab-separated-variable or tsv text
file into an <code class="docutils literal notranslate"><span class="pre">RDD[String]</span></code> using the familiar <code class="docutils literal notranslate"><span class="pre">textFile</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="n">powerPlantRDD</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s2">&quot;/databricks-datasets/power-plant/data/Sheet1.tsv&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="n">Ctrl</span><span class="o">+</span><span class="n">Enter</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>powerPlantRDD: org.apache.spark.rdd.RDD[String] = /databricks-datasets/power-plant/data/Sheet1.tsv MapPartitionsRDD[546] at textFile at command-1267216879634554:1
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">powerPlantRDD</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">println</span><span class="p">)</span> <span class="o">//</span> <span class="n">Ctrl</span><span class="o">+</span><span class="n">Enter</span> <span class="n">to</span> <span class="nb">print</span> <span class="n">first</span> <span class="mi">5</span> <span class="n">lines</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>AT	V	AP	RH	PE
14.96	41.76	1024.07	73.17	463.26
25.18	62.96	1020.04	59.08	444.37
5.11	39.4	1012.16	92.14	488.56
20.86	57.32	1010.24	76.64	446.48
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">let</span> <span class="n">us</span> <span class="n">make</span> <span class="n">sure</span> <span class="n">we</span> <span class="n">are</span> <span class="n">using</span> <span class="n">Spark</span> <span class="n">version</span> <span class="n">greater</span> <span class="n">than</span> <span class="mf">2.2</span> <span class="o">-</span> <span class="n">we</span> <span class="n">need</span> <span class="n">a</span> <span class="n">version</span> <span class="n">closer</span> <span class="n">to</span> <span class="mf">2.0</span> <span class="k">if</span> <span class="n">we</span> <span class="n">want</span> <span class="n">to</span> <span class="n">use</span> <span class="n">SparkSession</span> <span class="ow">and</span> <span class="n">SQLContext</span> 
<span class="n">require</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">toInt</span> <span class="o">&gt;=</span> <span class="mi">220</span><span class="p">,</span> <span class="s2">&quot;Spark 2.2.0+ is required to run this notebook. Please attach it to a Spark 2.2.0+ cluster.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">this</span> <span class="n">reads</span> <span class="n">the</span> <span class="n">tsv</span> <span class="n">file</span> <span class="ow">and</span> <span class="n">turns</span> <span class="n">it</span> <span class="n">into</span> <span class="n">a</span> <span class="n">dataframe</span>
<span class="n">val</span> <span class="n">powerPlantDF</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span> <span class="o">//</span> <span class="n">use</span> <span class="s1">&#39;sqlContext.read&#39;</span> <span class="n">instead</span> <span class="k">if</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">use</span> <span class="n">older</span> <span class="n">Spark</span> <span class="n">version</span> <span class="o">&gt;</span> <span class="mf">1.3</span>  <span class="n">see</span> <span class="mi">008</span><span class="n">_</span> <span class="n">notebook</span>
    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;csv&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="n">use</span> <span class="n">spark</span><span class="o">.</span><span class="n">csv</span> <span class="n">package</span>
    <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;header&quot;</span><span class="p">,</span> <span class="s2">&quot;true&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="n">Use</span> <span class="n">first</span> <span class="n">line</span> <span class="n">of</span> <span class="nb">all</span> <span class="n">files</span> <span class="k">as</span> <span class="n">header</span>
    <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;inferSchema&quot;</span><span class="p">,</span> <span class="s2">&quot;true&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="n">Automatically</span> <span class="n">infer</span> <span class="n">data</span> <span class="n">types</span>
    <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;delimiter&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="n">Specify</span> <span class="n">the</span> <span class="n">delimiter</span> <span class="k">as</span> <span class="n">Tab</span> <span class="ow">or</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span>
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;/databricks-datasets/power-plant/data/Sheet1.tsv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>powerPlantDF: org.apache.spark.sql.DataFrame = [AT: double, V: double ... 3 more fields]
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">powerPlantDF</span><span class="o">.</span><span class="n">printSchema</span> <span class="o">//</span> <span class="nb">print</span> <span class="n">the</span> <span class="n">schema</span> <span class="n">of</span> <span class="n">the</span> <span class="n">DataFrame</span> <span class="n">that</span> <span class="n">was</span> <span class="n">inferred</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>root
 |-- AT: double (nullable = true)
 |-- V: double (nullable = true)
 |-- AP: double (nullable = true)
 |-- RH: double (nullable = true)
 |-- PE: double (nullable = true)
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">powerPlantDF</span><span class="o">.</span><span class="n">count</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>res8: Long = 9568
</pre></div>
</div>
</div></blockquote>
<div class="section" id="alternatively-load-data-via-the-upload-gui-feature-in-databricks">
<h3>2.1. Alternatively, load data via the upload GUI feature in databricks<a class="headerlink" href="#alternatively-load-data-via-the-upload-gui-feature-in-databricks" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="use-this-for-other-smallish-datasets-you-want-to-import-to-your-ce">
<h2>USE THIS FOR OTHER SMALLish DataSets you want to import to your CE<a class="headerlink" href="#use-this-for-other-smallish-datasets-you-want-to-import-to-your-ce" title="Permalink to this headline">¶</a></h2>
<p>Since the dataset is relatively small, we will use the upload feature in
Databricks to upload the data as a table.</p>
<p>First download the Data Folder from <a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/Combined+Cycle+Power+Plant">UCI Machine Learning Repository
Combined Cycle Power Plant Data
Set</a></p>
<p>The file is a multi-tab Excel document so you will need to save each tab
as a Text file export.</p>
<p>I prefer exporting as a Tab-Separated-Values (TSV) since it is more
consistent than CSV.</p>
<p>Call each file Folds5x2_pp&lt;Sheet 1..5&gt;.tsv and save to your
machine.</p>
<p>Go to the Databricks Menu &gt; Tables &gt; Create Table</p>
<p>Select Datasource as “File”</p>
<p>Upload <em>ALL</em> 5 files at once.</p>
<p>See screenshots below (but refer
<a class="reference external" href="https://docs.databricks.com/user-guide/importing-data.html">https://docs.databricks.com/user-guide/importing-data.html</a> for latest
methods to import data):</p>
<p><strong>2.1.1. Create Table</strong> _________________</p>
<p>When you import your data, name your table <code class="docutils literal notranslate"><span class="pre">power_plant</span></code>, specify all of
the columns with the datatype <code class="docutils literal notranslate"><span class="pre">Double</span></code> and make sure you check the
<code class="docutils literal notranslate"><span class="pre">First</span> <span class="pre">row</span> <span class="pre">is</span> <span class="pre">header</span></code> box.</p>
<p><img alt="alttext" src="http://training.databricks.com/databricks_guide/1_4_ML_Power_Plant_Import_Table.png" /></p>
<p><strong>2.1.2. Review Schema</strong> __________________</p>
<p>Your table schema and preview should look like this after you click
<code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">Table</span></code>:</p>
<p><img alt="alttext" src="http://training.databricks.com/databricks_guide/1_4_ML_Power_Plant_Import_Table_Schema.png" /></p>
<p>Now that your data is loaded let’s explore it.</p>
</div>
<div class="section" id="step-3-explore-your-data">
<h2>Step 3: Explore Your Data<a class="headerlink" href="#step-3-explore-your-data" title="Permalink to this headline">¶</a></h2>
<p>Now that we understand what we are trying to do, we need to load our
data and describe it, explore it and verify it.</p>
<div class="section" id="viewing-the-table-as-text">
<h3>Viewing the table as text<a class="headerlink" href="#viewing-the-table-as-text" title="Permalink to this headline">¶</a></h3>
<p>By uisng <code class="docutils literal notranslate"><span class="pre">.show</span></code> method we can see some of the contents of the table in
plain text.</p>
<p>This works in pure Apache Spark, say in <code class="docutils literal notranslate"><span class="pre">Spark-Shell</span></code> without any
notebook layer on top of Spark like databricks, zeppelin or jupyter.</p>
<p>It is a good idea to use this method when possible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">powerPlantDF</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">//</span> <span class="k">try</span> <span class="n">putting</span> <span class="mi">1000</span> <span class="n">here</span> <span class="n">instead</span> <span class="n">of</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+-----+-----+-------+-----+------+
|   AT|    V|     AP|   RH|    PE|
+-----+-----+-------+-----+------+
|14.96|41.76|1024.07|73.17|463.26|
|25.18|62.96|1020.04|59.08|444.37|
| 5.11| 39.4|1012.16|92.14|488.56|
|20.86|57.32|1010.24|76.64|446.48|
|10.82| 37.5|1009.23|96.62| 473.9|
|26.27|59.44|1012.23|58.77|443.67|
|15.89|43.96|1014.02|75.24|467.35|
| 9.48|44.71|1019.12|66.43|478.42|
|14.64| 45.0|1021.78|41.25|475.98|
|11.74|43.56|1015.14|70.72| 477.5|
+-----+-----+-------+-----+------+
only showing top 10 rows
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="viewing-as-dataframe">
<h3>Viewing as DataFrame<a class="headerlink" href="#viewing-as-dataframe" title="Permalink to this headline">¶</a></h3>
<p>This is almost necessary for a data scientist to gain visual insights
into all pair-wise relationships between the several (3 to 6 or so)
variables in question.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">powerPlantDF</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>Truncated to 30 rows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">powerPlantDF</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">//</span> <span class="n">count</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">rows</span> <span class="ow">in</span> <span class="n">DF</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>res11: Long = 9568
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="viewing-as-table-via-sql">
<h3>Viewing as Table via SQL<a class="headerlink" href="#viewing-as-table-via-sql" title="Permalink to this headline">¶</a></h3>
<p>Let us look at what tables are already available, as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sqlContext</span><span class="o">.</span><span class="n">tables</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="o">//</span> <span class="n">Ctrl</span><span class="o">+</span><span class="n">Enter</span> <span class="n">to</span> <span class="n">see</span> <span class="n">available</span> <span class="n">tables</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+--------+--------------------+-----------+
|database|           tableName|isTemporary|
+--------+--------------------+-----------+
| default|    sentimentlex_csv|      false|
| default|        simple_range|      false|
| default|  social_media_usage|      false|
| default|social_media_usag...|      false|
+--------+--------------------+-----------+
</pre></div>
</div>
</div></blockquote>
<p>We can also access the list of tables and databases using
<code class="docutils literal notranslate"><span class="pre">spark.catalog</span></code> methods as explained here:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://databricks.com/blog/2016/08/15/how-to-use-sparksession-in-apache-spark-2-0.html">https://databricks.com/blog/2016/08/15/how-to-use-sparksession-in-apache-spark-2-0.html</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spark</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">listTables</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">false</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+------------------------------------------------------------+--------+-----------+---------+-----------+
|name                                                        |database|description|tableType|isTemporary|
+------------------------------------------------------------+--------+-----------+---------+-----------+
|sentimentlex_csv                                            |default |null       |EXTERNAL |false      |
|simple_range                                                |default |null       |MANAGED  |false      |
|social_media_usage                                          |default |null       |MANAGED  |false      |
|social_media_usage_table_partitionedbyplatformbucketedbydate|default |null       |MANAGED  |false      |
+------------------------------------------------------------+--------+-----------+---------+-----------+
</pre></div>
</div>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spark</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">listDatabases</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">false</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+-------+---------------------+-------------------------+
|name   |description          |locationUri              |
+-------+---------------------+-------------------------+
|default|Default Hive database|dbfs:/user/hive/warehouse|
+-------+---------------------+-------------------------+
</pre></div>
</div>
</div></blockquote>
<p>We need to create a temporary view of the DataFrame as a table before
being able to access it via SQL.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">powerPlantDF</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">&quot;power_plant_table&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="n">Shift</span><span class="o">+</span><span class="n">Enter</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sqlContext</span><span class="o">.</span><span class="n">tables</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+--------+--------------------+-----------+
|database|           tableName|isTemporary|
+--------+--------------------+-----------+
| default|    sentimentlex_csv|      false|
| default|        simple_range|      false|
| default|  social_media_usage|      false|
| default|social_media_usag...|      false|
|        |   power_plant_table|       true|
+--------+--------------------+-----------+
</pre></div>
</div>
</div></blockquote>
<p>Note that table names are in lower-case only!</p>
<p><strong>You Try!</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">sqlContext</span> <span class="o">//</span> <span class="n">uncomment</span> <span class="ow">and</span> <span class="n">put</span> <span class="o">.</span> <span class="n">after</span> <span class="n">sqlContext</span> <span class="ow">and</span> <span class="n">hit</span> <span class="n">Tab</span> <span class="n">to</span> <span class="n">see</span> <span class="n">what</span> <span class="n">methods</span> <span class="n">are</span> <span class="n">available</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>//sqlContext.dropTempTable(&quot;power_plant_table&quot;) // uncomment and Ctrl+Enter if you want to remove the table!
</pre></div>
</div>
</div>
</div>
<p>The following SQL statement simply selects all the columns (due to <code class="docutils literal notranslate"><span class="pre">*</span></code>)
from <code class="docutils literal notranslate"><span class="pre">powerPlantTable</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span> <span class="n">Ctrl</span><span class="o">+</span><span class="n">Enter</span> <span class="n">to</span> <span class="n">query</span> <span class="n">the</span> <span class="n">rows</span> <span class="n">via</span> <span class="n">SQL</span>
<span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">power_plant_table</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>Truncated to 30 rows</p>
<p>Note that the output of the above command is the same as
<code class="docutils literal notranslate"><span class="pre">display(powerPlantDF)</span></code> we did earlier.</p>
<p>We can use the SQL <code class="docutils literal notranslate"><span class="pre">desc</span></code> command to describe the schema. This is the
SQL equivalent of <code class="docutils literal notranslate"><span class="pre">powerPlantDF.printSchema</span></code> we saw earlier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">desc</span> <span class="n">power_plant_table</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p><strong>Schema Definition</strong></p>
<p>Our schema definition from UCI appears below:</p>
<ul class="simple">
<li><p>AT = Atmospheric Temperature in C</p></li>
<li><p>V = Exhaust Vaccum Speed</p></li>
<li><p>AP = Atmospheric Pressure</p></li>
<li><p>RH = Relative Humidity</p></li>
<li><p>PE = Power Output</p></li>
</ul>
<p>PE is our label or target. This is the value we are trying to predict
given the measurements.</p>
<p><em>Reference <a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/Combined+Cycle+Power+Plant">UCI Machine Learning Repository Combined Cycle Power Plant
Data
Set</a></em></p>
<p>Let’s do some basic statistical analysis of all the columns.</p>
<p>We can use the describe function with no parameters to get some basic
stats for each column like count, mean, max, min and standard deviation.
More information can be found in the <a class="reference external" href="https://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.sql.DataFrame">Spark API
docs</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">powerPlantDF</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
</div>
</div>
<div class="section" id="step-4-visualize-your-data">
<h2>Step 4: Visualize Your Data<a class="headerlink" href="#step-4-visualize-your-data" title="Permalink to this headline">¶</a></h2>
<p>To understand our data, we will look for correlations between features
and the label. This can be important when choosing a model. E.g., if
features and a label are linearly correlated, a linear model like Linear
Regression can do well; if the relationship is very non-linear, more
complex models such as Decision Trees or neural networks can be better.
We use the Databricks built in visualization to view each of our
predictors in relation to the label column as a scatter plot to see the
correlation between the predictors and the label.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">AT</span> <span class="k">as</span> <span class="n">Temperature</span><span class="p">,</span> <span class="n">PE</span> <span class="k">as</span> <span class="n">Power</span> <span class="kn">from</span> <span class="nn">power_plant_table</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>Truncated to 30 rows</p>
<p>From the above plot, it looks like there is strong linear correlation
between temperature and Power Output!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">V</span> <span class="k">as</span> <span class="n">ExhaustVaccum</span><span class="p">,</span> <span class="n">PE</span> <span class="k">as</span> <span class="n">Power</span> <span class="kn">from</span> <span class="nn">power_plant_table</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>Truncated to 30 rows</p>
<p>The linear correlation is not as strong between Exhaust Vacuum Speed and
Power Output but there is some semblance of a pattern.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">AP</span> <span class="k">as</span> <span class="n">Pressure</span><span class="p">,</span> <span class="n">PE</span> <span class="k">as</span> <span class="n">Power</span> <span class="kn">from</span> <span class="nn">power_plant_table</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>Truncated to 30 rows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">RH</span> <span class="k">as</span> <span class="n">Humidity</span><span class="p">,</span> <span class="n">PE</span> <span class="k">as</span> <span class="n">Power</span> <span class="kn">from</span> <span class="nn">power_plant_table</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>Truncated to 30 rows</p>
<p>…and atmospheric pressure and relative humidity seem to have little to
no linear correlation.</p>
<p>These pairwise plots can also be done directly using <code class="docutils literal notranslate"><span class="pre">display</span></code> on
<code class="docutils literal notranslate"><span class="pre">select</span></code>ed columns of the DataFrame <code class="docutils literal notranslate"><span class="pre">powerPlantDF</span></code>.</p>
<p>In general <strong>we will shy from SQL as much as possible</strong> to focus on ML
pipelines written with DataFrames and DataSets with occassional
in-and-out of RDDs.</p>
<p>The illustations in <code class="docutils literal notranslate"><span class="pre">%sql</span></code> above are to mainly reassure those with a
RDBMS background and SQL that their SQL expressibility can be directly
used in Apache Spark and in databricks notebooks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>display(powerPlantDF.select($&quot;RH&quot;, $&quot;PE&quot;))
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>Truncated to 30 rows</p>
<p>Furthermore, you can interactively start playing with <code class="docutils literal notranslate"><span class="pre">display</span></code> on the
full DataFrame!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">powerPlantDF</span><span class="p">)</span> <span class="o">//</span> <span class="n">just</span> <span class="k">as</span> <span class="n">we</span> <span class="n">did</span> <span class="k">for</span> <span class="n">the</span> <span class="n">diamonds</span> <span class="n">dataset</span>
</pre></div>
</div>
</div>
</div>
<p>[TABLE]</p>
<p>Truncated to 30 rows</p>
<p>We will do the following steps in the sequel.</p>
<ul class="simple">
<li><p><em>Step 5: Data Preparation</em></p></li>
<li><p><em>Step 6: Data Modeling</em></p></li>
<li><p><em>Step 7: Tuning and Evaluation</em></p></li>
<li><p><em>Step 8: Deployment</em></p></li>
</ul>
<p>Datasource References:</p>
<ul class="simple">
<li><p>Pinar Tüfekci, Prediction of full load electrical power output of a
base load operated combined cycle power plant using machine learning
methods, International Journal of Electrical Power &amp; Energy Systems,
Volume 60, September 2014, Pages 126-140, ISSN 0142-0615, <a class="reference external" href="http://www.journals.elsevier.com/international-journal-of-electrical-power-and-energy-systems/">Web
Link</a></p></li>
<li><p>Heysem Kaya, Pinar Tüfekci , Sadik Fikret Gürgen: Local and Global
Learning Methods for Predicting Power of a Combined Gas &amp; Steam
Turbine, Proceedings of the International Conference on Emerging
Trends in Computer and Electronics Engineering ICETCEE 2012, pp.
13-18 (Mar. 2012, Dubai) <a class="reference external" href="http://www.cmpe.boun.edu.tr/~kaya/kaya2012gasturbine.pdf">Web
Link</a></p></li>
</ul>
<div class="section" id="we-will-continue-later-with-ml-pipelines-to-do-prediction-with-a-fitted-model-from-this-dataset">
<h3>We will continue later with ML pipelines to do prediction with a fitted model from this dataset<a class="headerlink" href="#we-will-continue-later-with-ml-pipelines-to-do-prediction-with-a-fitted-model-from-this-dataset" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./000_1-sds-3-x"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="008_DiamondsPipeline_01ETLEDA.html" title="previous page">ScaDaMaLe, Scalable Data Science and Distributed Machine Learning</a>
    <a class='right-next' id="next-link" href="010_wikipediaClickStream_01ETLEDA.html" title="next page">ScaDaMaLe, Scalable Data Science and Distributed Machine Learning</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By ScaDaMaLe Team<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>